var es={Version:"1.0",Browser:{IE:!!(window.attachEvent&&!window.opera),Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")==-1,MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/)},BrowserFeatures:{XPath:!!document.evaluate,ElementExtensions:!!window.HTMLElement,SpecificElementExtensions:document.createElement("div").__proto__&&document.createElement("div").__proto__!==document.createElement("form").__proto__},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",emptyFunction:function(){},K:function(a){return a},dumpObject:function(c,a){var d="";for(var b in c){d+=b+" : "+c[b]+a}return d}};if(es.Browser.MobileSafari){es.BrowserFeatures.SpecificElementExtensions=false}if(es.Browser.WebKit){es.$A=function(c){if(!c){return[]}if(!(Object.isFunction(c)&&c=="[object NodeList]")&&c.toArray){return c.toArray()}var b=c.length||0,a=new Array(b);while(b--){a[b]=c[b]}return a}}else{es.$A=function(c){if(!c){return[]}if(c.toArray){return c.toArray()}var b=c.length||0,a=new Array(b);while(b--){a[b]=c[b]}return a}}es.Class={create:function(){var e=null,d=es.$A(arguments);if(Object.isFunction(d[0])){e=d.shift()}function a(){this.initialize.apply(this,arguments)}Object.extend(a,es.Class.Methods);a.superclass=e;a.subclasses=[];if(e){var b=function(){};b.prototype=e.prototype;a.prototype=new b;e.subclasses.push(a)}for(var c=0;c<d.length;c++){a.addMethods(d[c])}if(!a.prototype.initialize){a.prototype.initialize=es.emptyFunction}a.prototype.constructor=a;return a}};es.Class.Methods={addMethods:function(g){var c=this.superclass&&this.superclass.prototype;var b=Object.keys(g);if(!Object.keys({toString:true}).length){b.push("toString","valueOf")}for(var a=0,d=b.length;a<d;a++){var f=b[a],e=g[f];if(c&&Object.isFunction(e)&&e.argumentNames().first()=="$super"){var h=e,e=Object.extend((function(i){return function(){return c[i].apply(this,arguments)}})(f).wrap(h),{valueOf:function(){return h},toString:function(){return h.toString()}})}this.prototype[f]=e}return this}};Object._extendNoOverwrite=function(a,c){for(var b in c){if(typeof a[b]=="undefined"){a[b]=c[b]}}return a};Object._extendNoOverwrite(Object,{extend:function(a,c){for(var b in c){a[b]=c[b]}return a},inspect:function(a){try{if(Object.isUndefined(a)){return"undefined"}if(a===null){return"null"}return a.inspect?a.inspect():String(a)}catch(b){if(b instanceof RangeError){return"..."}throw b}},toQueryString:function(a){return es.$H(a).toQueryString()},keys:function(a){var b=[];for(var c in a){b.push(c)}return b},values:function(b){var a=[];for(var c in b){a.push(b[c])}return a},clone:function(a){return Object.extend({},a)},isElement:function(a){return a&&a.nodeType==1},isArray:function(a){return a!=null&&typeof a=="object"&&"splice" in a&&"join" in a},isHash:function(a){return a instanceof es.Hash},isFunction:function(a){return typeof a=="function"},isString:function(a){return typeof a=="string"},isNumber:function(a){return typeof a=="number"},isUndefined:function(a){return typeof a=="undefined"}});Object._extendNoOverwrite(Function.prototype,{argumentNames:function(){var a=this.toString().match(/^[\s\(]*function[^(]*\((.*?)\)/)[1].split(",").invoke("strip");return a.length==1&&!a[0]?[]:a},bind:function(){if(arguments.length<2&&Object.isUndefined(arguments[0])){return this}var a=this,c=es.$A(arguments),b=c.shift();return function(){return a.apply(b,c.concat(es.$A(arguments)))}},bindAsEventListener:function(){var a=this,c=es.$A(arguments),b=c.shift();return function(d){return a.apply(b,[d||window.event].concat(c))}},curry:function(){if(!arguments.length){return this}var a=this,b=es.$A(arguments);return function(){return a.apply(this,b.concat(es.$A(arguments)))}},delay:function(){var a=this,b=es.$A(arguments),c=b.shift()*1000;return window.setTimeout(function(){return a.apply(a,b)},c)},wrap:function(b){var a=this;return function(){return b.apply(this,[a.bind(this)].concat(es.$A(arguments)))}},methodize:function(){if(this._methodized){return this._methodized}var a=this;return this._methodized=function(){return a.apply(null,[this].concat(es.$A(arguments)))}}});Function.prototype.defer=Function.prototype.delay.curry(0.01);RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};Object._extendNoOverwrite(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object._extendNoOverwrite(String.prototype,{gsub:function(e,c){var a="",d=this,b;c=arguments.callee.prepareReplacement(c);while(d.length>0){if(b=d.match(e)){a+=d.slice(0,b.index);a+=String.interpret(c(b));d=d.slice(b.index+b[0].length)}else{a+=d,d=""}}return a},scan:function(b,a){this.gsub(b,a);return String(this)},truncate:function(b,a){b=b||30;a=Object.isUndefined(a)?"...":a;return this.length>b?this.slice(0,b-a.length)+a:String(this)},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"")},stripScripts:function(){return this.replace(new RegExp(es.ScriptFragment,"img"),"")},extractScripts:function(){var b=new RegExp(es.ScriptFragment,"img");var a=new RegExp(es.ScriptFragment,"im");return(this.match(b)||[]).map(function(c){return(c.match(a)||["",""])[1]})},evalScripts:function(){return this.extractScripts().map(function(script){return eval(script)})},escapeHTML:function(){var a=arguments.callee;a.text.data=this;return a.div.innerHTML},unescapeHTML:function(){var a=document.createElement("div");a.innerHTML=this.stripTags();return a.childNodes[0]?(a.childNodes.length>1?es.$A(a.childNodes).inject("",function(b,c){return b+c.nodeValue}):a.childNodes[0].nodeValue):""},toQueryParams:function(b){var a=this.strip().match(/([^?#]*)(#.*)?$/);if(!a){return{}}return a[1].split(b||"&").inject({},function(e,f){if((f=f.split("="))[0]){var c=decodeURIComponent(f.shift());var d=f.length>1?f.join("="):f[0];if(d!=undefined){d=decodeURIComponent(d)}if(c in e){if(!Object.isArray(e[c])){e[c]=[e[c]]}e[c].push(d)}else{e[c]=d}}return e})},toArray:function(){return this.split("")},include:function(a){return this.indexOf(a)>-1},startsWith:function(a){return this.indexOf(a)===0},endsWith:function(a){var b=this.length-a.length;return b>=0&&this.lastIndexOf(a)===b},empty:function(){return this==""},blank:function(){return/^\s*$/.test(this)},interpolate:function(a,b){return new es.Template(this,b).evaluate(a)},camelize:function(){var d=this.split("-"),a=d.length;if(a==1){return d[0]}var c=this.charAt(0)=="-"?d[0].charAt(0).toUpperCase()+d[0].substring(1):d[0];for(var b=1;b<a;b++){c+=d[b].charAt(0).toUpperCase()+d[b].substring(1)}return c},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()},trim:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")},truncateByByte:function(h,g,d){var b=0;var a="";g=g?g.toLocaleLowerCase():"utf-8";d=d===undefined?"...":d;var e=(g=="utf-8")?3:2;if(this.length<h){return String(this)}for(var f=0;f<this.length;f++){var j=this.charAt(f);if(escape(j).length>4){b+=e}else{b++}if(b<=h){a+=j}else{break}}return a+d},bytelength:function(e){e=e?e.toLocaleLowerCase():"utf-8";var b=(e=="utf-8")?3:2;var a=0;for(var d=0;d<this.length;d++){var f=this.charAt(d);if(escape(f).length>4){a+=b}else{a++}}return a}});Object.extend(String.prototype,{sub:function(c,a,b){a=this.gsub.prepareReplacement(a);b=Object.isUndefined(b)?1:b;return this.gsub(c,function(d){if(--b<0){return d[0]}return a(d)})}});if(es.Browser.WebKit||es.Browser.IE){Object.extend(String.prototype,{escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(){return this.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}})}if(!String.prototype.gsub.prepareReplacement){String.prototype.gsub.prepareReplacement=function(b){if(Object.isFunction(b)){return b}var a=new es.Template(b);return function(c){return a.evaluate(c)}}}if(!String.prototype.parseQuery){String.prototype.parseQuery=String.prototype.toQueryParams}Object._extendNoOverwrite(String.prototype.escapeHTML,{div:document.createElement("div"),text:document.createTextNode("")});with(String.prototype.escapeHTML){div.appendChild(text)}es.Template=es.Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||es.Template.Pattern},evaluate:function(a){if(Object.isFunction(a.toTemplateReplacements)){a=a.toTemplateReplacements()}return this.template.gsub(this.pattern,function(d){if(a==null){return""}var f=d[1]||"";if(f=="\\"){return d[2]}var b=a,g=d[3];var e=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;d=e.exec(g);if(d==null){return f}while(d!=null){var c=d[1].startsWith("[")?d[2].gsub("\\\\]","]"):d[1];b=b[c];if(null==b||""==d[3]){break}g=g.substring("["==d[3]?d[1].length:d[0].length);d=e.exec(g)}return f+String.interpret(b)})}});es.Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;es.$break={};es.Enumerable={each:function(c,b){var a=0;c=c.bind(b);try{this._each(function(e){c(e,a++)})}catch(d){if(d!=es.$break){throw d}}return this},eachSlice:function(d,c,b){c=c?c.bind(b):es.K;var a=-d,e=[],f=this.toArray();if(d<1){return f}while((a+=d)<f.length){e.push(f.slice(a,a+d))}return e.collect(c,b)},all:function(c,b){c=c?c.bind(b):es.K;var a=true;this.each(function(e,d){a=a&&!!c(e,d);if(!a){throw es.$break}});return a},any:function(c,b){c=c?c.bind(b):es.K;var a=false;this.each(function(e,d){if(a=!!c(e,d)){throw es.$break}});return a},collect:function(c,b){c=c?c.bind(b):es.K;var a=[];this.each(function(e,d){a.push(c(e,d))});return a},detect:function(c,b){c=c.bind(b);var a;this.each(function(e,d){if(c(e,d)){a=e;throw es.$break}});return a},findAll:function(c,b){c=c.bind(b);var a=[];this.each(function(e,d){if(c(e,d)){a.push(e)}});return a},grep:function(d,c,b){c=c?c.bind(b):es.K;var a=[];if(Object.isString(d)){d=new RegExp(d)}this.each(function(f,e){if(d.match(f)){a.push(c(f,e))}});return a},include:function(a){if(Object.isFunction(this.indexOf)){if(this.indexOf(a)!=-1){return true}}var b=false;this.each(function(c){if(c==a){b=true;throw es.$break}});return b},inGroupsOf:function(b,a){a=Object.isUndefined(a)?null:a;return this.eachSlice(b,function(c){while(c.length<b){c.push(a)}return c})},inject:function(a,c,b){c=c.bind(b);this.each(function(e,d){a=c(a,e,d)});return a},invoke:function(b){var a=es.$A(arguments).slice(1);return this.map(function(c){return c[b].apply(c,a)})},max:function(c,b){c=c?c.bind(b):es.K;var a;this.each(function(e,d){e=c(e,d);if(a==null||e>=a){a=e}});return a},min:function(c,b){c=c?c.bind(b):es.K;var a;this.each(function(e,d){e=c(e,d);if(a==null||e<a){a=e}});return a},partition:function(d,b){d=d?d.bind(b):es.K;var c=[],a=[];this.each(function(f,e){(d(f,e)?c:a).push(f)});return[c,a]},pluck:function(b){var a=[];this.each(function(c){a.push(c[b])});return a},reject:function(c,b){c=c.bind(b);var a=[];this.each(function(e,d){if(!c(e,d)){a.push(e)}});return a},sortBy:function(b,a){b=b.bind(a);return this.map(function(d,c){return{value:d,criteria:b(d,c)}}).sort(function(f,e){var d=f.criteria,c=e.criteria;return d<c?-1:d>c?1:0}).pluck("value")},toArray:function(){return this.map()},zip:function(){var b=es.K,a=es.$A(arguments);if(Object.isFunction(a.last())){b=a.pop()}var c=[this].concat(a).map(es.$A);return this.map(function(e,d){return b(c.pluck(d))})},size:function(){return this.toArray().length}};Object._extendNoOverwrite(es.Enumerable,{map:es.Enumerable.collect,find:es.Enumerable.detect,select:es.Enumerable.findAll,filter:es.Enumerable.findAll,member:es.Enumerable.include,entries:es.Enumerable.toArray,every:es.Enumerable.all,some:es.Enumerable.any});if(!Array.from){Array.from=es.$A}Object._extendNoOverwrite(Array.prototype,es.Enumerable);if(!Array.prototype._reverse){Array.prototype._reverse=Array.prototype.reverse}Object._extendNoOverwrite(Array.prototype,{_each:function(b){for(var a=0,c=this.length;a<c;a++){b(this[a])}},clear:function(){this.length=0;return this},first:function(){return this[0]},last:function(){return this[this.length-1]},compact:function(){return this.select(function(a){return a!=null})},flatten:function(){return this.inject([],function(b,a){return b.concat(Object.isArray(a)?a.flatten():[a])})},without:function(){var a=es.$A(arguments);return this.select(function(b){return !a.include(b)})},reverse:function(a){return(a!==false?this:this.toArray())._reverse()},reduce:function(){return this.length>1?this:this[0]},uniq:function(a){return this.inject([],function(d,c,b){if(0==b||(a?d.last()!=c:!d.include(c))){d.push(c)}return d})},intersect:function(a){return this.uniq().findAll(function(b){return a.detect(function(c){return b===c})})},clone:function(){return[].concat(this)},size:function(){return this.length}});if(!Array.prototype._each&&Object.isFunction(Array.prototype.forEach)){Array.prototype._each=Array.prototype.forEach}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,a){a||(a=0);var b=this.length;if(a<0){a=b+a}for(;a<b;a++){if(this[a]===c){return a}}return -1}}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(b,a){a=isNaN(a)?this.length:(a<0?this.length+a:a)+1;var c=this.slice(0,a).reverse().indexOf(b);return(c<0)?c:a-c-1}}if(!Array.prototype.toArray){Array.prototype.toArray=Array.prototype.clone}es.$w=function(a){if(!Object.isString(a)){return[]}a=a.strip();return a?a.split(/\s+/):[]};if(!Array.prototype.concat&&es.Browser.Opera){Array.prototype.concat=function(){var e=[];for(var b=0,c=this.length;b<c;b++){e.push(this[b])}for(var b=0,c=arguments.length;b<c;b++){if(Object.isArray(arguments[b])){for(var a=0,d=arguments[b].length;a<d;a++){e.push(arguments[b][a])}}else{e.push(arguments[b])}}return e}}Object._extendNoOverwrite(Number.prototype,{toPaddedString:function(e,c){var a=this.toString(c||10);var d="";for(var b=0;b<e-a.length;b++){d+="0"}return d+a}});es.$H=function(a){return new es.Hash(a)};es.Hash=es.Class.create(es.Enumerable,(function(){function a(b,c){if(Object.isUndefined(c)){return b}return b+"="+encodeURIComponent(String.interpret(c))}return{initialize:function(b){this._object=Object.isHash(b)?b.toObject():Object.clone(b)},_each:function(c){for(var b in this._object){var d=this._object[b],e=[b,d];e.key=b;e.value=d;c(e)}},set:function(b,c){return this._object[b]=c},get:function(b){return this._object[b]},unset:function(b){var c=this._object[b];delete this._object[b];return c},toObject:function(){return Object.clone(this._object)},keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},index:function(c){var b=this.detect(function(d){return d.value===c});return b&&b.key},merge:function(b){return this.clone().update(b)},update:function(b){return new es.Hash(b).inject(this,function(c,d){c.set(d.key,d.value);return c})},toQueryString:function(){return this.map(function(d){var c=encodeURIComponent(d.key),b=d.value;if(b&&typeof b=="object"){if(Object.isArray(b)){return b.map(a.curry(c)).join("&")}}return a(c,b)}).join("&")},clone:function(){return new es.Hash(this)}}})());es.Hash.prototype.toTemplateReplacements=es.Hash.prototype.toObject;es.Hash.from=es.$H;es.Ajax=es.Class.create({initialize:function(b){var a={url:"",method:"GET",async:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",headers:null,data:"",scope:this,success:null,failure:null};this.options=Object.extend(a,b);var c=this._getXHR();if(c){this._send(c,this.options);this._handleResponse(c,this.options)}},_getXHR:function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(ActiveXObject){try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}return false},_send:function(c,b){c.open(b.method,b.url,b.async);c.setRequestHeader("Content-Type",b.contentType+"; charset="+b.encoding);if(c.overrideMimeType){c.setRequestHeader("Connection","close")}if(b.headers){for(var a in headers){c.setRequestHeader(a,headers[a])}}c.send(b.data)},_handleResponse:function(c,a){var b=0;var d=window.setInterval(function(){if(c.readyState==4||b++>10000){window.clearInterval(d);if(a.success&&b<10000&&c.status==200){a.success.call(a.scope,c,a)}else{if(a.failure){a.failure.call(a.scope,c,a,(b>10000?"TIMEOUT":"GENERAL"))}}c=null}},10)}});es.$=function(b){if(arguments.length>1){for(var a=0,d=[],c=arguments.length;a<c;a++){d.push(es.$(arguments[a]))}return d}if(Object.isString(b)){b=document.getElementById(b)}return b};es.$C=function(b,a){a=a||{};b=b.toLowerCase();if(es.Browser.IE&&a.name){b="<"+b+' name="'+a.name+'">';delete a.name}return es.Dom.writeAttribute(document.createElement(b),a)};es.Dom={_returnOffset:function(b,c){var a=[b,c];a.left=b;a.top=c;return a},writeAttribute:function(d,c,e){d=es.$(d);var b={};if(typeof c=="object"){b=c}else{b[c]=Object.isUndefined(e)?true:e}for(var a in b){c=a;e=b[a];if(e===false||e===null){d.removeAttribute(c)}else{if(e===true){d.setAttribute(c,c)}else{d.setAttribute(c,e)}}}return d},readAttribute:function(b,a){b=es.$(b);if(es.Browser.IE){if(a.include(":")){return(!b.attributes||!b.attributes[a])?null:b.attributes[a].value}}return b.getAttribute(a)},remove:function(a){a=es.$(a);a.parentNode.removeChild(a);return a},getStyle:function(b,c){b=es.$(b);c=c=="float"?"cssFloat":c.camelize();var d=b.style[c];if(!d){var a=document.defaultView.getComputedStyle(b,null);d=a?a[c]:null}if(c=="opacity"){return d?parseFloat(d):1}return d=="auto"?null:d},getOpacity:function(a){return es.Dom.getStyle(es.$(a),"opacity")},setStyle:function(b,c){b=es.$(b);var e=b.style,a;if(Object.isString(c)){b.style.cssText+=";"+c;return c.include("opacity")?es.Dom.setOpacity(b,c.match(/opacity:\s*(\d?\.?\d*)/)[1]):b}for(var d in c){if(d=="opacity"){es.Dom.setOpacity(b,c[d])}else{e[(d=="float"||d=="cssFloat")?(Object.isUndefined(e.styleFloat)?"cssFloat":"styleFloat"):d]=c[d]}}return b},setOpacity:function(a,b){a=es.$(a);a.style.opacity=(b==1||b==="")?"":(b<0.00001)?0:b;return a},getDimensions:function(c){c=es.$(c);var g=es.Dom.getStyle(es.$(c),"display");if(g!="none"&&g!=null){return{width:c.offsetWidth,height:c.offsetHeight}}var b=c.style;var f=b.visibility;var d=b.position;var a=b.display;b.visibility="hidden";b.position="absolute";b.display="block";var h=c.clientWidth;var e=c.clientHeight;b.display=a;b.position=d;b.visibility=f;return{width:h,height:e}},getHeight:function(a){return es.Dom.getDimensions(es.$(a)).height},getWidth:function(a){return es.Dom.getDimensions(es.$(a)).width},hasClassName:function(a,b){if(!(a=es.$(a))){return}var c=a.className;return(c.length>0&&(c==b||new RegExp("(^|\\s)"+b+"(\\s|$)").test(c)))},addClassName:function(a,b){if(!(a=es.$(a))){return}if(!es.Dom.hasClassName(a,b)){a.className+=(a.className?" ":"")+b}return a},removeClassName:function(a,b){if(!(a=es.$(a))){return}a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a},toggleClassName:function(a,b){if(!(a=es.$(a))){return}return a[es.Dom.hasClassName(a,b)?"removeClassName":"addClassName"](b)},scrollTo:function(a){a=es.$(a);var b=es.Dom.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},cumulativeOffset:function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;b=b.offsetParent}while(b);return es.Dom._returnOffset(c,a)},positionedOffset:function(b){var a=0,d=0;do{a+=b.offsetTop||0;d+=b.offsetLeft||0;b=b.offsetParent;if(b){if(b.tagName.toUpperCase()=="BODY"){break}var c=es.Dom.getStyle(b,"position");if(c!=="static"){break}}}while(b);return es.Dom._returnOffset(d,a)},absolutize:function(b){b=es.$(b);if(es.Dom.getStyle(b,"position")=="absolute"){return b}var d=es.Dom.positionedOffset(b);var f=d[1];var e=d[0];var c=b.clientWidth;var a=b.clientHeight;b._originalLeft=e-parseFloat(b.style.left||0);b._originalTop=f-parseFloat(b.style.top||0);b._originalWidth=b.style.width;b._originalHeight=b.style.height;b.style.position="absolute";b.style.top=f+"px";b.style.left=e+"px";b.style.width=c+"px";b.style.height=a+"px";return b},relativize:function(a){a=es.$(a);if(es.Dom.getStyle(a,"position")=="relative"){return a}a.style.position="relative";var c=parseFloat(a.style.top||0)-(a._originalTop||0);var b=parseFloat(a.style.left||0)-(a._originalLeft||0);a.style.top=c+"px";a.style.left=b+"px";a.style.height=a._originalHeight;a.style.width=a._originalWidth;return a},cumulativeScrollOffset:function(b){var a=0,c=0;do{a+=b.scrollTop||0;c+=b.scrollLeft||0;b=b.parentNode}while(b);return es.Dom._returnOffset(c,a)},getOffsetParent:function(a){if(a.offsetParent){return es.$(a.offsetParent)}if(a==document.body){return es.$(a)}while((a=a.parentNode)&&a!=document.body){if(es.Dom.getStyle(a,"position")!="static"){return es.$(a)}}return es.$(document.body)},viewportOffset:function(d){var a=0,c=0;var b=d;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;if(b.offsetParent==document.body&&es.Dom.getStyle(b,"position")=="absolute"){break}}while(b=b.offsetParent);b=d;do{if(!es.Browser.Opera||b.tagName.toUpperCase()=="BODY"){a-=b.scrollTop||0;c-=b.scrollLeft||0}}while(b=b.parentNode);return es.Dom._returnOffset(c,a)},clonePosition:function(b,d){var a=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});d=es.$(d);var e=es.Dom.viewportOffset(d);b=es.$(b);var f=[0,0];var c=null;if(es.Dom.getStyle(b,"position")=="absolute"){c=es.Dom.getOffsetParent(b);f=es.Dom.viewportOffset(c)}if(c==document.body){f[0]-=document.body.offsetLeft;f[1]-=document.body.offsetTop}if(a.setLeft){b.style.left=(e[0]-f[0]+a.offsetLeft)+"px"}if(a.setTop){b.style.top=(e[1]-f[1]+a.offsetTop)+"px"}if(a.setWidth){b.style.width=d.offsetWidth+"px"}if(a.setHeight){b.style.height=d.offsetHeight+"px"}return b},getElementsByClassName:function(d,c){d=d.toString().strip();if(!c){c=document.body}var e=[],f=(/\s/.test(d)?es.$w(d):null);if(!f&&!d){return e}var a=es.$(c).getElementsByTagName("*");d=" "+d+" ";for(var b=0,h,g;h=a[b];b++){if(h.className&&(g=" "+h.className+" ")&&(g.include(d)||(f&&f.all(function(i){return !i.toString().blank()&&g.include(" "+i+" ")})))){e.push(h)}}return e},insertAfter:function(b,a){b=es.$(b);a=es.$(a);a.parentNode.insertBefore(b,a.nextSibling)},getPosition:function(c){c=es.$(c);var a=0,b=0;do{b+=c.offsetTop||0;a+=c.offsetLeft||0;c=c.offsetParent}while(c);return{left:a,top:b}},setPosition:function(b,f,d,g){b=es.$(b);var a=(b.style.position=="relative");if(!a){es.Dom.setStyle(b,{position:"absolute"})}var c=es.Dom.getPosition(b);var i=parseInt(b.style.left,10);var h=parseInt(b.style.top,10);if(isNaN(i)){i=(a)?0:b.offsetLeft}if(isNaN(h)){h=(a)?0:b.offsetTop}if(g){var e=es.Dom.getPosition(g);i+=e.left;h+=e.top;g=null}c.left=f-c.left+i;c.top=d-c.top+h;b.style.left=c.left+"px";b.style.top=c.top+"px";b=null},getSize:function(a){return{width:es.Dom.getWidth(a),height:es.Dom.getHeight(a)}},setSize:function(b,c,a){b=es.$(b);b.style.width=c+"px";b.style.height=a+"px"},setWidth:function(b,a){b=es.$(b);b.style.width=a+"px"},setHeight:function(a,b){a=es.$(a);a.style.height=b+"px"}};if(es.Browser.Opera){es.Dom.getStyle=es.Dom.getStyle.wrap(function(d,b,c){switch(c){case"left":case"top":case"right":case"bottom":if(d(b,"position")==="static"){return null}case"height":case"width":if(es.$(b).style.display=="none"){return null}var e=parseInt(d(b,c),10);if(e!==b["offset"+c.capitalize()]){return e+"px"}var a;if(c==="height"){a=["border-top-width","padding-top","padding-bottom","border-bottom-width"]}else{a=["border-left-width","padding-left","padding-right","border-right-width"]}return a.inject(e,function(f,g){var h=d(b,g);return h===null?f:f-parseInt(h,10)})+"px";default:return d(b,c)}});es.Dom.readAttribute=es.Dom.readAttribute.wrap(function(c,a,b){if(b==="title"){return a.title}return c(a,b)})}else{if(es.Browser.IE){es.Dom.getOffsetParent=es.Dom.getOffsetParent.wrap(function(c,b){b=es.$(b);try{b.offsetParent}catch(f){return es.$(document.body)}var a=es.Dom.getStyle(b,"position");if(a!=="static"){return c(b)}es.Dom.setStyle(b,{position:"relative"});var d=c(b);es.Dom.setStyle(b,{position:a});return d});es.$w("positionedOffset viewportOffset").each(function(a){es.Dom[a]=es.Dom[a].wrap(function(f,c){c=es.$(c);try{c.offsetParent}catch(h){return es.Dom._returnOffset(0,0)}var b=es.Dom.getStyle(c,"position");if(b!=="static"){return f(c)}var d=es.Dom.getOffsetParent(c);if(d&&es.Dom.getStyle(d,"position")==="fixed"){es.Dom.setStyle(d,{zoom:1})}es.Dom.setStyle(c,{position:"relative"});var g=f(c);es.Dom.setStyle(c,{position:b});return g})});es.Dom.cumulativeOffset=es.Dom.cumulativeOffset.wrap(function(b,a){try{a.offsetParent}catch(c){return es.Dom._returnOffset(0,0)}return b(a)});es.Dom.getStyle=function(a,b){a=es.$(a);b=(b=="float"||b=="cssFloat")?"styleFloat":b.camelize();var c=a.style[b];if(!c&&a.currentStyle){c=a.currentStyle[b]}if(b=="opacity"){if(c=(es.Dom.getStyle(a,"filter")||"").test(/alpha\(opacity=(.*)\)/)){if(c[1]){return parseFloat(c[1])/100}}return 1}if(c=="auto"){if((b=="width"||b=="height")&&(es.Dom.getStyle(a,"display")!="none")){return a["offset"+b.capitalize()]+"px"}return null}return c};es.Dom.setOpacity=function(b,e){function f(g){return g.replace(/alpha\([^\)]*\)/gi,"")}b=es.$(b);var a=b.currentStyle;if((a&&!a.hasLayout)||(!a&&b.style.zoom=="normal")){b.style.zoom=1}var d=es.Dom.getStyle(b,"filter"),c=b.style;if(e==1||e===""){(d=f(d))?c.filter=d:c.removeAttribute("filter");return b}else{if(e<0.00001){e=0}}c.filter=f(d)+"alpha(opacity="+(e*100)+")";return b}}else{if(es.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)){es.Dom.setOpacity=function(a,b){a=es.$(a);a.style.opacity=(b==1)?0.999999:(b==="")?"":(b<0.00001)?0:b;return a}}else{if(es.Browser.WebKit){es.Dom.setOpacity=function(a,b){a=es.$(a);a.style.opacity=(b==1||b==="")?"":(b<0.00001)?0:b;if(b==1){if(a.tagName.toUpperCase()=="IMG"&&a.width){a.width++;a.width--}else{try{var d=document.createTextNode(" ");a.appendChild(d);a.removeChild(d)}catch(c){}}}return a};es.Dom.cumulativeOffset=function(b){var a=0,c=0;do{a+=b.offsetTop||0;c+=b.offsetLeft||0;if(b.offsetParent==document.body){if(es.Dom.getStyle(b,"position")=="absolute"){break}}b=b.offsetParent}while(b);return es.Dom._returnOffset(c,a)}}}}}if(!document.viewport){document.viewport={getDimensions:function(){var a={};var b=es.Browser;es.$w("width height").each(function(e){var c=e.charAt(0).toUpperCase()+e.substring(1).toLowerCase();a[e]=(b.WebKit&&!document.evaluate)?self["inner"+c]:(b.Opera)?document.body["client"+c]:document.documentElement["client"+c]});return a},getWidth:function(){return this.getDimensions().width},getHeight:function(){return this.getDimensions().height},getScrollOffsets:function(){return es.Dom._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}}}es.Event={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,element:function(a){return a.target||a.srcElement},isLeftClick:function(a){return(((a.which)&&(a.which==1))||((a.button)&&(a.button==1)))},pointerX:function(a){return a.pageX||(a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft))},pointerY:function(a){return a.pageY||(a.clientY+(document.documentElement.scrollTop||document.body.scrollTop))},stop:function(a){if(es.Browser.IE){a.returnValue=false;a.cancelBubble=true}else{a.preventDefault();a.stopPropagation()}},findElement:function(c,b){var a=es.Event.element(c);while(a.parentNode&&(!a.tagName||(a.tagName.toUpperCase()!=b.toUpperCase()))){a=a.parentNode}return a},observers:false,_observeAndCache:function(d,c,b,a){if(!this.observers){this.observers=[]}if(d.addEventListener){this.observers.push([d,c,b,a]);d.addEventListener(c,b,a)}else{if(d.attachEvent){this.observers.push([d,c,b,a]);d.attachEvent("on"+c,b)}}},unloadCache:function(){if(!es.Event.observers){return}for(var a=0,b=es.Event.observers.length;a<b;a++){es.Event.stopObserving.apply(this,es.Event.observers[a]);es.Event.observers[a][0]=null}es.Event.observers=false},observe:function(d,c,b,a){d=es.$(d);a=a||false;if(c=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||d.attachEvent)){c="keydown"}es.Event._observeAndCache(d,c,b,a)},stopObserving:function(d,c,b,a){d=es.$(d);a=a||false;if(c=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||d.detachEvent)){c="keydown"}if(d.removeEventListener){d.removeEventListener(c,b,a)}else{if(d.detachEvent){try{d.detachEvent("on"+c,b)}catch(f){}}}}};if(navigator.appVersion.match(/\bMSIE\b/)){es.Event.observe(window,"unload",es.Event.unloadCache,false)}es.xmlDocument=es.Class.create({xmlobj:null,initialize:function(a){if(a){if(typeof a=="string"){this.loadXML(a)}else{this.xmlobj=a}}},setXMLObject:function(a){this.xmlobj=a},getXMLObject:function(){return this.xmlobj},loadXML:function(c){this.xmlobj=null;try{if(document.implementation.createDocument){var a=new DOMParser();this.xmlobj=a.parseFromString(c,"text/xml")}else{var a=new ActiveXObject("Microsoft.XMLDOM");a.loadXML((typeof c=="string"?c:c.toString()));this.xmlobj=a}return this}catch(b){return null}return null},$:function(b,a){var c;if(this.xmlobj){if(a!=null){c=this.xmlobj.getElementsByTagName(b)[a]}else{c=this.xmlobj.getElementsByTagName(b)[0]}if(c){return new es.xmlNode(c)}}return null}});es.xmlNode=es.Class.create({ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY_NODE:6,COMMENT_NODE:8,xmlobj:null,initialize:function(a){this.node=a;if(a){this.tagName=a.tagName;this.nodeType=a.nodeType}},setXMLNode:function(a){this.node=a;if(a){this.tagName=a.tagName;this.nodeType=a.nodeType}},getXMLNode:function(){return this.node},toArray:function(b){var a=[];var c;for(c=this.node.firstChild;c;c=c.nextSibling){if(c.nodeType==this.ELEMENT_NODE){if(c.tagName!=undefined&&(b==undefined||(b!=undefined&&b==c.tagName))){a.push(new es.xmlNode(c))}}}return a},isNull:function(){return(this.node==null)},getValue:function(){return this.toString()},$:function(b,a){if(this.node){var c=this.node.getElementsByTagName(b)[a||0];if(c){return new es.xmlNode(c)}}return null},$a:function(a){return this.node.getAttribute(a)},$len:function(c){var b=[];var d,a=0;if(this.node){for(d=this.node.firstChild;d;d=d.nextSibling){if(d.nodeType==this.ELEMENT_NODE){if(c){if(d.tagName==c){a++}}else{a++}}}}return a},getNext:function(){return this.node.nextSibling?new es.xmlNode(this.node.nextSibling):null},getPrev:function(){return this.node.previousSibling?new es.xmlNode(this.node.previousSibling):null},getFirstChild:function(){return this.node.firstChild?new es.xmlNode(this.node.firstChild):null},getLastChild:function(){return this.node.lastChild?new es.xmlNode(this.node.lastChild):null},getParent:function(){return this.node.parentNode?new es.xmlNode(this.node.parentNode):null}});es.xmlNode.prototype.getChilds=es.xmlNode.prototype.toArray;es.xmlNode.prototype.toString=function(){return(this.node&&this.node.firstChild)?this.node.firstChild.data:null};es.xml=function(a){return new es.xmlDocument(a)};if(!es.editor){es.editor={}}es.editor.ModuleManager=es.Class.create({instance:null,initialize:function(){this.instance={}},createInstance:function(name,klass,args){var ins=null;if(this.instance[name]){ins=this.instance[name]}else{if(args){for(var i=0;i<args.length;i++){if(Object.isString(args[i])){args[i]=eval("("+args[i]+")")}}}ins=this.instance[name]=new klass();ins._instanceName=name;if(ins.moduleInit){ins.moduleInit.apply(ins,args||[])}}return ins},getInstance:function(a){return this.instance[a]},releaseAll:function(){this.instance={}},broadcastCommand:function(e,d,b){for(var a in this.instance){var c=this.instance[a];if(c.execCommand){c.execCommand(e,d,b)}if(c.pluginManager&&c.pluginManager instanceof es.editor.ModuleManager){c.pluginManager.broadcastCommand(e,d,b)}}},callFn:function(e,d){for(var c in this.instance){var b=this.instance[c];var a=es.$A(arguments);a.shift();if(b[e]){b[e].apply(b,a)}}}});es.editor.Editor=es.Class.create({componentManager:null,filterManager:null,shortcut:{},parameter:{},initialize:function(){this.componentManager=new es.editor.ModuleManager();this.filterManager=new es.editor.ModuleManager()},initEditor:function(a){this.initConfig(a);this.initUI(a);this.broadcastCommand("initEditor")},initConfig:function(a){this.initFilter(a);this.initComponent(a)},initParameter:function(a){this.parameter=a},initFilter:function(config){for(var name in config.filter){var instance=this.filterManager.createInstance(name,eval(config.filter[name].cls),config.filter[name].init_arg);instance.initConfig(this,null,name,config.filter[name],config)}},initComponent:function(config){for(var name in config.component){var instance=this.componentManager.createInstance(name,eval(config.component[name].cls),config.component[name].init_arg);instance.initConfig(this,null,name,config.component[name],config)}},getFilter:function(a){return this.filterManager.getInstance(a)},getComponent:function(a){return this.componentManager.getInstance(a)},initUI:function(a){this.componentManager.callFn("initUIBase",a)},releaseAll:function(){this.broadcastCommand("preRelease");this.componentManager.callFn("releaseAll");this.filterManager.callFn("releaseAll");this.componentManager=null;this.filterManager=null},broadcastCommand:function(b,a){this.componentManager.broadcastCommand(b,a);this.filterManager.broadcastCommand(b,a)},sendCommand:function(d,c,b){var a=d.split(".");if(a[0]=="filter"){return this.getFilter(a[1])._sendCommand(d,c,b,c)}else{d="component."+d;return this.getComponent(a[0])._sendCommand(d,c,b,c)}},registShortcut:function(j){if(arguments.length>1){return this.registShortcutSub.apply(this,arguments)}for(var a in j){if(a=="dummy"){continue}var b=j[a];for(var e=0;e<b.length;e++){var c=b[e].target.split(".");var h=this.getComponent(c[0]);var f=(c[1])?h.getPlugin(c[1]):null;var g=f?f:h;var d=b[e].method?g[b[e].method]:b[e].cmd;this.registShortcutSub(b[e].key,g,d,a)}}},registShortcutSub:function(g,f,c,d){var b=g.toUpperCase().split("+");var e=0;var a=d?d:"default";if(!this.shortcut[a]){this.shortcut[a]={}}b.each(function(h){switch(h){case"CTRL":e|=4096;break;case"ALT":e|=8192;break;case"SHIFT":e|=16384;break;case"ESC":e|=es.Event.KEY_ESC;break;case"TAB":e|=es.Event.KEY_TAB;break;case"RETURN":e|=es.Event.KEY_RETURN;break;default:if(h.charCodeAt(0)<4096){e|=h.charCodeAt(0)}break}});this.shortcut[a][e]={target:f,cmd:c}}});es.editor.FilterList=es.Class.create({filters:null,initialize:function(){this.filters={_in:{_before:{},_after:{}},_out:{_before:{},_after:{}}}},initFilter:function(j,d){var e=d.filter;for(var b in e){var c=e[b];var g=c.cmd;var k=c.filter_cmd;var m=c.type;var n=c.pos;if(g.charAt(0)=="*"&&g.charAt(0)=="^"){var l=g.substr(2).split(",");g="*"}else{var l=[];var a=g.split(",")}var f=n&&n.toLowerCase()=="after"?"_after":"_before";var o=j.getFilter(b);if(o){if(m=="in"||m=="inout"){if(a&&a.length>1){for(var h=0;h<a.length;h++){if(this.filters._in[f][a[h]]){this.filters._in[f][a[h]].push({ins:o,fcmd:k,ex:l})}else{this.filters._in[f][a[h]]=[{ins:o,fcmd:k,ex:l}]}}}else{if(this.filters._in[f][g]){this.filters._in[f][g].push({ins:o,fcmd:k,ex:l})}else{this.filters._in[f][g]=[{ins:o,fcmd:k,ex:l}]}}}if(m=="out"||m=="inout"){if(a&&a.length>1){for(var h=0;h<a.length;h++){if(this.filters._out[f][a[h]]){this.filters._out[f][a[h]].push({ins:o,fcmd:k,ex:l})}else{this.filters._out[f][a[h]]=[{ins:o,fcmd:k,ex:l}]}}}else{if(this.filters._out[f][g]){this.filters._out[f][g].push({ins:o,fcmd:k,ex:l})}else{this.filters._out[f][g]=[{ins:o,fcmd:k,ex:l}]}}}}}},doFiltering:function(f,c,h,e,b){var d;if(c=="in"){d=this.filters._in[h][f]}else{if(c=="out"){d=this.filters._out[h][f]}}if(d){for(var a=0;a<d.length;a++){if(d[a].ex.length>0&&d[a].ex.include(b)){return e}var g=(d[a].fcmd)?d[a].fcmd:f;e=d[a].ins.execCommand(g,e,b)}}return e},releaseAll:function(){this.filters=null}});es.editor.ModuleBase=es.Class.create({_type:0,_version:0,_name:"",_description:"",_module_name:"",_module_path:"",_cmd_map:null,editor:null,parentModule:null,childModules:null,initialize:function(){this._cmd_map={_in:{},_out:{}};this.childModules={}},addChildModule:function(a,b){this.childModules[a]=b},getInfo:function(){return{type:this._type,name:this._name,version:this._version,description:this._description}},initCommand:function(a){for(var d=0;d<a.length;d++){var e=a[d];var b=e.cmd;var g=e.target;var f=e.target_cmd;var k=e.type;var l=null;var h=[];if(b.charAt(0)=="*"&&b.charAt(1)=="^"){h=b.substr(2).split(",");b="*"}else{l=b.split(",")}if(l&&l.length>1){for(var c=0;c<l.length;c++){if(k=="hook"){this.parentModule._cmd_map._in[l[c]]={target:this._module_name,target_cmd:f,ex:h}}else{this._cmd_map[k=="in"?"_in":"_out"][l[c]]={target:g,target_cmd:f,ex:h}}}}else{if(k=="hook"){this.parentModule._cmd_map._in[b]={target:this._module_name,target_cmd:f,ex:h}}else{this._cmd_map[k=="in"?"_in":"_out"][b]={target:g,target_cmd:f,ex:h}}}}},_handleCommand:function(f,e,c){var a=null;if(this.filters){e=this.filters.doFiltering("*","in","_before",e,f);e=this.filters.doFiltering(f,"in","_before",e,f)}var b=this._cmd_map._in["*"];if(b){a=this._sendCommand(b.target,b.target_cmd?b.target_cmd:f,e,c)}var b=this._cmd_map._in[f];if(b){a=this._sendCommand(b.target,b.target_cmd?b.target_cmd:f,e,c)}var d=this["onCmd"+f.charAt(0).toUpperCase()+f.substring(1)];if(d){a=d.call(this,e,c)}if(this.filters){a=this.filters.doFiltering("*","in","_after",a,f);a=this.filters.doFiltering(f,"in","_after",a,f)}return a},execCommand:function(c,b,a){return this._handleCommand(c,b,a)},_sendCommand:function(f,e,d,c){if(this.filters){d=this.filters.doFiltering("*","out","_before",d,e);d=this.filters.doFiltering(e,"out","_before",d,e)}var b;var a=f.split(".");switch(a[0].toLowerCase()){case"component":if(a[1]=="*"){this.editor.componentManager.broadcastCommand(e,d)}else{f=this.editor.getComponent(a[1]);if(a[2]=="plugin"){if(a[3]=="*"){if(f.pluginManager){f.pluginManager.broadcastCommand(e,d,c)}}else{f=f.pluginManager.getInstance(a[3]);if(f&&f.execCommand){b=f.execCommand(e,d,c)}}}else{if(f&&f.execCommand){b=f.execCommand(e,d,c)}}}break;case"plugin":if(a[1]=="*"){if(this.pluginManager){this.pluginManager.broadcastCommand(e,d,c)}}else{f=this.pluginManager.getInstance(a[1]);if(f&&f.execCommand){b=f.execCommand(e,d,c)}}break;case"filter":f=this.editor.getFilter(a[1]);if(f&&f.execCommand){b=f.execCommand(e,d,c)}break;default:f=this.editor.getComponent(f)||this.pluginManager.getInstance(f)||this.editor.getFilter(f);if(f&&f.execCommand){b=f.execCommand(e,d,c)}}if(this.filters){b=this.filters.doFiltering("*","out","_after",b,e);b=this.filters.doFiltering(e,"out","_after",b,e)}return b},sendCommand:function(d,c){var a;var b=this._cmd_map._out["*"];if((b&&b.ex.length==0)||(b&&b.ex.length>0&&!b.ex.include(d))){a=this._sendCommand(b.target,b.target_cmd?b.target_cmd:d,c,d)}var b=this._cmd_map._out[d];if(b){a=this._sendCommand(b.target,b.target_cmd?b.target_cmd:d,c,d)}return a},getParent:function(){return this.parentModule},registShortcut:function(b,a){this.editor.registShortcut(b,this,a)},getParameter:function(a){if(this.editor){var b=this.editor.parameter[a];if(b){return b}}return null}});es.editor.ComponentBase=es.Class.create(es.editor.ModuleBase,{pluginManager:null,filters:null,element:null,elements:null,initialize:function($super){this._type=4;this.elements={};this.filters=new es.editor.FilterList;this.pluginManager=new es.editor.ModuleManager();$super()},initConfig:function(e,d,c,a,b){this.editor=e;this.parentModule=d;this._module_name="component."+c;this._module_path=a.path;this.filters.initFilter(e,a);this.initPlugin(a.plugin,b);if(a.command){this.initCommand(a.command)}},initPlugin:function(plugins,config){if(plugins){for(var i=0;i<plugins.length;i++){var name=plugins[i];var plugin=config.plugin[name];var instance=this.pluginManager.createInstance(name,eval(config.plugin[name].cls),config.plugin[name].init_arg);instance.initConfig(this.editor,this,name,config.plugin[name],config)}}},getPlugin:function(a){return this.pluginManager.getInstance(a)},initUIBase:function(d){var c=(this._module_name.split("."))[1];var f=d.ids[c];var e=0;var a=this.createUI(f);if(a){f=a}for(var b in f){this.elements[b]=es.$(f[b]);if(!this.element){this.element=this.elements[b]}if(b=="default"){this.element=this.elements[b]}e++}if(this.initUI){this.initUI()}this.pluginManager.callFn("initUIBase",d,this.element)},createUI:function(a){},releaseAll:function(){if(this.release){this.release()}this.filters.releaseAll();this.filters=null;this.editor=null;this.element=null;this.elements=null;this.parentModule=null;this.pluginManager.callFn("releaseAll");this.pluginManager=null}});es.editor.PluginBase=es.Class.create(es.editor.ModuleBase,{filters:null,element:null,elements:null,initialize:function($super){this._type=8;this.elements={};this.filters=new es.editor.FilterList;$super()},initConfig:function(e,d,c,a,b){this.editor=e;this.parentModule=d;this._module_name="plugin."+c;this._module_path=a.path;this.filters.initFilter(e,a);if(a.command){this.initCommand(a.command)}},initUIBase:function(e,b){var d=(this._module_name.split("."))[1];var g=e.ids[d];var f=0;var a=this.createUI(g,b);if(a){g=a}for(var c in g){this.elements[c]=es.$(g[c]);if(!this.element){this.element=this.elements[c]}if(c=="default"){this.element=this.elements[c]}f++}if(f==1&&!this.element){this.element=this.elements[c]}if(this.initUI){this.initUI()}},createUI:function(b,a){},releaseAll:function(){if(this.release){this.release()}this.filters.releaseAll();this.filters=null;this.editor=null;this.element=null;this.elements=null;this.parentModule=null}});es.editor.FilterBase=es.Class.create(es.editor.ModuleBase,{initialize:function($super){this._type=12;$super()},initConfig:function(e,d,c,a,b){this.editor=e;this.parentModule=d;this._module_name="filter."+c;this._module_path=a.path;if(a.command){this.initCommand(a.command)}},releaseAll:function(){if(this.release){this.release()}}});if(!es.component){es.component={}}if(!es.plugin){es.plugin={}}if(!es.filter){es.filter={}}var DialogUtil={selected:null,_dialogs:[],closeAllDialogs:function(d,c){var b=DialogUtil._dialogs,e;for(var a=0;a<b.length;a++){e=b[a];if(e.isDialogVisible()&&(d||!e.isFloatingDialog)&&(!c||(c&&c.parentDlg!=e))){e.hideDialog()}}DialogUtil.selected=null},checkVisibleDialogs:function(){var b=DialogUtil._dialogs,c;for(var a=0;a<b.length;a++){c=b[a];if(c.isDialogVisible()){return true}}return false}};DialogUtil.prototype={initDialog:function(){if(this.dialog){DialogUtil._dialogs.push(this);if(es.Browser.IE){var a=function(b){es.Event.stop(b)}}else{var a=function(b){if(b){b._isValidEvent=true}}}es.Event.observe(this.dialog,"mousedown",a);if(this.isFloatingDialog){es.Event.observe(this.movingBar,"mousedown",this.onMovingBarMouseDown.bindAsEventListener(this));es.Event.observe(this.sendCommand("getDocument"),"mousemove",this.onMovingBarMouseMove.bindAsEventListener(this));es.Event.observe(this.dialog,"mousemove",this.onMovingBarMouseMove.bindAsEventListener(this));es.Event.observe(this.sendCommand("getDocument"),"mouseup",this.onMovingBarMouseUp.bindAsEventListener(this));es.Event.observe(this.dialog,"mouseup",this.onMovingBarMouseUp.bindAsEventListener(this))}}},toggleDialog:function(b,a,c){if(this.isDialogVisible()){return this.hideDialog(b)}else{return this.showDialog(b,a,c)}},showDialog:function(c,b,d){var a;DialogUtil.closeAllDialogs(true,this);if(this.beforeShowDialog){a=this.beforeShowDialog(c);if(!this.__checkDialogResult(a)){return false}}this.__showDialog(b,d);if(es.Browser.IE){this.dialog.focus()}if(this.clearInput){this.clearInput()}if(this.afterShowDialog){a=this.afterShowDialog(c);if(!this.__checkDialogResult(a)){this.__hideDialog();return false}}DialogUtil.selected=this;this.checkDialogInEditor(b,d);return true},__checkDialogResult:function(a){if(typeof(a)=="undefined"){return true}else{return a}},hideDialog:function(b){var a;if(this.beforeHideDialog){a=this.beforeHideDialog(b);if(!this.__checkDialogResult(a)){return false}}this.__hideDialog();if(this.clearInput){this.clearInput()}if(this.afterHideDialog){a=this.afterHideDialog(b);if(!this.__checkDialogResult(a)){this.__showDialog();return false}}return true},__showDialog:function(a,c){this.dialog.style.display="";var b=es.Dom.getPosition(this.dialog);if(typeof a!="number"){a=b.left}if(typeof c!="number"){c=b.top}es.Dom.setPosition(this.dialog,a,c)},__hideDialog:function(){this.dialog.style.display="none";if(!DialogUtil.checkVisibleDialogs()){this.sendCommand("setFocus")}},isDialogVisible:function(){return this.dialog.style.display!="none"},onMovingBarMouseDown:function(a){this.moveStart=true;this.startX=a.screenX;this.startY=a.screenY;this.currLeft=parseInt(this.dialog.style.left);this.currTop=parseInt(this.dialog.style.top);es.Event.stop(a)},onMovingBarMouseMove:function(b){if(this.moveStart){this.diffX=b.screenX-this.startX;this.diffY=b.screenY-this.startY;var a=(this.currLeft+this.diffX);var c=(this.currTop+this.diffY);if(this.checkDialogInEditor(a,c)){this.dialog.style.left=a+"px";this.dialog.style.top=c+"px"}es.Event.stop(b)}},checkDialogInEditor:function(c,e){if(!this.dialogSize){return}var d=c+this.dialogSize.width;var a=e+this.dialogSize.height;var b=true;if(c<=this.minLeft){b=false;this.dialog.style.left=this.minLeft+"px"}if(this.maxRight<=d){b=false;this.dialog.style.left=(this.maxRight-this.dialogSize.width)+"px"}if(e<=this.minTop){b=false;this.dialog.style.top=this.minTop+"px"}if(this.maxBottom<=a){b=false;this.dialog.style.top=(this.maxBottom-this.dialogSize.height)+"px"}return b},onMovingBarMouseUp:function(a){this.moveStart=false;es.Event.stop(a)}};var DomUtil={getAncestorNode:function(a,b){while(a){if(DomUtil.equalsNodeName(a,b)){return a}else{a=a.parentNode}}},equalsNodeName:function(a,b){if(a.nodeName){return(a.nodeName.toUpperCase()==b.toUpperCase())}else{return false}},getOuterHTML:function(a){if(a.nodeType==3){return a.nodeValue}if(a.outerHTML){return a.outerHTML}return(new XMLSerializer).serializeToString(a)},getFirstTerminalNode:function(a){for(;a&&a.firstChild;){for(a=a.firstChild;a&&(!a.nodeType||(a.nodeType!=1&&a.nodeType!=3));a=a.nextSibling){}}return a},getLastTerminalNode:function(a){for(;a&&a.lastChild;){for(a=a.lastChild;a&&(!a.nodeType||(a.nodeType!=1&&a.nodeType!=3));a=a.previousSibling){}}return a},getNextTerminalNode:function(b){if(!b){return null}var a=null;if(b.nextSibling||!b.parentNode){a=b.nextSibling}else{for(;b.parentNode&&!b.nextSibling;b=b.parentNode){}a=b.nextSibling}for(;a&&a.firstChild;){for(a=a.firstChild;a&&(!a.nodeType||(a.nodeType!=1&&a.nodeType!=3));a=a.nextSibling){}}return a},getPrevTerminalNode:function(b){if(!b){return null}var a=null;if(b.previousSibling||!b.parentNode){a=b.previousSibling}else{for(;b.parentNode&&!b.previousSibling;b=b.parentNode){}a=b.previousSibling}for(;a&&a.lastChild;){for(a=a.lastChild;a&&(!a.nodeType||(a.nodeType!=1&&a.nodeType!=3));a=a.previousSibling){}}return a},splitText:function(e,h,g,c){var d=e.parentNode;var f=null,b=null;if(typeof c=="undefined"){c=false}if(e.nodeType!=3){if(c){var a=document.createTextNode("");if(h==0){d.insertBefore(a,e);f=a;b=e}else{d.insertBefore(a,e.nextSibling);f=e;b=a}}else{if(h==0){f=e.previousSibling;b=e}else{f=e;b=e.nextSibling}}}else{if(c||(h>0&&h<e.length)){f=e;b=e.splitText(h);d.insertBefore(b,f.nextSibling)}else{if(h==0){f=e.previousSibling;b=e}else{f=e;b=e.nextSibling}}}return{left:f,right:b}},_splitTextNode:function(h,g,f,b){var d;var a=h.parentNode;var e=a.cloneNode(false);if(typeof b=="undefined"){b=false}for(var c=a.firstChild;c;){if(c==h){if(g==0){break}if(c.nodeType==3){if(g==c.length){e.appendChild(c);break}e.appendChild(this.splitText(c,g,f,b).left)}else{e.appendChild(c)}break}d=c.nextSibling;e.appendChild(c);c=d}if(!b){if(a.childNodes.length==0){var d=a.nextSibling;if(d){d.parentNode.insertBefore(e,d)}else{a.parentNode.appendChild(e)}a.parentNode.removeChild(a);a=d}else{if(e.childNodes.length==0){e=a.previousSibling}else{a.parentNode.insertBefore(e,a)}}}else{a.parentNode.insertBefore(e,a)}return{left:e,right:a}},_splitElementSub:function(f,b,a){if(f==null){return{left:null,right:b.parentNode}}if(b==null){return{left:f.parentNode,right:null}}var d;var b=f.parentNode;var e=b.cloneNode(false);if(typeof a=="undefined"){a=false}for(var c=b.firstChild;c;){d=c.nextSibling;e.appendChild(c);if(c==f){break}c=d}f=e;if(!a){if(b.childNodes.length==0){var d=b.nextSibling;if(d){d.parentNode.insertBefore(f,d)}else{b.parentNode.appendChild(f)}b.parentNode.removeChild(b);b=d}else{if(f.childNodes.length==0){f=b.previousSibling}else{b.parentNode.insertBefore(f,b)}}}else{b.parentNode.insertBefore(f,b)}return{left:f,right:b}},splitElement:function(f,c,e,g,b){var a=null;if(c.parentNode==f){a=f.parentNode}var i=this._splitTextNode(c,e,g,b);var d=i.left;var h=i.right;while(f&&f.parentNode&&f.tagName.toUpperCase()!="BODY"){if(d==f||h==f){break}if(a&&((d&&d.parentNode==a)||(h&&h.parentNode==a))){break}i=this._splitElementSub(d,h,b);d=i.left;h=i.right}return{left:d,right:h}},setElementStyle:function(b,c){for(var a in c){b.style[a.camelize()]=c[a]}},wrapTextNode:function(a,f,e,g){var d=f.parentNode;var c=f.nextSibling;var b=g.createElement(a);DomUtil.setElementStyle(b,e);d.insertBefore(b,c);b.appendChild(f);return b},getElementStyleObject:function(c){var a={};var e=c.style.cssText.split(";");for(var b=0;b<e.length;b++){var d=e[b].trim();if(d.length>0){var f=d.split(":");a[f[0].toLowerCase()]=f[1].trim()}}return a},regexp_replacePofHR:/<P\s+align\s*=\s*(['"]?.*['"]?)[^>]*>(\s*<HR[^>]*>\s*)<\/P>/gmi,regexp_removePofHR:/(<P[^>]*>)([\s\S]*)(<HR[^>]*>\s*)+([\s\S]*)<\/P>/gmi,regexp_replaceHRWidth:/(<HR.+style=['"]?.*)width:\s?\d+px;?(.*['"]?[^>]*>)/gmi,regexp_replaceDIVofHR:/<DIV\s+align\s*=\s*(['"]?.*['"]?)>(\s*<HR[^>]*>\s*)<\/DIV>/gmi,regexp_HR:/<HR/mi,regexp_removeWrapDIV1:/<\!--espresso editor content start--><div id=['"]?espresso_editor_view['"]?\s*(style="[^">]*")?>/mi,regexp_removeWrapDIV2:/<\/div><\!--espresso editor content end-->/mi,regexp_removeWrapDIV3:/<div id=['"]?espresso_editor_view['"]?\s*(style="[^">]*")?>/mi,replacePofHR:function(a){if(this.regexp_HR.test(a)){a=a.replace(this.regexp_replacePofHR,"$2");a=a.replace(this.regexp_replaceHRWidth,"$1WIDTH: 100%;$2")}return a},replaceDIVofHR:function(a){return this.regexp_HR.test(a)?a.replace(this.regexp_replaceDIVofHR,"$2"):a},removePofHR:function(a){if(this.regexp_HR.test(a)){a=a.replace(this.regexp_removePofHR,"$1$2</P>$3$1$4</P>")}return a},removeWrapDIV:function(a){if(this.regexp_removeWrapDIV3.test(a)){a=a.replace(this.regexp_removeWrapDIV1,"");a=a.replace(this.regexp_removeWrapDIV2,"")}return a},firstDescendant:function(a){a=a.firstChild;while(a&&a.nodeType!=1){a=a.nextSibling}return a},disableSelection:function(a){if(es.Browser.Gecko){a.style.MozUserSelect="none"}else{if(es.Browser.WebKit){a.style.KhtmlUserSelect="none"}else{if(es.Browser.IE||es.Browser.Opera){a.unselectable="on"}}}return a},wrap:function(g,c,f,e){var h=g.getElementsByTagName(c);var a,d;for(var b=h.length-1;b>=0;b--){d=h[b];a=g.createElement(f);a.className=e;a=d.parentNode.insertBefore(a,d);d=a.parentNode.removeChild(d);a.appendChild(d)}},strip:function(d,c){var a=es.Dom.getElementsByClassName(c,d);for(var b in a){a[b].outerHTML=a[b].innerHTML}},getElementsByName:function(g,b,d){if(es.Browser.IE){var e=g.getElementsByTagName(d);var f=new Array();var h;for(var c=0;c<e.length;c++){h=e[c].name;if(h==b){f.push(e[c])}}return f}else{var a=g.getElementsByName(b);var f=[];for(var c=0;c<a.length;c++){f.push(a[c])}return f}},getParentElement:function(d,f,b,e){if(typeof(f)=="undefined"){if(d.nodeType==1){return d}while((d=d.parentNode)!=null&&d.nodeType!=1){}return d}if(d==null){return null}var a=f.toUpperCase().split(",");do{for(var c=0;c<a.length;c++){if(d.nodeName==a[c]||f=="*"){if(typeof(b)=="undefined"){return d}else{if(d.getAttribute(b)){if(typeof(e)=="undefined"){if(d.getAttribute(b)!=""){return d}}else{if(d.getAttribute(b)==e){return d}}}}}}}while((d=d.parentNode)!=null);return null}};(function(){var a=function(b){this.color={h:0,s:1,v:1,r:255,g:0,b:0,toRGB:function(){return"rgb("+this.r+","+this.g+", "+this.b+")"}};this.isSVActivated=false;this.isHueActivated=false;this.isInitiatedCoord=false;this.element=es.$(b.id[0]);this.svPalette=es.$(b.id[1]);this.svPointer=es.$(b.id[2]);this.huePalette=es.$(b.id[3]);this.huePointer=es.$(b.id[4]);this.selected=es.$(b.id[5]);this.rgbInput=es.$(b.id[6]);this.rgbInput.value="ff0000";this.closeBtn=es.$(b.id[7]);es.Event.observe(es.$(b.id[8]),"click",function(){this.hide(null)}.bindAsEventListener(this));this._attachEvent();this.options={notifySelectingColor:b.notifySelectingColor,notifyChangingColor:b.notifyChangingColor}};a.prototype={TYPE_RGB:0,TYPE_HSV:1,TYPE_HEX:2,SIZE_SVPOINTER:7,SIZE_IECORRECT:2,_attachEvent:function(){es.Event.observe(this.svPalette,"mousedown",function(c){this.isSVActivated=true;this.handleSVMove(c)}.bindAsEventListener(this));var b=this.svPalette.parentNode.parentNode;es.Event.observe(b,"mousemove",this.handleSVMove.bindAsEventListener(this));es.Event.observe(b,"mouseup",function(){this.isSVActivated=false}.bindAsEventListener(this));es.Event.observe(this.huePalette,"mousedown",function(c){this.isHueActivated=true;this.handleHMove(c)}.bindAsEventListener(this));es.Event.observe(this.huePalette,"mousemove",this.handleHMove.bindAsEventListener(this));es.Event.observe(this.huePalette,"mouseup",function(){this.isHueActivated=false}.bindAsEventListener(this));es.Event.observe(this.huePointer,"mousedown",function(c){this.isHueActivated=true;this.handleHMove(c)}.bindAsEventListener(this));es.Event.observe(this.huePointer,"mouseup",function(){this.isHueActivated=false}.bindAsEventListener(this));es.Event.observe(this.closeBtn,"click",this.finishColoring.bindAsEventListener(this));es.Event.observe(this.rgbInput,"keyup",this.handleRGBInput.bindAsEventListener(this));es.Event.observe(document,"mouseup",function(){this.isHueActivated=false;this.isSVActivated=false}.bindAsEventListener(this));if(es.Browser.IE){this._disableSelectInIE(this.huePalette.parentNode)}},_disableSelectInIE:function(b){var d;for(var c=0,e=b.childNodes.length;c<e;c++){d=b.childNodes[c];if(d.nodeType==1){DomUtil.disableSelection(d);if(d.childNodes.length>0){this._disableSelectInIE(d)}else{return}}else{return}}},show:function(b){this.element.style.display="block";if(!this.isInitiatedCoord){var c=es.Dom.getDimensions(this.svPalette);this.options=Object.extend({width:c.width,height:c.height,widthOfBar:(es.Dom.getWidth(this.huePalette)-2)},this.options);this.isInitiatedCoord=true}this.update(b)},hide:function(b){if(b&&this.isInitiatedCoord){this.setColor(this.TYPE_HEX,b)}this.element.style.display="none"},update:function(b){var c=es.Dom.cumulativeOffset(this.svPalette);this.options.offsetX=c[0];this.options.offsetY=c[1];this.options.offsetXofBar=(es.Dom.cumulativeOffset(this.huePalette)[0]);if(b){this.setColor(this.TYPE_HEX,b)}},isVisible:function(){return this.element.style.display!="none"},handleRGBInput:function(c){if((c.keyCode>=48&&c.keyCode<=57)||(c.keyCode>=65&&c.keyCode<=70)||(c.keyCode>=96&&c.keyCode<=105)||(c.keyCode==es.Event.KEY_RETURN)||(c.keyCode==es.Event.KEY_LEFT)||(c.keyCode==es.Event.KEY_RIGHT)||(c.keyCode==es.Event.KEY_HOME)||(c.keyCode==es.Event.KEY_END)||(c.keyCode==es.Event.KEY_END)||(c.keyCode==es.Event.KEY_TAB)||(c.keyCode==es.Event.KEY_BACKSPACE)){var d=this.rgbInput.value;var e=(d.search(/[^a-fA-F0-9]/g)==-1);d=d.replace(/[^a-fA-F0-9]/g,"");var b=ColorConverter.hexToRGB(d);this.setColor(this.TYPE_RGB,b.r,b.g,b.b);if(!e){this.rgbInput.value=d}if(c.keyCode==es.Event.KEY_RETURN){this.rgbInput.blur();this.finishColoring();es.Event.stop(c)}}else{this.rgbInput.value=this.rgbInput.value.replace(/[^a-fA-F0-9]/g,"");es.Event.stop(c)}},handleHMove:function(d){if(this.isHueActivated){var b=es.Event.pointerX(d)-this.options.offsetXofBar;if(es.Browser.IE){b-=this.SIZE_IECORRECT}if(b<0){b=0}else{if(b>this.options.widthOfBar){b=this.options.widthOfBar}}var c=Math.round((b/this.options.widthOfBar)*360);if(c<0){c=0}else{if(c>360){c=360}}this.setColor(this.TYPE_HSV,c,this.color.s,this.color.v);this.huePointer.style.left=(b+this.SIZE_SVPOINTER)+"px"}es.Event.stop(d)},handleSVMove:function(g){if(this.isSVActivated){var b=es.Event.pointerX(g),h=es.Event.pointerY(g);if(es.Browser.IE){b-=this.SIZE_IECORRECT;h-=this.SIZE_IECORRECT}var f=(b-this.options.offsetX);var e=(h-this.options.offsetY);if(f>=0&&f<=this.options.width&&e>=0&&e<=this.options.height){var d=f/this.options.width;var c=1-e/this.options.height;if(d<0){d=0}else{if(d>1){d=1}}if(c<0){c=0}else{if(c>1){c=1}}this.setColor(this.TYPE_HSV,this.color.h,d,c);this.svPointer.style.top=e-this.SIZE_SVPOINTER+"px";this.svPointer.style.left=f-this.SIZE_SVPOINTER+"px"}}es.Event.stop(g)},finishColoring:function(){var b=this.rgbInput.value;var c=(b.search(/[^a-fA-F0-9]/g)==-1);if(c){this.options.notifySelectingColor("#"+b)}else{alert("     .\n    . \n\n ) ff0000, ff3d50, 00FFFF, 020201")}},setColor:function(d){if(!this.isInitiatedCoord){return}switch(d){case this.TYPE_HEX:var c=ColorConverter.hexToRGB(arguments[1]);this.color=ColorConverter.rgbToHSV(c.r,c.g,c.b,this.color);break;case this.TYPE_RGB:this.color=ColorConverter.rgbToHSV(arguments[1],arguments[2],arguments[3],this.color);break;case this.TYPE_HSV:this.color=ColorConverter.hsvToRGB(arguments[1],arguments[2],arguments[3],this.color);break;default:return}if(d==this.TYPE_HSV||d==this.TYPE_HEX){this.rgbInput.value=ColorConverter.rgbToHex(this.color.r,this.color.g,this.color.b)}if(d==this.TYPE_RGB||d==this.TYPE_HEX){this.huePointer.style.left=(this.color.h/360*this.options.widthOfBar+this.SIZE_SVPOINTER)+"px";this.svPointer.style.top=(1-this.color.v)*this.options.height-this.SIZE_SVPOINTER+"px";this.svPointer.style.left=this.color.s*this.options.width-this.SIZE_SVPOINTER+"px"}var b=ColorConverter.hsvToRGB(this.color.h,1,1);this.svPalette.style.backgroundColor="rgb("+b.r+", "+b.g+", "+b.b+")";this.selected.style.backgroundColor=this.color.toRGB();this.options.notifyChangingColor(this.rgbInput.value)},getColor:function(){return this.rgbInput.value}};es.plugin.ColorSpectrum=a})();var ColorConverter={hsvToRGB:function(l,z,x,d){if(d){d.h=l;d.s=z;d.v=x}if(x==0){return this._setRGB(0,0,0,d)}if(l==360){l=0}var k,n,j,c,y,u,a,m,w;l/=60;k=Math.floor(l);n=l-k;j=x*(1-z);c=x*(1-n*z);y=x*(1-(1-n)*z);try{u=[[x,y,j],[c,x,j],[j,x,y],[j,c,x],[y,j,x],[x,j,c]][k];a=Math.floor(255*u[0]);m=Math.floor(255*u[1]);w=Math.floor(255*u[2])}catch(o){if(debug){debug("rgb: "+u+", exception: "+o)}}return this._setRGB(a,m,w,d)},_setRGB:function(d,c,a,b){if(b){b.r=d;b.g=c;b.b=a;return b}else{return{r:d,g:c,b:a}}},rgbToHSV:function(k,j,c,d){if(d){d.r=k;d.g=j;d.b=c}var i,f,a,e;k/=255;j/=255;c/=255;var a=Math.max(k,Math.max(j,c));var e=Math.min(k,Math.min(j,c));if(a==e){i=0}else{if(a==k){i=(60*((j-c)/(a-e)))%360}else{if(a==j){i=60*(c-k)/(a-e)+120}else{i=60*(k-j)/(a-e)+240}}}if(i<0){i=360+i}else{if(i>360){i=i-360}}if(a==0){f=0}else{f=1-e/a}if(d){d.h=i;d.s=f;d.v=a;return d}else{return{h:i,s:f,v:a}}},rgbToHex:function(){var c=function(b){if(b.length==1){b="0"+b}return b};var f,e,a;if(arguments.length==1){var d=arguments[0];f=d.r.toString(16);e=d.g.toString(16);a=d.b.toString(16)}else{if(arguments.length==3){f=arguments[0].toString(16);e=arguments[1].toString(16);a=arguments[2].toString(16)}else{return}}return c(f)+c(e)+c(a)},hexToRGB:function(a){a=a.replace(/[^a-fA-F0-9]/g,"");a=this.fixHex(a);return{r:Number("0x"+a.substring(0,2)),g:Number("0x"+a.substring(2,4)),b:Number("0x"+a.substring(4))}},fixHex:function(c){if(c.length<6){for(var b=0,a=6-c.length;b<a;b++){c="0"+c}}else{if(c.length>6){c=c.substring(0,5)}}return c}};var AttachUtil={randumNumber:0,attachList:{},attachListStack:null,attachListStackIndex:0,popup:null,maxAttachSize:10240*1024,cbLoadEnded:[],popupCommonStorageStack:null,_stackLimit:50,cloneObject:function(c){var b={};for(var a in c){if(typeof c[a]=="object"){b[a]=this.cloneObject(c[a])}else{if(c[a] instanceof Array){b[a]=new Array();for(var d=0;d<c[a].length;d++){b[a][d]=this.cloneObject(c[a][d])}}else{b[a]=c[a]}}}return b},pushList:function(b,a){this._stackLimit=b;if(!this.attachListStack){this.attachListStack=[this.cloneObject(this.attachList)];this.attachListStackIndex=0;this.popupCommonStorageStack=[this.getPCS()]}if(this.attachListStackIndex<this.attachListStack.length-1){this.attachListStack.length=this.attachListStackIndex+1;this.popupCommonStorageStack.length=this.attachListStackIndex+1}if(a!=true){if(this.attachListStackIndex<this.attachListStack.length-1){this.attachListStack.length=this.attachListStackIndex+1;this.popupCommonStorageStack.length=this.attachListStackIndex+1}}else{this.attachListStack.length=this.attachListStackIndex+1;this.popupCommonStorageStack.length=this.attachListStackIndex+1;this.attachListStackIndex--}this.attachListStack.push(this.cloneObject(this.attachList));this.popupCommonStorageStack.push(this.getPCS());this.attachListStackIndex++;if(this.attachListStack.length>b){this.attachListStack.shift();this.popupCommonStorageStack.shift();this.attachListStackIndex--}},undoList:function(){if(!this.attachListStack){return}if(this.attachListStackIndex==this.attachListStack.length-1){this.pushList(this._stackLimit,true)}this.attachListStackIndex--;if(this.attachListStackIndex<0){this.attachListStackIndex=0}this.attachList=this.cloneObject(this.attachListStack[this.attachListStackIndex]);this.setPCS(this.popupCommonStorageStack[this.attachListStackIndex])},redoList:function(){if(!this.attachListStack){return}this.attachListStackIndex++;if(this.attachListStackIndex>=this.attachListStack.length){this.attachListStackIndex=this.attachListStack.length-1}this.attachList=this.cloneObject(this.attachListStack[this.attachListStackIndex]);this.setPCS(this.popupCommonStorageStack[this.attachListStackIndex])},openPopup:function(g,c,a,b,d){if(!es.Browser.IE){c-=20;a+=20}this.popup=window.open(b,g,"width="+c+", height="+a+",toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=yes");try{this.popup._popupHost=this;this.popup._openerObject=d}catch(f){}this.popupCommonStorage.popup_opener=d},popupCommonStorage:{total_size:0,totImgSize:0,totalAttachSize:0},getPCS:function(){return{total_size:this.popupCommonStorage.total_size,totImgSize:this.popupCommonStorage.totImgSize,totalAttachSize:this.popupCommonStorage.totalAttachSize}},setPCS:function(a){this.popupCommonStorage.total_size=a.total_size;this.popupCommonStorage.totImgSize=a.totImgSize;this.popupCommonStorage.totalAttachSize=a.totalAttachSize},addAttach:function(b,a){if(!this.attachList[a.type]){this.attachList[a.type]={}}if(this.attachList[a.type][b]){return false}else{this.attachList[a.type][b]=a;this.popupCommonStorage.totalAttachSize+=a.size;this.popupCommonStorage.total_size=this.popupCommonStorage.totalAttachSize;return true}},removeAttach:function(a,c){var b=this.getAttachedInfo(a,c);if(b){if(b.deleted!=true){this.popupCommonStorage.totalAttachSize-=b.size;this.popupCommonStorage.total_size=this.popupCommonStorage.totalAttachSize}this.attachList[a][c].deleted=true}},getAttach:function(b){for(var a in this.attachList){if(a[b]){return a[b]}}return null},closePopup:function(){if(this.popup){this.popup.close()}},getAttachedInfoList:function(b){var a=[];var d=this.attachList[b];if(d){for(var c in d){a.push(d[c])}}return a},getAttachedDataList:function(b){var a=new Array();var d=this.attachList[b];if(d){for(var c in d){if(d[c].deleted!=true){a.push(d[c].data)}}}return a},getAttachedTypeList:function(){var a=[];for(var b in this.attachList){a.push(b)}return a},getAttachedInfo:function(a,c){var b=this.attachList[a];return b[c]},translateProxy:function(x,m){var b=document.getElementById("espresso_contents_tmp");var k=document.getElementById("espresso_attach_tmp");if(!b){b=document.createElement("div");b.id="espresso_contents_tmp";b.style.display="none";document.body.appendChild(b);k=document.createElement("div");k.id="espresso_attach_tmp";document.body.appendChild(k)}this.convertMoreLessContents(x);b.innerHTML=x.body.innerHTML;espresso.sendCommand("toolbar.plugin.MoreLessBtn","checkMoreLessControl",document);for(var c in this.attachList){var w=this.attachList[c];for(var o in w){var j=w[o];if(j.proxy&&j.proxy==true&&j.html){while(true){var v=document.getElementById("proxy_"+j.id);if(v){var p=v.nextSibling;var h=v.parentNode;if(c=="image"){if(h.nodeType==1&&h.nodeName.toLowerCase()=="a"&&h.childNodes.length==1){v.id=j.id}else{v.id=j.id;var f=document.createElement("A");f.href=v.src;f.target="_blank";f.appendChild(v);h.insertBefore(f,p)}}else{if(c=="flash"){var q=parseInt(v.style.width);var l=parseInt(v.style.height);h.removeChild(v);k.innerHTML=j.html;var n=k.firstChild;n.width=q;n.height=l;n.style.width=q+"px";n.style.height=l+"px";for(var r=0;r<n.childNodes.length;r++){var e=n.childNodes[r];if(e.tagName.toLowerCase()=="embed"){e.width=q;e.height=l;e.style.width=q+"px";e.style.height=l+"px";break}}var g=n.getAttribute("swaf:cywrite:info");if(g==null){g="|||0|||||"}var d=g.lastIndexOf("|",g.lastIndexOf("|")-1);var a=g.substring(0,d)+"|"+q+"|"+l;n.setAttribute("swaf:cywrite:info",a);h.insertBefore(n,p)}else{h.removeChild(v);k.innerHTML=(m&&j.preview_html&&j.preview_html.length>0)?j.preview_html:j.html;var u=k.childNodes;if(u&&u.length>0){for(var r=0;r<u.length;r++){var e=u[r];h.insertBefore(e,p)}}}}}else{break}}}}}var t=b.innerHTML;b.innerHTML="";k.innerHTML="";if(!es.Browser.IE){t=t.replace("%5B%5D","[]")}return t},syncAttach:function(f){var a=new Array();var d=new Array();for(var c in this.attachList){var h=this.attachList[c];if(h){for(var g in h){var e=h[g];if(e.syncDoc==true){var b=f.getElementById((e.proxy==true)?"proxy_"+g:g);if(!b){this.removeAttach(c,g);a.push({type:c,id:g})}else{if(h[g].deleted==true){this.popupCommonStorage.totalAttachSize+=e.size;this.popupCommonStorage.total_size=this.popupCommonStorage.totalAttachSize;d.push({type:c,id:g})}h[g].deleted=false}}}}}return{deleted:a,added:d}},convertMoreLessContents:function(e){var d=DomUtil.getElementsByName(e,"espresso_moreLessDiv","div");var a;var b;var c;for(a=0;a<d.length;a++){this.combineMoreLessContents(d[a])}},combineMoreLessContents:function(d){var c="";var e=null;var b=d.getElementsByTagName("div");for(var a=0;a<b.length;a++){if(b[a].className=="fold_cont"){c+="<p>"+b[a].innerHTML+"</p>";b[a].innerHTML="";if(b[a].id&&b[a].id.substr(0,"espresso_moreLessContents_".length)=="espresso_moreLessContents_"){e=b[a]}}}if(e){e.innerHTML=c}for(var a=0;a<b.length;a++){if(b[a].className=="fold_cont"&&b[a]!=e){d.removeChild(b[a])}}}};(function(){var a=es.Class.create(es.editor.PluginBase,{_url:"",_width:400,_heigth:400,_limit:0,_curCount:0,_attachType:"",_cntStack:null,_undoIndex:0,_stackLimit:50,initialize:function($super){if(AttachUtil.randumNumber==0){var b=new Date();var d=new Date(b.toGMTString());var f=d.getYear()+"";f=f.substring(f.length-2);var h=(d.getMonth()<10)?"0"+(d.getMonth()+1):d.getMonth()+"";var c=(d.getDate()<10)?"0"+d.getDate():d.getDate()+"";var e=Math.random()*3;var g=Math.ceil(e);AttachUtil.randomNumber=g+f+h+c+Math.random().toString().split(".")[1].substring(0,3)}$super()},moduleInit:function(d,e,b,c){this._url=d;this._width=e;this._height=b;this._popupname="espresso_popup";if(Object.isNumber(c)){this._limit=c}},initUI:function(){if(this.elements.attachBtn){es.Event.observe(this.elements.attachBtn,"click",this.onClickAttachBtn.bindAsEventListener(this))}},onClickAttachBtn:function(d){var f=es.Event.element(d);es.Event.stop(d);this.sendCommand("syncAttach");var e=this.sendCommand("getDocument");if(this._limit>0&&this._curCount>=this._limit){var c=this.elements.exceedNotify;if(c){var g=es.Dom.getPosition(this.elements.attachBtn);c.style.display="block";var b=es.Dom.getSize(c);es.Dom.setPosition(c,g.left-10,g.top-b.height);setTimeout(this.onTimeout.bind(this),3000)}}else{if(this.beforePopupOpen){this.beforePopupOpen()}AttachUtil.openPopup(this._popupname,this._width,this._height,this._url,this);if(this.afterPopupOpen){this.afterPopupOpen()}}},onTimeout:function(){var b=this.elements.exceedNotify;if(b){b.style.display="none"}},getTotalAttachSize:function(){return AttachUtil.popupCommonStorage.totalAttachSize},initParameter:function(b){AttachUtil.popupCommonStorage[b]={};Object.extend(AttachUtil.popupCommonStorage[b],this.getParameter(b))},addAttach:function(c,b){if(AttachUtil.addAttach(c,b)){AttachUtil.randomNumber++;this._curCount++;return true}return false},onCmdDeleteAttach:function(c){if(Object.isArray(this._attachType)){for(var b=0;b<this._attachType.length;b++){if(c.type==this._attachType[b]){if(c.sync!=true&&this.deleteAttachDelegate){this.deleteAttachDelegate(c.type,c.id)}this._curCount--}}}else{if(c.type==this._attachType){if(c.sync!=true&&this.deleteAttachDelegate){this.deleteAttachDelegate(c.type,c.id)}this._curCount--}}},onCmdIncreaseAttachCnt:function(c){if(Object.isArray(this._attachType)){for(var b=0;b<this._attachType.length;b++){if(c.type==this._attachType[b]){this._curCount++}}}else{if(c.type==this._attachType){this._curCount++}}},onCmdNotifyUndo:function(){if(!this._cntStack){return}this._undoIndex--;if(this._undoIndex<0){this._undoIndex=0}this._curCount=this._cntStack[this._undoIndex]},onCmdNotifyRedo:function(){if(!this._cntStack){return}this._undoIndex++;if(this._undoIndex>=this._cntStack.length){this._undoIndex=this._cntStack.length-1}this._curCount=this._cntStack[this._undoIndex]},onCmdNotifyUndoStackPush:function(b){this._stackLimit=b;if(!this._cntStack){this._cntStack=new Array();this._cntStack[0]=0;this._undoIndex=0}if(this._undoIndex<this._cntStack.length-1){this._cntStack.length=this._undoIndex+1}this._cntStack.push(this._curCount);this._undoIndex++;if(this._cntStack.length>b){this._cntStack.shift();this._undoIndex--}}});es.plugin.AttachPopupBase=a})();if(!util){var util={}}(function(){var a=es.Browser.IE;util.NodeFinder=function(b,c){this.TAG_NAME=b;this.hasTagName=c};util.NodeFinder.prototype={getDirectAncestor:function(b){do{if(this.hasTagName(b)){return b}else{if(this.isBoundary(b)){return null}}}while(b=b.parentNode);return null},getAncestors:function(c){var b=[];do{if(this.hasTagName(c)){b.push(c)}else{if(this.isBoundary(c)){break}}}while(c=c.parentNode);return b},getOverlapped:function(e,d,g){var f=e.getRange();var h=function(m,l){var o,j=d.getElementsByTagName(m);for(var k=0;k<j.length;k++){o=j[k];if(a){var n=f.duplicate();n.moveToElementText(o)}else{var n=g.createRange();n.selectNode(o)}if(e.rangeContact(f,n)){l.push(o)}}return l};var b=[];if(this.TAG_NAME.constructor==Array){for(var c=0;c<this.TAG_NAME.length;c++){b=h(this.TAG_NAME[c],b)}}else{b=h(this.TAG_NAME,b)}return b},getSearched:a?function(b){return this.getDirectAncestor(b)}:function(c,f){var d=c.startContainer;var b=c.endContainer;var g=(d==f?[]:this.getAncestors(d));var e=(b==f?[]:this.getAncestors(b));return this.mergeArr(g,e)},find:a?function(d){var c=d.getParent();if(this.hasTagName(c)){return c}else{var e=this.getDirectAncestor(c);var b=this.getOverlapped(d,c);if(e){b.unshift(e)}if(b.length>0){return b}else{return null}}}:function(j,i){var b=function(l){if(l.constructor==Array){if(l.length>0){return l}else{return null}}else{return l}};var f=j.getRange();var k=j.getParent();if(this.hasTagName(k)){return k}if(k==f.startContainer&&k==f.endContainer){if(DomUtil.equalsNodeName(k,"body")){var e=[],c;for(var g in k.childNodes){c=k.childNodes[g];if(this.hasTagName(c)){e.push(c)}}return b(e)}else{var e=this.getAncestors(k);return b(e)}}var d=this.getSearched(f,k);var h=this.getOverlapped(j,k,i);var e=this.mergeArr(d,h);return b(e)},isBoundary:function(b){if(DomUtil.equalsNodeName(b,"body")||DomUtil.equalsNodeName(b,"html")){return true}else{return false}},mergeArr:function(f,g){var e=function(j,k){k=k||j.length-1;var m=j[k];for(var l=0;l<k;l++){if(j[l]==m){return m}}return null};var b=f.concat(g);var h=f.length;var c=b.length-1;for(var d=c;d>=h;d--){if(e(b,d)!=null){b.splice(d,1)}}return b}}})();if(!util){var util={}}(function(){var a=es.Browser.IE;util.NodeFinder=function(b,c){this.TAG_NAME=b;this.hasTagName=c};util.NodeFinder.prototype={getDirectAncestor:function(b){do{if(this.hasTagName(b)){return b}else{if(this.isBoundary(b)){return null}}}while(b=b.parentNode);return null},getAncestors:function(c){var b=[];do{if(this.hasTagName(c)){b.push(c)}else{if(this.isBoundary(c)){break}}}while(c=c.parentNode);return b},getOverlapped:function(e,d,g){var f=e.getRange();var h=function(m,l){var o,j=d.getElementsByTagName(m);for(var k=0;k<j.length;k++){o=j[k];if(a){var n=f.duplicate();n.moveToElementText(o)}else{var n=g.createRange();n.selectNode(o)}if(e.rangeContact(f,n)){l.push(o)}}return l};var b=[];if(this.TAG_NAME.constructor==Array){for(var c=0;c<this.TAG_NAME.length;c++){b=h(this.TAG_NAME[c],b)}}else{b=h(this.TAG_NAME,b)}return b},getSearched:a?function(b){return this.getDirectAncestor(b)}:function(c,f){var d=c.startContainer;var b=c.endContainer;var g=(d==f?[]:this.getAncestors(d));var e=(b==f?[]:this.getAncestors(b));return this.mergeArr(g,e)},find:a?function(d){var c=d.getParent();if(this.hasTagName(c)){return c}else{var e=this.getDirectAncestor(c);var b=this.getOverlapped(d,c);if(e){b.unshift(e)}if(b.length>0){return b}else{return null}}}:function(j,i){var b=function(l){if(l.constructor==Array){if(l.length>0){return l}else{return null}}else{return l}};var f=j.getRange();var k=j.getParent();if(this.hasTagName(k)){return k}if(k==f.startContainer&&k==f.endContainer){if(DomUtil.equalsNodeName(k,"body")){var e=[],c;for(var g in k.childNodes){c=k.childNodes[g];if(this.hasTagName(c)){e.push(c)}}return b(e)}else{var e=this.getAncestors(k);return b(e)}}var d=this.getSearched(f,k);var h=this.getOverlapped(j,k,i);var e=this.mergeArr(d,h);return b(e)},isBoundary:function(b){if(DomUtil.equalsNodeName(b,"body")||DomUtil.equalsNodeName(b,"html")){return true}else{return false}},mergeArr:function(f,g){var e=function(j,k){k=k||j.length-1;var m=j[k];for(var l=0;l<k;l++){if(j[l]==m){return m}}return null};var b=f.concat(g);var h=f.length;var c=b.length-1;for(var d=c;d>=h;d--){if(e(b,d)!=null){b.splice(d,1)}}return b}}})();(function(){es.plugin.executeQuote={TAG_NAME:"blockquote",isList:function(a){if(DomUtil.equalsNodeName(a,"ol")||DomUtil.equalsNodeName(a,"ul")){return true}else{return false}},keepingTag:function(){if(!this._cachedDiv){this._cachedDiv=this.doc.createElement("div")}return this._cachedDiv},hasList:function(c){var b=this.keepingTag();b.innerHTML=c.htmlText;var d=b.getElementsByTagName("ul");var a=b.getElementsByTagName("ol");var e=b.getElementsByTagName("li");return(d.length>0||a.length>0||e.length>0)},findOverlappedList:function(d){var b=function(g,j){var h=c.getElementsByTagName(g);for(var f=0;f<h.length;f++){e.moveToElementText(h[f]);if(d.isOverlapped(e)){j.push(h[f])}}return j};var a=[];var c=d.getParent();var e=d.getRange().duplicate();a=b("ul",a);a=b("ol",a);return a},isInListItem:function(a){do{if(DomUtil.equalsNodeName(a,"li")){return a}else{if(DomUtil.equalsNodeName(a,"body")||DomUtil.equalsNodeName(a,"html")){return false}}}while(a=a.parentNode);return false},_execCommand:es.Browser.IE?function(h){var e=h.getRange();var j=h.getParent();var f;if(this.hasList(e)){var k=this.findOverlappedList(h);if(k.length>0){for(var c=0;c<k.length;c++){var a=e.duplicate();a.moveToElementText(k[c]);if(!e.inRange(a)){var b=e.compareEndPoints("StartToStart",a);if(b==1){e.setEndPoint("StartToStart",a)}e.select();var g=e.compareEndPoints("EndToEnd",a);if(g==-1){e.setEndPoint("EndToEnd",a)}e.select()}else{continue}}this.sendCommand("execCommand",{cmd:"indent"})}else{if(this.isList(j)){var d=this.doc.createElement("blockquote");j.parentNode.insertBefore(d,j);d.appendChild(j);e.moveToElementText(d);e.select()}else{this.sendCommand("execCommand",{cmd:"indent"})}}}else{if(f=this.isInListItem(j)){var d=this.doc.createElement("blockquote");while(f.firstChild){d.appendChild(f.firstChild)}f.appendChild(d);e.moveToElementText(d);e.select()}else{if(this.findQuote(h)==null){DomUtil.wrap(this.doc,"blockquote","p","tmp_quote");this.sendCommand("execCommand",{cmd:"indent"});DomUtil.strip(this.doc,"tmp_quote")}else{this.sendCommand("execCommand",{cmd:"indent"})}}}}:function(a){this.sendCommand("execCommand",{cmd:"formatblock",data:"blockquote"})}}})();var Validator={filters:{mail:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,url:/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,protocol:/(ftp|http|https):\/\//},checkMail:function(a){return Validator.checkValue("mail",a)},checkURL:function(a){return Validator.checkValue("url",a)},checkProtocol:function(a){return Validator.checkValue("protocol",a)},checkValue:function(a,b){if(Validator.hasValue(b)){return Validator.filters[a].test(b)}return false},hasValue:function(a){var a=a.strip();if(a.length!=0){return true}else{return false}}};var DebugHelper={SAMPLE_TXT:"  .",isRandCalled:function(b){var a=/=rand\((\s*\d+\s*),(\s*\d+\s*)\)/.exec(b);if(a&&a.length&&a.length>=3){return a}return false},getRandText:function(d){var g=parseInt(d[1]);var f=parseInt(d[2]);var b=[];for(var e=0;e<f;e++){b.push(DebugHelper.SAMPLE_TXT)}var h=b.join(" ");var a="";for(var c=0;c<g;c++){if(es.Browser.IE){a+="<p>"+h+"</p>"}else{a+=h+"<br/>"}}return a}};var Util={getCachedDiv:function(){if(typeof(this._cachedDdiv)=="undefined"){this._cachedDdiv=es.$C("div")}return this._cachedDdiv},getRandID:function(){return"tmp_"+(new Date()).getTime()+"_"+Math.floor(Math.random()*(101))},getNearestValue:function(e,d){var a=d[0];if(typeof e=="string"){e=parseInt(e)}var c=Math.abs(e-a);for(var b=1;b<d.length;b++){var f=Math.abs(d[b]-e);if(f<c){c=f;a=d[b]}}return a},parseURL:function(d){var f=new Array();if(d){var e,c;e=d.indexOf("://");if(e!=-1){f.protocol=d.substring(0,e);c=e+3}for(var a=c;a<d.length;a++){var b=d.charAt(a);if(b==":"){break}if(b=="/"){break}}e=a;f.host=d.substring(c,e);f.port="";c=e;if(d.charAt(e)==":"){e=d.indexOf("/",c);f.port=d.substring(c+1,e)}c=e;e=d.indexOf("?",c);if(e==-1){e=d.indexOf("#",c)}if(e==-1){e=d.length}f.path=d.substring(c,e);c=e;if(d.charAt(e)=="?"){e=d.indexOf("#");e=(e==-1)?d.length:e;f.query=d.substring(c+1,e)}c=e;if(d.charAt(e)=="#"){e=d.length;f.anchor=d.substring(c+1,e)}}return f},getCookie:function(c){var d=document.cookie.indexOf(c+"=");var a=d+c.length+1;if((!d)&&(c!=document.cookie.substring(0,c.length))){return null}if(d==-1){return null}var b=document.cookie.indexOf(";",a);if(b==-1){b=document.cookie.length}return unescape(document.cookie.substring(a,b))},setCookie:function(d,f,b,h,e,g){var c=new Date();if(b){b=b*1000*60*60*24}var a=new Date();a.setTime(c.getTime()+(b?b:0));document.cookie=d+"="+escape(f)+((b)?"; expires="+a.toGMTString():"")+((h)?"; path="+h:"")+((e)?"; domain="+e:"")+((g)?"; secure":"")},delCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?"; path="+c:"")+((b)?"; domain="+b:"")+"; expires=Thu, 01 Jan 1970 00:00:01 GMT"}}};(function(){es.component.WysiwygInterface={onCmdDummy:function(){},onCmdExecCommand:function(a){if(typeof(a.data)=="undefined"){this.execute(a.cmd)}else{this.execute(a.cmd,a.data)}},onCmdInsertHTML:function(a){this.insertHTML(a,0)},onCmdInsertContents:function(a){this.insertContents(a)},onCmdInsertNode:function(a){this.insertNode(a.node,a.type)},onCmdGetSelection:function(){return this.getSelection()},onCmdGetDocument:function(){return this.getDocument()},onCmdGetWindow:function(){return this.getWindow()},onCmdGetFrame:function(){return this.getFrame()},onCmdSetFocus:function(){this.focus()},onCmdSetBodyFocus:function(){this.bodyFocus()},onCmdSelectElement:function(a){this.selectElement(a)},onCmdGetWidthOfEditor:function(){return this._width},onCmdGetLeftPositionOfEditor:function(){return this._leftPosition},onCmdSetBlur:es.Browser.IE?function(){this.blur();this.element.blur()}:function(){this.blur()},onCmdCloseDialogs:function(){this.closeDialogs()},onCmdGetRangeContainer:function(){return this._getRangeContainer()},_getRangeContainer:function(){this.selection.update();return this.selection.getRangeContainer()},onCmdGetTagsInRange:function(a){return(a instanceof Array)?this._getTagsInRange(a):this._getTagsInRange(a.tags,a.checkParent)},_getTagsInRange:function(b,a){this.selection.update();return this.selection.getTagsInRange(b)},onCmdSetRangeStyles:function(c){var a;if(c.wrapTag){a=c.wrapTag;delete c.wrapTag}if(c._filter){var b=c._filter;delete c._filter;return this._setRangeStyles(c,false,b,a)}return this._setRangeStyles(c,false,null,a)},onCmdSetRangeLineStyles:function(b){var a;if(b.wrapTag){a=b.wrapTag;delete b.wrapTag}return this._setRangeStyles(b,true,null,a)},_setRangeStyles:function(d,a,c,b){this.selection.update();return this.selection.setRangeStyles(d,a,c,b)},onCmdGetHTML:function(){return WYSIWYGFilter.filter("save",this.getDocument().body.innerHTML)},onCmdSetHTML:function(a){this.getDocument().body.innerHTML=WYSIWYGFilter.filter("load",a)},onCmdGetDefaultFont:function(){return this.getParameter("initial_parameter").default_font},onCmdSetClearContentsOnFocus:function(a){this.initContentsOnFirstFocus=a},onCmdGetContent:function(){var c=this.getDocument();this.sendCommand("checkMoreLessControl",c);var b=c.body.innerHTML;b=DomUtil.replacePofHR(b);var d=this.getParameter("initial_parameter").default_font;var a="";a='style="font-size:9pt;"';b='<!--espresso editor content start--><div id="espresso_editor_view" '+a+">"+b+"\n</div><!--espresso editor content end-->";return b},onCmdSetContent:function(a){var b=this.getDocument();a=DomUtil.removeWrapDIV(a);a=DomUtil.replaceDIVofHR(a);a=DomUtil.removePofHR(a);if(!this.initContentsOnFirstFocus){this.editor.sendCommand("filter.undoStack","setBaseContent",a)}if(!this.waitContentToSet&&a){this.waitContentToSet=a}if(b&&b.body){b.body.innerHTML=this.waitContentToSet;this.sendCommand("convertMoreLessViewToEditor");this.waitContentToSet=null;this.initModification();if(this.listOfCallback&&this.listOfCallback.setContentEnded){this.listOfCallback.setContentEnded()}}else{setTimeout(this.onCmdSetContent.bind(this),500)}},onCmdSetTempContent:function(a){this.initContentsOnFirstFocus=true;this.initialContents=a;this.onCmdSetContent(a)},onCmdGetTempContent:function(){return this.initialContents},onCmdClearContents:function(){if(!this.contentsFirstCleared){this._clearContents()}},onCmdGetContentsInitialized:function(){return((this.initContentsOnFirstFocus&&this.contentsFirstCleared)||(!this.initContentsOnFirstFocus))},onCmdIsModified:function(){return this.isModified()},onCmdClearModification:function(){return this.initModification()},onCmdSetModified:function(){this.setModified()},onCmdAddCallback:function(a){if(!this.listOfCallback){this.listOfCallback={}}this.listOfCallback[a.type]=a.callback},onCmdRemoveCallback:function(a){if(this.listOfCallback){delete (this.listOfCallback[a])}},onCmdSave:function(a){es.Event.stop(a);if(this.listOfCallback&&this.listOfCallback.save){var b=this.listOfCallback.save;setTimeout(b,100)}return false},onCmdResize:function(){}}})();(function(){es.component.WysiwygIntializer={write:function(h,g,l){var e=h.header_scripts;var d=h.footer_scripts;var j=h.links;var k=h.styles;var b='   <script type="text/javascript" src="';var c='   <link rel="stylesheet" type="text/css" href="';g.open();g.writeln("<html>");g.writeln("<head>");this.writeExternalFiles(g,j,c);this.writeExternalFiles(g,e,b);if(k.length>0){g.writeln("<style>");g.writeln("<!--");var a;for(var f=0;f<k.length;f++){a=k[f];g.writeln(a)}g.writeln("body {word-break:break-all;text-align:justify;}");g.writeln("-->");g.writeln("</style>")}g.writeln("</head>");g.writeln("<body>");this.writeExternalFiles(g,d,b);if(h.contents&&h.contents.length>0){g.writeln(h.contents)}else{g.writeln(l)}g.writeln("</body>");g.writeln("</html>");g.close()},writeExternalFiles:function(d,a,c){var e;for(var b=0;b<a.length;b++){e=a[b];d.writeln(c+e+'" />')}}}})();(function(){es.component.WysiwygResizer={initialize:function(a,b){this.editor=a;minSize=b.getAttribute("minSize");this.curYpos=null;this.isResizing=false;this.resizeBarHandler=this.handleResizeBar.bindAsEventListener(this);es.Event.observe(b,"mousedown",this.resizeBarHandler);es.Event.observe(b,"mouseover",function(){b.style.backgroundPosition="0px -14px";b.style.cursor="n-resize"});es.Event.observe(b,"mouseout",function(){b.style.backgroundPosition="0px 0px";b.style.cursor="pointer"})},handleResizeBar:function(c){var b=this.editor.element;var d=parent.document.getElementById("mainFrame");switch(c.type){case"mousedown":this.startResize(c);break;case"mousemove":if(es.Browser.IE&&(c.button!=1)){this.endResize(c)}if(this.curYpos!=null){var a=c.screenY-this.curYpos;if(b.offsetHeight+a>=minSize){b.style.height=(b.offsetHeight+a)+"px";if(d){d.style.height=(d.offsetHeight+a)+"px"}this.curYpos=c.screenY}}break;case"mouseup":this.endResize(c);break}},startResize:function(a){if(this.isResizing==false){this.curYpos=a.screenY;var b=this.editor.getDocument();es.Event.observe(document,"mousemove",this.resizeBarHandler);es.Event.observe(b,"mousemove",this.resizeBarHandler);es.Event.observe(document,"mouseup",this.resizeBarHandler);es.Event.observe(b,"mouseup",this.resizeBarHandler);this.isResizing=true}},endResize:function(a){if(this.isResizing==true){this.curYpos=null;var b=this.editor.getDocument();es.Event.stopObserving(document,"mousemove",this.resizeBarHandler);es.Event.stopObserving(b,"mousemove",this.resizeBarHandler);es.Event.stopObserving(document,"mouseup",this.resizeBarHandler);es.Event.stopObserving(b,"mouseup",this.resizeBarHandler);this.isResizing=false}}}})();var WYSIWYGFilter={filters:{},filter:function(c,b){var d=this.filters[c];for(var a=0;a<d.length;a++){b=d[a](b)}return b},removeGarbage:function(a){if(a.length<=15){switch(a.toLowerCase()){case"<p>&nbsp;</p>":case"<div></div>":case"<br>":case"<br/>":case"<br />":return""}}return a}};if(es.Browser.IE){WYSIWYGFilter.spanToFont=function(b){var f=function(m){var l=function(r){return r.replace(/^\s+/,"").replace(/\s+$/,"")};var o=/([^: ]*):([^:;]*);?/gi,k,q,n,p;var i={color:null,"background-color":null,bold:false,italic:false,underline:false,strike:false};while((k=o.exec(m.style.cssText))!=null){n=k[1].toLowerCase().strip();p=l(k[2]).toLowerCase();switch(n){case"color":case"background-color":i[n]=p;break;case"font-weight":i.bold=(p=="bold");break;case"font-style":i.italic=(p=="italic");break;case"text-decoration":es.$A(p.split(" ")).each(function(r){if(r=="underline"){i.underline=(r=="underline")}else{if(r=="line-through"){i.strike=(r=="line-through")}}});break;default:break}}if(i.color==null&&i["background-color"]==null&&i.bold==false&&i.italic==false&&i.underline==false&&i.strike==false){return null}else{return i}};var e=function(p,l){var q,i,n,m,o;l=es.$H(l);if(l.get("color")!=null||l.get("background-color")!=null){var k=es.$C("font");if(l.get("color")){k.color=l.get("color")}if(l.get("background-color")){k.style.backgroundColor=l.get("background-color")}k.innerHTML=p.innerHTML;q=k}else{q=p.innerHTML}l.unset("color");l.unset("background-color");l.each(function(r){m=r[0],o=r[1],i=null;if(o){switch(m){case"bold":n="strong";break;case"italic":n="em";break;case"underline":n="u";break;case"strike":n="strike";break;default:break}i=es.$C(n);i.innerHTML=(typeof(q)=="string"?q:q.outerHTML);q=i}});return q};var c=Util.getCachedDiv();c.innerHTML=b;var g=c.getElementsByTagName("span");var a,j,h=g.length;for(var d=h-1;d>=0;d--){a=g[d];j=f(a);if(j!=null){a.replaceNode(e(a,j))}}return c.innerHTML}}else{WYSIWYGFilter._hasOnlySpanChild=function(a){if(a.childNodes.length==1){var b=a.childNodes[0];if(b.nodeType=="1"&&b.nodeName.toLowerCase()=="span"){return true}}return false};WYSIWYGFilter._hasOnlySpanParent=function(a){var b=a.parentNode;if(b.childNodes.length==1&&b.nodeType=="1"&&b.nodeName.toLowerCase()=="span"){return true}return false};WYSIWYGFilter._styleToSpan=function(b,d,k){var f=Util.getCachedDiv();f.innerHTML=b;var e=f.getElementsByTagName(d);var a,j,h=e.length;for(var g=h-1;g>=0;g--){a=e[g];if(this._hasOnlySpanChild(a)){k(a.childNodes[0]);var c=a.removeChild(a.childNodes[0]);a.parentNode.replaceChild(c,a)}else{if(this._hasOnlySpanParent(a)){k(a.parentNode);a.parentNode.innerHTML=a.innerHTML}else{tag=es.$C("span");k(tag);tag.innerHTML=a.innerHTML;a.parentNode.replaceChild(tag,a)}}}return f.innerHTML};WYSIWYGFilter.emToSpan=function(a){return WYSIWYGFilter._styleToSpan(a,"em",function(b){b.style.fontStyle="italic"})};WYSIWYGFilter.uToSpan=function(a){return WYSIWYGFilter._styleToSpan(a,"u",function(b){if(b.style.textDecoration!=""){b.style.textDecoration+=" underline"}else{b.style.textDecoration="underline"}})};WYSIWYGFilter.strikeToSpan=function(a){return WYSIWYGFilter._styleToSpan(a,"strike",function(b){if(b.style.textDecoration!=""){b.style.textDecoration+=" line-through"}else{b.style.textDecoration="line-through"}})};WYSIWYGFilter.strongToSpan=function(a){return WYSIWYGFilter._styleToSpan(a,"strong",function(b){b.style.fontWeight="bold"})};WYSIWYGFilter.fontToSpan=function(b){b=WYSIWYGFilter.emToSpan(b);b=WYSIWYGFilter.uToSpan(b);b=WYSIWYGFilter.strikeToSpan(b);b=WYSIWYGFilter.strongToSpan(b);var h=function(n){var m={color:null,"background-color":null};var o=n.attributes,l;for(var p=0;p<o.length;p++){l=o[p];switch(l.name){case"color":m.color=l.value;break;case"style":if(n.style.color!=""){m.color=n.style.color}if(n.style.backgroundColor!=""){m["background-color"]=n.style.backgroundColor}break;default:break}}if(m.color==null&&m["background-color"]==null){return null}else{return m}};var k=function(i,l){if(l.color!=null){i.style.color=l.color}if(l["background-color"]!=null){i.style.backgroundColor=l["background-color"]}return i};var d=Util.getCachedDiv();d.innerHTML=b;var f=d.getElementsByTagName("font");var a,j,g=f.length;for(var e=g-1;e>=0;e--){a=f[e];j=h(a);if(j!=null){if(this._hasOnlySpanChild(a)){k(a.childNodes[0],j);var c=a.removeChild(a.childNodes[0]);a.parentNode.replaceChild(c,a)}else{if(this._hasOnlySpanParent(a)){k(a.parentNode,j);a.parentNode.innerHTML=a.innerHTML}else{tag=es.$C("span");k(tag,j);tag.innerHTML=a.innerHTML;a.parentNode.replaceChild(tag,a)}}}}return d.innerHTML}}(function(){var c={RANGE_SURROUND:0,RANGE_START:1,RANGE_END:2,updateAndSave:function(){this.update();this.save()},restoreAndReplace:function(e){this.restore();this.replaceContents(e)},getSelectedNodes:function(g){var e;if(g){var f=this.getParent();if(f.tagName==g&&f.getElementsByTagName(g).length==0){e=[f]}else{e=this.getParent().getElementsByTagName(g)}}else{e=this.getParent().childNodes}if(e.length==1&&e[0].nodeType!=1){return[this.getParent()]}else{return e}},getSelectionNodes2:function(l){var f=[];var e=this.getRange();if(e){var j=this.getParent();if(j){while(j.nodeType!=1){j=j.parentNode}if(es.Browser.IE&&j.tagName==l){f[0]=j}var h=j.getElementsByTagName(l);for(var g=0,k;g<h.length;g++){k=this.createRangeFromElement(h[g]);if(k&&this.rangeContact(e,k)){f[f.length]=h[g]}}}}return f}};var d=function(e){this.comp=e;this._win=this.comp.getWindow();this._doc=this.comp.getDocument();this.update();this._saved=null};d.prototype.update=function(){this._sel=this.getSelection();this._rng=this.getRange()};d.prototype.getSelection=function(){return this._win.getSelection()};d.prototype.createRangeFromElement=function(f){var e=null;e=this._doc.createRange();e.selectNodeContents(f);return e};d.prototype.rangeContact=function(f,e){return !(e.compareBoundaryPoints(0,f)==1&&e.compareBoundaryPoints(1,f)==1&&e.compareBoundaryPoints(2,f)==1&&e.compareBoundaryPoints(3,f)==1||e.compareBoundaryPoints(0,f)==-1&&e.compareBoundaryPoints(1,f)==-1&&e.compareBoundaryPoints(2,f)==-1&&e.compareBoundaryPoints(3,f)==-1)};d.prototype.getRange=function(){if(this._sel.rangeCount>0){return this._sel.getRangeAt(0)}else{var e=this._doc.createRange();var f=this._doc.getElementsByTagName("body")[0];e.setStart(f,0);e.setEnd(f,0);this._sel.addRange(e);return e}};d.prototype.save=function(){this._saved={startNode:this._rng.startContainer,startOffset:this._rng.startOffset,endNode:this._rng.endContainer,endOffset:this._rng.endOffset}};d.prototype.restore=function(){if(this._saved!=null){var f=this.getSelection();f.removeAllRanges();var e=this._doc.createRange();e.setStart(this._saved.startNode,this._saved.startOffset);e.setEnd(this._saved.endNode,this._saved.endOffset);f.addRange(e);this._saved=null}};d.prototype.appendContents=function(e){if(e.length&&e.item){var f=[];while(e.length>0){f.push(e.item(0));this._insertAndMove(e.item(0))}return f}else{this._insertAndMove(e);return e}};d.prototype._insertAndMove=function(e){if(this._rng.startContainer.tagName&&this._rng.startContainer.tagName.toLowerCase()=="html"){this._rng.selectNodeContents(this._doc.body)}this._rng.insertNode(e);this._rng.selectNode(e);this._rng.collapse(false)};d.prototype.deleteContents=function(){this._rng.deleteContents()};d.prototype.replaceContents=function(e){this.deleteContents();return this.appendContents(e)};d.prototype.pasteContents=function(e){};d.prototype.setRange=function(g,i){try{var j=this.getSelection();j.removeAllRanges();this._rng=this._doc.createRange();if(g.nodeType){switch(g.nodeType){case 3:this._rng.selectNode(g);break;default:this._rng.selectNodeContents(g);break}}else{var h=g[0];var f=g[g.length-1];this._rng.setStart(h,0);this._rng.setEnd(f,f.textContent.length)}switch(i){case this.RANGE_START:this._rng.collapse(true);break;case this.RANGE_END:this._rng.collapse(false);break}j.addRange(this._rng)}catch(k){}};d.prototype.setSelection=function(f,i,j,l){try{var h=(f==i&&j==l);var g=this._ElementTotextNode(f,j);f=g.node;j=g.offset;if(h){i=f;l=j}else{var m=this._ElementTotextNode(i,l);i=m.node;l=m.offset}var e=this.getSelection();e.removeAllRanges();this._rng=this._doc.createRange();this._rng.setStart(f,j);this._rng.setEnd(i,l);e.addRange(this._rng);this.save()}catch(k){}};d.prototype.getParent=function(){this._rng=this.getRange();return this._rng.commonAncestorContainer};d.prototype._textNodeToElement=function(g,h){if(g.nodeType==3){var e=g.parentNode;for(var f=g.previousSibling;f;f=f.previousSibling){if(f.nodeType==3){h+=f.nodeValue.length}else{if(f.firstChild&&f.innerText){h+=f.innerText.length}else{h++}}}}else{var e=g}return{element:e,offset:h}};d.prototype._ElementTotextNode=function(h,k){var e=0;var j=h;if(h.nodeType!=3){var g=h;for(var f=0;f<h.childNodes.length;f++){g=h.childNodes[f];e+=(g.length?g.length:1);if(e>=k){break}}j=g;k=k-e+j.length}return{node:j,offset:k}};d.prototype.getBookmark=function(i){var h=this.getRangeContainer();var f=this.setBookmarkId(h.startContainer,h.startOffset,"startContainer");var e=f.element;var j=f.offset;var m=e;var k=j;if(!this.isCollapsed()){var l=this.setBookmarkId(h.endContainer,h.endOffset,"endContainer");m=l.element;k=l.offset}var g=this._doc.body.innerHTML;var i={startOffset:j,endOffset:k};e.removeAttribute("id");m.removeAttribute("id");if(this._wrapText){this.setSelection(e,m,j,k);this.wrapText=false}return{bookmark:i,html:g}};d.prototype.setBookmarkId=function(e,g,h){var f={element:e,offset:g};if(e.nodeType==3){if(DomUtil.equalsNodeName(e.parentNode,"body")){DomUtil.wrapTextNode("span",e,this._doc);this._wrapText=true}f=this._textNodeToElement(e,g)}e=f.element;if(!e.getAttribute("id")){e.setAttribute("id",h)}return f};d.prototype.moveToBookmark=function(f){try{var g=this._doc.getElementById("startContainer");var h=this._doc.getElementById("endContainer");if(!f||!g){return}if(!h){h=g}this.setSelection(g,h,f.startOffset,f.endOffset);g.removeAttribute("id");h.removeAttribute("id")}catch(e){}};d.prototype.isCollapsed=function(){return this.getSelection().isCollapsed};d.prototype.equalsRange=function(g,f){if(!g||!f){return false}try{return(g.compareBoundaryPoints(Range.START_TO_START,f)==0)&&(g.compareBoundaryPoints(Range.END_TO_END,f)==0)}catch(h){return false}};d.prototype.selectElement=function(f){var e=this.getRange();e.selectNode(f)};d.prototype.insertContents=function(g){var e=this.getRange();g=e.createContextualFragment(g);e.deleteContents();if(e.startContainer.nodeType==3){var f=e.startContainer.splitText(e.startOffset);f.parentNode.insertBefore(g,f)}else{e.insertNode(g)}e.collapse(false)};var b=function(e){this.comp=e;this._win=this.comp.getWindow();this._doc=this.comp.getDocument();this.update();this._saved=null};b.prototype.update=function(){this._doc.focus();this._sel=this.getSelection();var e=this.getRange();if(e.parentElement){if(e.parentElement().document==this._doc){this._rng=e}else{if(this._saved&&this._saved.parentElement().document==this._doc){this._rng=this._saved}}}else{this._rng=e}};b.prototype.getSelection=function(){return this._doc.selection};b.prototype.createRangeFromElement=function(f){var e=null;e=this._doc.body.createTextRange();e.moveToElementText(f);return e};b.prototype.rangeContact=function(f,e){return !(e.compareEndPoints("StartToStart",f)==1&&e.compareEndPoints("StartToEnd",f)==1&&e.compareEndPoints("EndToEnd",f)==1&&e.compareEndPoints("EndToStart",f)==1||e.compareEndPoints("StartToStart",f)==-1&&e.compareEndPoints("StartToEnd",f)==-1&&e.compareEndPoints("EndToEnd",f)==-1&&e.compareEndPoints("EndToStart",f)==-1)};b.prototype.getRange=function(){this._rng=this.getSelection().createRange();return this._rng};b.prototype.save=function(){try{var f=this.getSelection();this._rng=f.createRange();if(f.type=="Control"){this._saved=f.createRange()}else{this._saved=this._rng.duplicate()}}catch(g){this._saved=null}};b.prototype.restore=function(){if(this._saved!=null){this.comp._isRecovering=true;this._saved.select();this._rng=this.getRange();setTimeout(function(){this.comp._isRecovering=false;this._saved=null}.bind(this),100)}};b.prototype.appendContents=function(h){try{if(h.length&&h.item){var g=this._addID(h[0]);var f=this._addID(h[h.length-1]);var j=h[0].parentNode;this._rng.pasteHTML(j.innerHTML);return[this._getPastedNode(g,j),this._getPastedNode(f,j)]}else{if(h.nodeType&&h.nodeType==1){h=this._addID(h);this._rng.pasteHTML(h.outerHTML);h=this._doc.getElementById(h.id);return this._removeTmpID(h)}else{this._rng.pasteHTML(h.nodeValue)}}}catch(i){}};b.prototype._getPastedNode=function(e,f){if(e!=null){e=this._doc.getElementById(e.id);return this._removeTmpID(e)}else{return f.innerText.length}};b.prototype._addID=function(f){if(f.nodeType&&f.nodeType==1){if(f.id==""){var e=Math.floor(Math.random()*(101));f.id="tmp_"+(new Date()).getTime()+"_"+e}return f}else{return null}};b.prototype._removeTmpID=function(e){if(e.id.indexOf("tmp_")==0){e.id=""}return e};b.prototype.deleteContents=function(){try{this._rng.pasteHTML("")}catch(f){}};b.prototype.replaceContents=function(e){this.deleteContents();return this.appendContents(e)};b.prototype.pasteContents=function(f){if(this._rng.pasteHTML){try{this._rng.pasteHTML(f);this._rng.collapse(false)}catch(g){}}};b.prototype.setRange=function(g,h){try{if(g.nodeType&&g.nodeType==1){this._rng.moveToElementText(g)}else{if(this._isNumber(g)){this._rng.moveStart("character",(-g))}else{if(g.nodeType&&g.nodeType==3){if(h==this.RANGE_START){this._rng.moveStart("character",g.length)}else{if(h==this.RANGE_END){this._rng.moveEnd("character",-g.length)}}return}else{if(g.length){var k=g[0];var f=g[1];if(this._isElement(k)&&this._isElement(f)){var i=this._doc.body.createTextRange();i.moveToElementText(f);this._rng.moveToElementText(k);this._rng.setEndPoint("EndToEnd",i)}else{if(this._isNumber(k)&&this._isElement(f)){this._rng.moveToElementText(f);this._rng.moveStart("character",(-k+f.innerText.length))}else{if(this._isElement(k)&&this._isNumber(f)){this._rng.moveToElementText(k);this._rng.moveStart("character",(f-k.innerText.length))}else{return}}}}else{return}}}}switch(h){case this.RANGE_START:this._rng.collapse(true);this._rng.select();break;case this.RANGE_END:this._rng.collapse(false);this._rng.select();break;default:this._rng.select();break}}catch(j){}};b.prototype._textNodeToElementSub=function(i,h){var g,e=0,f=false;if(i==h){return 0}switch(i.nodeType){case 3:e+=i.nodeValue.length+1;break;case 1:default:if(i.firstChild){for(var j=i.firstChild;j&&j!=h;j=j.nextSibling){e+=this._textNodeToElementSub(j,h)}}break}return e};b.prototype._textNodeToElement=function(f,g){if(f.nodeType==3){var e=f.parentNode;g+=this._textNodeToElementSub(e.firstChild,f)}else{var e=f}return{element:e,offset:g}};b.prototype.setSelection=function(j,f,e,i){try{var k=this._textNodeToElement(j,e);var g=this._textNodeToElement(f,i);var l=this._doc.body.createTextRange();l.moveToElementText(g.element);this._rng.moveToElementText(k.element);this._rng.setEndPoint("EndToStart",l);this._rng.moveStart("character",k.offset);this._rng.moveEnd("character",g.offset);this._rng.select();this.save()}catch(h){}};b.prototype._isElement=function(e){if(e!=null&&e.nodeType&&e.nodeType==1){return true}return false};b.prototype._isNumber=function(e){return typeof(e)=="number"};b.prototype.getParent=function(){if(this._rng&&this._rng.parentElement){this._rng=this.getRange();return this._rng.parentElement()}return null};b.prototype.getBookmark=function(f){var f;var e=this.getRange();if(this.getSelection().type.toUpperCase()=="CONTROL"){f=e.length?e.toArray():null}else{f=e.getBookmark()}return{bookmark:f,html:this._doc.body.innerHTML}};b.prototype.moveToBookmark=function(f){if(!f){return}var e;if(Object.isArray(f)){e=this._doc.body.createControlRange();f.each(e.addElement)}else{e=this.getRange();e.moveToBookmark(f)}e.select()};b.prototype.equalsRange=function(g,f){if(!g||!f){return false}try{return(g.compareEndPoints("StartToStart",f)==0)&&(g.compareEndPoints("EndToEnd",f)==0)}catch(h){return false}};b.prototype.selectElement=function(f){var e=this._doc.body.createControlRange();e.addElement(f);e.select()};b.prototype.insertContents=function(e){this.pasteContents(e)};var a;if(es.Browser.IE){Object.extend(b.prototype,c);a=b}else{Object.extend(d.prototype,c);a=d}Object.extend(a.prototype,{_offsetConversion:function(g,h,f){var e=(this._isSpaceTag(g)?1:(typeof g.length!="undefined"?g.length:0));return Math.max(0,h-f+e)},_elementToNode:function(h,j){var f=0;var e=null;var i=DomUtil.getFirstTerminalNode(h);for(;i;){if(i.nodeType==3){f+=i.length}else{if(this._isBlockTag(i)||this._isSpaceTag(i)){f++}}if(f>=j){return{offset:this._offsetConversion(i,j,f),node:i}}var g=null;e=i;if(i.nextSibling||!i.parentNode){if(this._isBlockTag(i)){f++}g=i.nextSibling}else{for(;i.parentNode&&i.parentNode.tagName.toUpperCase()!="BODY"&&!i.nextSibling;){i=i.parentNode;if(this._isBlockTag(i)){f++}}g=i.nextSibling}if(f>=j){return{offset:this._offsetConversion(e,j,f),node:e}}if(g){for(;g&&g.firstChild;){for(g=g.firstChild;g&&(!g.nodeType||(g.nodeType!=1&&g.nodeType!=3));g=g.nextSibling){}}}i=g}if(!i){i=e}return{offset:this._offsetConversion(i,j,f),node:i}},_getStartEndContainer_IE:function(g){var k=0;var l=0;var h=g.duplicate();var e=g.duplicate();var j=g.duplicate();h.collapse(true);e.collapse(false);var f=h.parentElement();var m=e.parentElement();j.moveToElementText(f);j.collapse(true);var i;do{i=h.compareEndPoints("StartToEnd",j);if(i==0){break}if(i<0){k--;break}k++;j.move("character",1)}while(true);j.moveToElementText(m);j.collapse(true);do{i=e.compareEndPoints("EndToEnd",j);if(i==0){break}if(i<0){l--;break}l++;j.move("character",1)}while(true);return{startContainer:f,endContainer:m,startOffset:k,endOffset:l}},_getRangeStartContainer_Gecko:function(g){var e=g.startContainer;var m=g.startOffset;if(e.nodeType!=3){var k=e.firstChild;for(var j=0;k&&j<m;k=k.nextSibling,j++){}if(!k){k=e.firstChild}k=DomUtil.getFirstTerminalNode(k);var l=g.cloneRange();l.selectNode(k);for(var j=0;g.compareBoundaryPoints(Range.START_TO_START,l)>0;j++){try{l.setStart(k,j)}catch(h){var f=k;k=DomUtil.getNextTerminalNode(k);if(!k){k=f;break}l.selectNode(k);j=0}}e=k;m=j}return{node:e,offset:m}},_getRangeEndContainer_Gecko:function(g){var e=g.endContainer;var m=g.endOffset;if(e.nodeType!=3){var k=e.firstChild;if(k){for(var j=0;k&&j<m;k=k.nextSibling,j++){}if(!k){k=e.lastChild}k=DomUtil.getLastTerminalNode(k);var l=g.cloneRange();l.selectNode(k);for(var j=0;k&&g.compareBoundaryPoints(Range.START_TO_END,l)>0;j++){try{l.setStart(k,j)}catch(h){var f=k;k=DomUtil.getNextTerminalNode(k);if(!k){k=f;break}l.selectNode(k);j=0}}e=k;m=j}}return{node:e,offset:m}},getRangeContainer:function(){var g=this.getRange();if(es.Browser.IE){var i=this._getStartEndContainer_IE(g);var e=i.startContainer;var m=i.endContainer;var j=i.startOffset;var k=i.endOffset}else{var f=this._getRangeStartContainer_Gecko(g);var e=f.node;var j=f.offset;f=this._getRangeEndContainer_Gecko(g);var m=f.node;var k=f.offset}var l=this._elementToNode(e,j);e=l.node;j=l.offset;if((e.nodeType==3&&j==e.length)||(e.nodeType==1&&j==1)){var f=DomUtil.getNextTerminalNode(e);if(f){e=f;j=0}}var h=this._elementToNode(m,k);m=h.node;k=(m.nodeValue&&h.offset>m.nodeValue.length)?m.nodeValue.length:h.offset;if(k==0){var f=DomUtil.getPrevTerminalNode(m);if(f){m=f;k=(f.nodeType==3)?f.length:1}}return{range:g,commonAncestor:this.getParent(),startContainer:e,endContainer:m,startOffset:j,endOffset:k}},getTagsInRange:function(o,g){var m=[];var l=this.getRange();var f=[];for(var k=0;k<o.length;k++){f=this.getParent().getElementsByTagName(o[k]);for(var h=0;h<f.length;h++){var n=this.createRangeFromElement(f[h]);if(this.rangeContact(n,l)){m.push(f[h])}}if(g==true){for(var e=this.getParent();e;e=e.parentElement){if(e.tagName.toUpperCase()==o[k].toUpperCase()){m.push(e)}}}}return m},insertTag:"SPAN",inlineTags:["EM","STRONG","CITE","ABBR","ACRONYM","SUB,SUP","A","PRE","TT","I","B","BIG","SMALL","STRIKE","S","U","FONT","BDO","CENTER","Q","SPAN"],blockTags:["P","BLOCKQUOTE","DD","H1","H2","H3","H4","H5","H6","LI","PRE"],spaceTags:["IMG","BR"],inlineMode:true,_isInlineTag:function(e){return(e.nodeType==1&&this.inlineTags.indexOf(e.tagName.toUpperCase())>=0)},_isBlockTag:function(e){return(e.nodeType==1&&e.tagName&&this.blockTags.indexOf(e.tagName.toUpperCase())>=0)},_isSpaceTag:function(e){return(e.nodeType==1&&e.tagName&&this.spaceTags.indexOf(e.tagName.toUpperCase())>=0)},_isEqualStyleValue:function(e,h){var g=e.split(" ").sort();var j=h.split(" ").sort();if(g.length==j.length){for(var f=0;f<g.length;f++){if(g[f]!=j[f]){return false}}return true}return false},_getParentStyles:function(i,e){var k={};var j={};e=(e==true)?1:0;var h=(e==1)?i:i.parentNode;for(;h;h=h.parentNode){if((this._isInlineTag(h)?1:0)^e==1){var g=DomUtil.getElementStyleObject(h);for(var f in g){if(Object.isUndefined(k[f])){k[f]=g[f];j[f]=h}}}else{break}}return{styles:k,nodes:j}},_compareStyle:function(i,g){var e=Object.extend({},g);var l={};var k={};var j=0;for(var h in i.styles){if(!Object.isUndefined(e[h])){if(this._isEqualStyleValue(i.styles[h],e[h])){delete e[h]}else{l[h]=e[h];k[h]=i.nodes[h];j++;delete e[h]}}}var f=0;for(var h in e){f++}return{nodeStyle:e,styleCount:f,intersection:l,intersectionNodes:k,intersectCount:j}},_getLineStartNode:function(f){for(var e=f;e;e=e.previousSibling){var g=e.previousSibling;if(!g){if(this._isInlineTag(e.parentNode)){return this._getLineStartNode(e.parentNode)}else{return DomUtil.getFirstTerminalNode(e)}}if(g.nodeType==1&&(g.tagName.toUpperCase()=="BR"||!this._isInlineTag(g))){return DomUtil.getFirstTerminalNode(e)}}return f},_getLineEndNode:function(f){for(var e=f;e;e=e.nextSibling){var g=e.nextSibling;if(!g){if(this._isInlineTag(e.parentNode)){return this._getLineEndNode(e.parentNode)}else{return DomUtil.getLastTerminalNode(e)}}if(g.nodeType==1&&(g.tagName.toUpperCase()=="BR"||!this._isInlineTag(g))){return DomUtil.getLastTerminalNode(e)}}return f},_getSplitStartTarget_IE:function(e,g){var i=e.duplicate();var h=null;for(var f=g.parentNode;f&&f.tagName.toUpperCase()!="BODY";f=f.parentNode){if(this._isInlineTag(f)){i.moveToElementText(f);if(e.compareEndPoints("StartToStart",i)==1){h=f}}else{break}}return h},_getSplitEndTarget_IE:function(e,g){var i=e.duplicate();var h=null;for(var f=g.parentNode;f&&f.tagName.toUpperCase()!="BODY";f=f.parentNode){if(this._isInlineTag(f)){i.moveToElementText(f);if(e.compareEndPoints("EndToEnd",i)==-1){h=f}}else{break}}return h},_getSplitStartTarget_Gecko:function(e,g){var i=e.cloneRange();var h=null;for(var f=g.parentNode;f&&f.tagName&&f.tagName.toUpperCase()!="BODY";f=f.parentNode){if(this._isInlineTag(f)){i.selectNode(f);if(e.compareBoundaryPoints(Range.START_TO_START,i)==1){h=f}}else{break}}return h},_getSplitEndTarget_Gecko:function(e,g){var i=e.cloneRange();var h=null;for(var f=g.parentNode;f&&f.tagName&&f.tagName.toUpperCase()!="BODY";f=f.parentNode){if(this._isInlineTag(f)){i.selectNode(f);if(e.compareBoundaryPoints(Range.END_TO_END,i)==-1){h=f}}else{break}}return h},_applyStyle:function(j,i,k,g){if(!g){g=this.insertTag}if(k.intersectCount>0){for(var e in k.intersection){k.intersectionNodes[e].style[e.camelize()]=k.intersection[e]}}if(k.styleCount>0){var f=[];for(var h=i.parentNode;h&&!DomUtil.equalsNodeName(h,"BODY");h=h.parentNode){if(DomUtil.equalsNodeName(h,g)){f.unshift(h)}else{if(!this._isInlineTag(h)){break}}}if(f.length>0){DomUtil.setElementStyle(f[0],k.nodeStyle)}else{DomUtil.wrapTextNode(g,i,k.nodeStyle,j)}}},setRangeStyles:function(m,l,o,r){var w={};for(var B in m){w[B.toLowerCase()]=m[B]}m=w;var A=this._doc;if(es.Browser.IE&&this._saved){this.restore()}else{this.update()}var n=this._rng?this._rng:this.getRange();var e=(n.text==""||(es.Browser.IE&&!n.parentElement))||n.collapsed;if(e){return}try{var g=this.getRangeContainer();if(l==true){g.startContainer=this._getLineStartNode(g.startContainer);g.startOffset=0;g.endContainer=this._getLineEndNode(g.endContainer);g.endOffset=g.endContainer.nodeType==3?g.endContainer.length:g.endOffset}var k=false;if(es.Browser.IE){var q=this._getSplitStartTarget_IE(g.range,g.startContainer);var x=this._getSplitEndTarget_IE(g.range,g.endContainer)}else{var q=this._getSplitStartTarget_Gecko(g.range,g.startContainer);var x=this._getSplitEndTarget_Gecko(g.range,g.endContainer)}var z=g.startContainer;var p=g.endContainer;var v=g.startOffset;var j=g.endOffset;var i=false,h=false;if((z.nodeType!=3&&v==1)||(z.nodeType==3&&v==z.length)){z=DomUtil.getNextTerminalNode(z);v=0}if(q){var y=DomUtil.splitElement(q,z,v,A);z=DomUtil.getFirstTerminalNode(y.right);i=true}else{if(z.nodeType==3&&v>0&&v<z.length){z=DomUtil.splitText(z,g.startOffset,A).right;i=true}}if(i){if(g.startContainer==g.endContainer){p=z;j-=v}v=0}if(x){var y=DomUtil.splitElement(x,p,j,A);p=DomUtil.getLastTerminalNode(y.left)}else{if(p.nodeType==3&&j>0&&j<p.length){p=DomUtil.splitText(p,j,A).left}}for(var t=z;!k&&t;t=DomUtil.getNextTerminalNode(t)){if(t.nodeType==3&&t.parentNode.tagName.toUpperCase()=="BODY"&&t.nodeValue.replace(/\n/gm,"").length==0){continue}k=(t==p);if(k&&j<=0){continue}if(t.nodeType==3){var f=this._compareStyle(this._getParentStyles(t),m);if(f.styleCount==0&&f.intersectCount==0){continue}if(o){f=o.call(this,t,f)}this._applyStyle(A,t,f,r);k=(t==p)}}this.setSelection(z,p,v,j)}catch(u){}},getBookmark:function(k){var h=this.getRange();var u=this._doc;var l,g,v,p,j,o,n,m;var t,r,q,f=-999999999;if(es.Browser.Opera){return null}r=u.body.scrollLeft+u.documentElement.scrollLeft;q=u.body.scrollTop+u.documentElement.scrollTop;if(es.Browser.WebKit||es.Browser.Gecko){return{rng:h,scrollX:r,scrollY:q}}if(es.Browser.IE){if(k){return{rng:h}}if(h.item){p=h.item(0);j=u.getElementsByTagName(p.nodeName);for(o=0;o<j.length;o++){if(p==j[o]){l=o;break}}return{tag:p.nodeName,index:l,scrollX:r,scrollY:q}}else{t=h.duplicate();t.collapse(true);l=Math.abs(t.move("character",f));t=h.duplicate();t.collapse(false);g=Math.abs(t.move("character",f))-l;return{start:l,length:g,scrollX:r,scrollY:q}}}if(es.Browser.Gecko){v=DomUtil.getParentElement(h.startContainer);for(n=0;n<v.childNodes.length&&v.childNodes[n]!=h.startContainer;n++){}j=u.getElementsByTagName(v.nodeName);for(o=0;o<j.length;o++){if(v==j[o]){l=o;break}}p=DomUtil.getParentElement(h.endContainer);for(m=0;m<p.childNodes.length&&p.childNodes[m]!=h.endContainer;m++){}j=u.getElementsByTagName(p.nodeName);for(o=0;o<j.length;o++){if(p==j[o]){g=o;break}}return{startTag:v.nodeName,start:l,startIndex:n,endTag:p.nodeName,end:g,endIndex:m,startOffset:h.startOffset,endOffset:h.endOffset,scrollX:r,scrollY:q}}return null},moveToBookmark:function(j){var f,e,h;var m=this._doc;var l=this._win;var k=this._sel;if(!j){return false}if(es.Browser.WebKit){k.setBaseAndExtent(j.startContainer,j.startOffset,j.endContainer,j.endOffset);return true}if(es.Browser.IE){if(j.rng){j.rng.select();return true}l.focus();if(j.tag){f=m.body.createControlRange();e=m.getElementsByTagName(j.tag);if(e.length>j.index){try{f.addElement(e[j.index])}catch(g){}}}else{f=this.getSelection().createRange();f.moveToElementText(m.body);f.collapse(true);f.moveStart("character",j.start);f.moveEnd("character",j.length)}f.select();l.scrollTo(j.scrollX,j.scrollY);return true}if(es.Browser.Gecko&&j.rng){k.removeAllRanges();k.addRange(j.rng);l.scrollTo(j.scrollX,j.scrollY);return true}if(es.Browser.Gecko){f=m.createRange();e=m.getElementsByTagName(j.startTag);if(e.length>j.start){f.setStart(e[j.start].childNodes[j.startIndex],j.startOffset)}e=m.getElementsByTagName(j.endTag);if(e.length>j.end){f.setEnd(e[j.end].childNodes[j.endIndex],j.endOffset)}k.removeAllRanges();k.addRange(f);l.scrollTo(j.scrollX,j.scrollY);return true}return false},repaint:function(){if(es.Browser.IE&&!es.Browser.IE.Opera){return}try{var e=this.getBookmark(true);this._doc.body.style.display="none";this._doc.execCommand("selectall",false,null);this._sel.collapseToStart();this._doc.body.style.display="block";s.moveToBookmark(e)}catch(f){}}});es.component.DOMSelection=a})();if(typeof(itsm)=="undefined"){var itsm=window.itsm={}}(function(){var d=es.Browser.IE;var a=es.Browser.Gecko;var b=es.Browser.Opera;if(typeof(itsm.attach)=="undefined"){itsm.attach={}}Object.extend(itsm.attach,{loadFilter:{},toAttachList:function(h){var e,k,j=itsm.attach.loadFilter;for(var f in j){k=j[f];e=this._getAttachment(h,k,k.tagName);if(f=="cymap"){e=e.concat(this._getAttachment(h,k,k.tag2ndName))}for(var g=0;g<e.length;g++){k.filter(e[g])}}},_getAttachment:function(l,j,h){var g,e=new Array();var k=l.getElementsByTagName(h);for(var f=0;f<k.length;f++){g=k[f];if(es.Dom.readAttribute(g,"name")==j.type){g.removeAttribute("espresso:replacedtag");e[e.length]=g}}return e},DefaultLoadFilter:function(f,g,e,h){return{tagName:f||(d?"iframe":"img"),type:g||"img",filter:function(i){var j=this.convert(i);if(e&&h){espresso.sendCommand(e,h,j)}},convert:function(i){return null},_getDiv:function(){var i=espresso.sendCommand("WYSIWYGEditor","getDocument");return i.createElement("DIV")},_makeRandomID:function(){var i=new Date();var k=new Date(i.toGMTString());var m=k.getYear()+"";m=m.substring(m.length-2);var o=(k.getMonth()<10)?"0"+(k.getMonth()+1):k.getMonth()+"";var j=(k.getDate()<10)?"0"+k.getDate():k.getDate()+"";var l=Math.random()*3;var n=Math.ceil(l);var p=n+m+o+j+Math.random().toString().split(".")[1].substring(0,3);return p},getAttrib:function(l,j,i){i=i||"";if(!l||l.nodeType!=1){return i}var k=l.getAttribute(j);if(j=="class"&&!k){k=l.className}if(a&&j=="src"&&l.src!=null&&l.src!=""){k=l.src}if(a&&j=="href"&&l.href!=null&&l.href!=""){k=l.href}if(j=="http-equiv"&&d){k=l.httpEquiv}if(j=="style"&&!b){k=l.style.cssText}return(k&&k!="")?k:i},$attr:function(m,l){if(m){if(m instanceof Array){var j=new Array();for(var k=0;k<m.length;k++){j.push(m[k]?m[k].getAttribute("swaf:"+l):null)}return j}else{return m.getAttribute("swaf:"+l)}}return null},getOuterHTML:(d?function(i){return i.outerHTML}:function(j){var i=this._getDiv("div");i.appendChild(j.cloneNode(true));return i.innerHTML})}}});var c=new itsm.attach.DefaultLoadFilter("img","image","attach_toolbar.plugin.AttachImage","addImage");Object.extend(c,{convert:function(e){return this.buildInfo(e)},buildInfo:function(h){var i=this.getAttrib(h,"id");if(!i||i==""){i=this.$attr(h,"cywrite:object_id");if(i||i==""){i=this._makeRandomID()}h.id=i}var k=this.getOuterHTML(h);h.id="proxy_"+i;var l=this.getOuterHTML(h);var m=h.parentNode;if(m.nodeType==1&&m.nodeName.toLowerCase()=="a"&&m.href==h.src&&m.target.toLowerCase()=="_blank"){var e=m.firstChild;var j=m.href;if(d&&!m.parentNode){m.outerHTML=e.outerHTML}else{m.parentNode.replaceChild(e,m)}k='<a href="'+j+'" target="_blank">'+k+"</a>"}var f=(this.$attr(h,"cywrite:info")?this.$attr(h,"cywrite:info"):"||0|");var n=f.split("|");var g={fid:n[3]};return{id:i,filename:n[0],size:parseInt(n[2]),view_html:l,html:k,type:this.type,url:(this.getAttrib(h,"src")?this.getAttrib(h,"src"):""),thumbnail:(this.getAttrib(h,"src")?this.getAttrib(h,"src"):""),data:g,insertFromList:true,syncDoc:true,proxy:true}}});itsm.attach.loadFilter.img=c})();if(typeof(itsm)=="undefined"){var itsm=window.itsm={}}(function(){if(typeof(itsm.attach)=="undefined"){itsm.attach={}}Object.extend(itsm.attach,{toForm:function(c){var l=AttachUtil.getAttachedTypeList();for(var g=0;g<l.length;g++){var m=l[g];var n=AttachUtil.getAttachedDataList(m);var k=(itsm.real_removed[m]?itsm.real_removed[m]:[]);var d=[];for(var e=0;e<n.length;e++){var f=n[e];if(k.indexOf(f.fid)!=-1){k=k.without(f.fid)}else{d.push(f)}}if(this.formFilter[m]){this.formFilter[m].convert(c,d)}if(k.length>0){var o="";for(var e=0;e<k.length;e++){o+=k[e]+","}o=o.substring(0,o.lastIndexOf(","));var b=m;if(b=="file"){b="attach"}var h=es.$C("input",{type:"hidden",name:"removed_"+b,value:o});h.className="espresso_attach_element";c.appendChild(h)}}}});var a=function(c,b){this.paramName=c;this.handleValue=b||function(d,e){return d+":"+e}};a.prototype={convert:function(d,b){for(var c=0;c<b.length;c++){d.appendChild(this.toForm(b[c]))}},toForm:function(c){var d="";for(var b in c){d+=(this.handleValue(b,c[b])+",")}d=d.substring(0,d.lastIndexOf(","));var e=es.$C("input",{type:"hidden",name:this.paramName,value:d});e.className="espresso_attach_element";return e}};itsm.attach.formFilter={file:new a("attach[]"),image:new a("image[]")};itsm.getContent=function(b){var f=espresso.sendCommand("WYSIWYGEditor","getDocument");AttachUtil.syncAttach(f);var e=AttachUtil.translateProxy(f,b);e=DomUtil.replacePofHR(e);var c=espresso.sendCommand("WYSIWYGEditor","getTempContent");if(c.stripTags()==e.stripTags()){e=""}var g=espresso.sendCommand("WYSIWYGEditor","getDefaultFont");var d='style="font-size:9pt;"';e='<!--espresso editor content start--><div id="espresso_editor_view" '+d+">"+e+"\n</div><!--espresso editor content end-->";return e};itsm.getRawContent=function(){return espresso.sendCommand("WYSIWYGEditor","getContent")};itsm.objFrm=null;itsm.editor_params=null;itsm.setContent=function(c,d,b){itsm.objFrm=d;if(b){itsm.editor_params=b}espresso.sendCommand("WYSIWYGEditor","setClearContentsOnFocus",false);espresso.sendCommand("WYSIWYGEditor","addCallback",{type:"setContentEnded",callback:itsm.setContentEnded});espresso.sendCommand("WYSIWYGEditor","setContent",c)};itsm.setContentEnded=function(){var b=espresso.sendCommand("WYSIWYGEditor","getDocument");itsm.attach.toAttachList(b.body);itsm.processAfterLoadEnded(itsm.objFrm,itsm.editor_params);espresso.broadcastCommand("loadComplete")};itsm.isModify=false;itsm.addAttachmentsToForm=function(b){itsm.attach.toForm(b)};itsm.real_removed={};itsm.processAfterLoadEnded=function(l,o){itsm.isModify=(l.itemSq&&l.itemSq.value!="");if(o){var j=o.attach;if(typeof(j)!="undefined"){for(fileInfo in j){var e=j[fileInfo];var n=e.split("|");var i=n[0];var g=n[1];var k=parseInt(n[2]);var f=n[3];var h={fid:f};var b=i;if(b.length>16){b=b.substring(0,16);b+="..."}var c="espressoattachfile"+f.substring(f.lastIndexOf("_")<0?0:f.lastIndexOf("_")+1);var m='<a id="'+c+'" href="'+g+'" target="_blank">'+i+"</a>";var d={id:c,filename:b,file_size:k,file_link:g,view_html:m,data:h};espresso.sendCommand("attach_toolbar.plugin.AttachFile","addAttach",d)}}}if(itsm.isModify){itsm.real_removed=itsm.getObjectIdList()}};itsm.getObjectIdList=function(){var h={};var e=AttachUtil.getAttachedTypeList();for(var d=0;d<e.length;d++){var f=e[d];h[f]=[];var c=AttachUtil.getAttachedDataList(f);for(var b=0;b<c.length;b++){var g=c[b];h[f].push(g.fid)}}return h};itsm.isContentEdited=function(){return(espresso._undoIndex>0)};itsm.widthShrinked=0;itsm.widthExpanded=894;itsm.resizeEditor=function(b){if(b&&itsm.widthShrinked==0){itsm.widthShrinked=espresso.sendCommand("WYSIWYGEditor","getWidthOfEditor")}document.getElementById("espresso_editor").style.width=(b?itsm.widthExpanded:itsm.widthShrinked)+2+"px";document.getElementById("espresso_toolbar_Toolbar").style.width=(b?itsm.widthExpanded:itsm.widthShrinked)+2+"px";document.getElementById("espresso_WYSIWYGEditor_WYSIWYGEditor").style.width=(b?itsm.widthExpanded:itsm.widthShrinked)+"px";document.getElementById("espresso_attach_list_attach_list_wrap").style.width=(b?itsm.widthExpanded:itsm.widthShrinked)+2+"px"}})();es.component.Toolbar=es.Class.create(es.editor.ComponentBase,{initialize:function($super){this._version="1.0";this._name="component.Toolbar";this._description="Editor Toolbar component";$super()},COOKIE_NAME:"espresso_viewAdvToolbar",initUI:function(){this.advancedToolbar=this.elements.AdvancedToolbar;this.reduceElm=this.elements.ToolbarReduce;this.enlargeElm=this.elements.ToolbarEnlarge;if(this.reduceElm){es.Event.observe(this.reduceElm,"click",this.onReduceClick.bindAsEventListener(this))}if(this.enlargeElm){es.Event.observe(this.enlargeElm,"click",this.onEnlargeClick.bindAsEventListener(this))}var a=this.elements.Toolbar.getAttribute("viewAdvancedToolbar");if(a=="true"||a==true){this.showAdvancedToolbar(true)}else{this.hideAdvancedToolbar(true)}this.parentFrame=null;if(parent&&parent.document){this.parentFrame=parent.document.getElementById("mainFrame")}},onReduceClick:function(a){this.hideAdvancedToolbar()},onEnlargeClick:function(a){this.showAdvancedToolbar()},showAdvancedToolbar:function(a){this.advancedToolbar.style.display="block";this.enlargeElm.style.display="none";Util.setCookie(this.COOKIE_NAME,"true",365,"/");if(!a&&this.parentFrame){this.parentFrame.style.height=(this.parentFrame.offsetHeight+28)+"px"}},hideAdvancedToolbar:function(a){this.advancedToolbar.style.display="block";this.advancedToolbar.style.display="none";this.enlargeElm.style.display="block";Util.setCookie(this.COOKIE_NAME,"false",365,"/");if(!a&&this.parentFrame){this.parentFrame.style.height=(this.parentFrame.offsetHeight+-28)+"px"}}});(function(){var a=es.Class.create(es.editor.ComponentBase,{initContentsOnFirstFocus:false,contentsFirstCleared:false,initialContents:"",_isModified:false,initialize:function($super){this._version="1.0";this._name="component.WYSIWYGEditor";this._description="WYSIWYG Editor component";$super()},moduleInit:function(b){if(typeof b!="undefined"){this.initContentsOnFirstFocus=b}},initUI:function(){var d=this.getParameter("initial_parameter").default_font;if(es.Browser.IE&&d&&d.length>0){var b=false;if(d.charAt(d.length-1)=="A"){b=true;d=d.substring(0,d.length-1)}this.BASE_CONTENT='<FONT style="FONT-SIZE: 10pt" face='+d+"_10"+(b?"A":"")+",><P></P></font>"}this.selection=new es.component.DOMSelection(this);es.component.WysiwygIntializer.write(this.getParameter("initial_parameter"),this.getDocument(),this.BASE_CONTENT);var c=this.getDocument();if(c.body&&c.body.contentEditable!=undefined&&window.ActiveXObject){c.body.contentEditable="true"}else{c.designMode="on"}this._observeIFrame();es.component.WysiwygResizer.initialize(this,this.elements.resize_bar,this.onCmdResize.bind(this));this._width=es.Dom.getWidth(this.elements.WYSIWYGEditor);this._leftPosition=es.Dom.getPosition(this.elements.WYSIWYGEditor).left},_observeIFrame:function(){es.Event.observe(document,"keydown",this._handleKeyEvent.bindAsEventListener(this));es.Event.observe(this.getDocument(),"keydown",this._handleKeyEvent.bindAsEventListener(this));this.clearContentsHandler=this._clearContents.bindAsEventListener(this);if(es.Browser.IE){this._isRecovering=false;es.Event.observe(this.element,"deactivate",function(b){if(!this._isRecovering){this.selection.update();this.selection.save()}}.bindAsEventListener(this));es.Event.observe(this.element,"activate",function(b){if(es.Browser.IE&&navigator.userAgent.indexOf("Trident/4.0")!=-1){}else{if(!this._isRecovering){this.selection.restore();this.focus()}}this.closeDialogs()}.bindAsEventListener(this));es.Event.observe(this.element,"focus",this.clearContentsHandler)}else{es.Event.observe(this.getDocument(),"focus",this.clearContentsHandler);es.Event.observe(this.getDocument(),"focus",this.closeDialogs.bindAsEventListener(this))}},getDocument:function(){return this.element.contentDocument||this.element.contentWindow.document},getWindow:function(){return this.element.contentWindow||this.element},getFrame:function(){return this.element},getSelection:function(){this.selection.update();return this.selection},focus:function(){if(!this.contentsFirstCleared){this._clearContents()}this.getWindow().focus();if(es.Browser.IE&&navigator.userAgent.indexOf("Trident/4.0")!=-1){this.selection.update()}},blur:function(){this.getWindow().blur()},bodyFocus:function(){this.getWindow().document.body.focus();if(es.Browser.IE&&navigator.userAgent.indexOf("Trident/4.0")!=-1){this.selection.update()}},selectElement:function(c){var b=this.getDocument().getElementById(c);if(b){this.getSelection().selectElement(b)}},execute:function(){var c=this.getDocument();var d=arguments[0];var b=(arguments.length==1?"":arguments[1]);c.execCommand(d,false,b);this._isModified=true},BASE_CONTENT:(es.Browser.IE?"<P></P>":"<BR/>"),insertHTML:es.Browser.IE?function(b){var c=this.getDocument();this.selection.update();if(!this.contentsFirstCleared){this._clearContents()}if(c.body.innerHTML==this.BASE_CONTENT){b="<p>"+b+"</p>"}this.selection.pasteContents(b);this._isModified=true}:function(b){this.execute("inserthtml",b);this._isModified=true},insertContents:es.Browser.IE?this.insertHTML:function(b){this.selection.insertContents(b);this.selection.repaint();this._isModified=true},insertNode:function(d,c){if(typeof(d)=="string"){var b=Util.getCachedDiv();b.innerHTML=d;d=b.childNodes;if(d.length==1){d=b.childNodes[0]}}this.selection.update();d=this.selection.replaceContents(d);c=c||this.selection.RANGE_END;this.selection.setRange(d,c);this.focus();this._isModified=true},_clearContents:function(){if(this.initContentsOnFirstFocus){var c=this.getDocument();c.body.innerHTML=this.BASE_CONTENT;this.contentsFirstCleared=true;if(es.Browser.IE){this.element.focus();this.element.blur();this.getDocument().body.focus()}}var b=(es.Browser.IE?this.element:this.getDocument());es.Event.stopObserving(b,"focus",this.clearContentsHandler);this.clearContentsHandler=null},closeDialogs:function(){var b=this.getDocument();DialogUtil.closeAllDialogs()},KEY_CUT:88,KEY_PASTE:86,_handleKeyEvent:function(b){switch(b.keyCode){case es.Event.KEY_ESC:this.closeDialogs();break;case es.Event.KEY_BACKSPACE:if(es.Browser.IE&&this.selection.getSelection().type.toLowerCase()=="control"){this.execute("delete");es.Event.stop(b)}break;case this.KEY_PASTE:case this.KEY_CUT:if(b.ctrlKey){this.sendCommand.bind(this).defer("saveUndo")}break;default:this._isModified=true;break}},isModified:function(){return this._isModified},setModified:function(){this._isModified=true},initModification:function(){this._isModified=false}});Object.extend(a.prototype,es.component.WysiwygInterface);es.component.WysiwygEditor=a})();(function(){var a=es.Class.create(es.editor.PluginBase,{webFontNameList:[],webFontCodeList:[],existWebFont:false,disableWebFont:false,initialize:function($super){this._version="1.0";this._name="plugin.WebFontBtn";this._description="Editor Toolbar WebFont Button Plugin";$super()},moduleInit:function(d,c){this.disableWebFont=c;var f=d.split(",");for(var e=0;e<f.length;e++){if(f[e].trim().length==0){continue}this.existWebFont=true;var b=f[e].split("|");this.webFontCodeList.push(b[0]);this.webFontNameList.push(b[1])}},initUI:function(){this.dialog=this.elements.webfontLayer;this.initDialog();if(es.Browser.IE&&this.disableWebFont==false){this.addWebFontOptions();var b=this.elements.webfont_list.id;for(var c=0;;c++){var d=es.$(b+"_"+c);if(!d){break}es.Event.observe(d,"click",this.onChangeWebFontName.bindAsEventListener(this))}}else{this.elements.webfont_list.style.display="none";this.elements.webfont_list_separator.style.display="none"}var e=this.dialog.id;for(var c=0;;c++){var d=es.$(e+"_"+c);if(!d){break}es.Event.observe(d,"click",this.onChangeFontName.bindAsEventListener(this))}es.Event.observe(this.elements.webfont,"click",this.onClickBtn.bindAsEventListener(this))},addWebFontOptions:function(){var g=this.elements.webfont_list;var f="";if(this.existWebFont){var c=this.elements.webfont_list.id;for(var e=0;e<this.webFontCodeList.length;e++){var d=this.webFontCodeList[e];var b=false;if(d.charAt(d.length-1)=="A"){b=true;d=d.substring(0,d.length-1)}f+='<li><a id="'+c+"_"+e+'" href="javascript: void 0;" style="font-family:'+d+"_09"+(b?"A":"")+'; font-size:9pt" value="'+this.webFontCodeList[e]+'">'+(b?'<img src="http://c1img3.cyworld.co.kr/img/editor/actionfont.gif"> ':"")+this.webFontNameList[e]+"</a></li>"}}else{f='<li><a href="http://www.cyworld.com/mall/mall5_decoration_index.asp?effect_cd=35" target="_blank"> <u></u> </a></li>'}g.innerHTML=f},styleFilter:function(g,c){var i=["09","10","12","15","20","24"];if(g.nodeType==3){var h=es.Dom.getStyle(g.parentNode,"font-size");var f=Util.getNearestValue(parseInt(h),i);c.nodeStyle["font-size"]=f+"pt";c.styleCount++;var d=(c.intersection["font-family"]?c.intersection["font-family"]:c.nodeStyle["font-family"]);var b=false;if(d.charAt(d.length-2)=="A"){b=true;d=d.substring(0,d.length-2)+"_"}var e=d+f+(b?"A":"")+",";if(c.intersection["font-family"]){c.intersection["font-family"]=e}else{c.nodeStyle["font-family"]=e}}return c},onClickBtn:function(b){var d=this.sendCommand("getSelection");var e=es.Dom.getPosition(es.Event.element(b));var c=es.Dom.getSize(es.Event.element(b));this.toggleDialog(d,e.left,e.top+c.height);es.Event.stop(b)},onChangeWebFontName:function(b){this.sendCommand("setFocus");var c=es.Event.element(b);var d=c.getAttribute("value");this.sendCommand("setRangeStyles",{"font-family":d+"_",_filter:this.styleFilter.bind(this)});this.hideDialog()},onChangeFontName:function(b){var c=es.Event.element(b).getAttribute("value");es.Event.stop(b);this.sendCommand("setRangeStyles",{"font-family":c});this.hideDialog()}});Object.extend(a.prototype,DialogUtil.prototype);es.plugin.WebFontBtn=a})();es.plugin.FontSize=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.FontSize";this._description="Editor Toolbar Font Size Select Plugin";$super()},initUI:function(){this.dialog=this.elements.fontSize_layer;this.initDialog();var c=this.dialog.id;for(var a=0;;a++){var b=es.$(c+"_"+a);if(!b){break}es.Event.observe(b,"click",this.onChangeFontSize.bindAsEventListener(this))}es.Event.observe(this.elements.fontSize,"click",this.onClickFontSize.bindAsEventListener(this))},styleFilter:function(e,b){var h=["09","10","12","15","20","24"];var g=parseInt((b.intersection["font-size"])?b.intersection["font-size"]:b.nodeStyle["font-size"]);if(e.nodeType==3){var f=es.Dom.getStyle(e.parentNode,"font-family");f=f.split(",")[0];if(f.substr(0,2)=="CY"){var d=(f.split("_"))[0];var a=false;if(f.charAt(f.length-1)=="A"){a=true}var c=Util.getNearestValue(g,h);b.nodeStyle["font-family"]=d+"_"+c+(a?"A":"")+",";b.styleCount++;if(b.intersection["font-size"]){b.intersection["font-size"]=c+"pt"}else{b.nodeStyle["font-size"]=c+"pt"}}}return b},onClickFontSize:function(a){var c=this.sendCommand("getSelection");var d=es.Dom.getPosition(es.Event.element(a));var b=es.Dom.getSize(es.Event.element(a));this.toggleDialog(c,d.left,d.top+b.height);es.Event.stop(a)},onChangeFontSize:function(a){var b=es.Event.element(a).getAttribute("value")+"pt";es.Event.stop(a);this.sendCommand("setRangeStyles",{"font-size":b,_filter:this.styleFilter.bind(this)});this.sendCommand("saveUndo");this.hideDialog()}});Object.extend(es.plugin.FontSize.prototype,DialogUtil.prototype);(function(){var a=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.FontStyle";this._description="Editor Toolbar Font Styling Button Plugin";$super()},initUI:function(){es.Event.observe(this.elements.Bold,"click",this.onClickBold.bindAsEventListener(this));es.Event.observe(this.elements.Italic,"click",this.onClickItalic.bindAsEventListener(this));es.Event.observe(this.elements.Underline,"click",this.onClickUnderline.bindAsEventListener(this));es.Event.observe(this.elements.Strike,"click",this.onClickStrike.bindAsEventListener(this))},onClickBold:function(b){es.Event.stop(b);this.sendCommand("execCommand",{cmd:"bold"});this.sendCommand("setFocus")},onClickUnderline:function(b){es.Event.stop(b);this.sendCommand("execCommand",{cmd:"underline"});this.sendCommand("setFocus")},onClickItalic:function(b){es.Event.stop(b);this.sendCommand("execCommand",{cmd:"italic"});this.sendCommand("setFocus")},onClickStrike:function(b){es.Event.stop(b);this.sendCommand("execCommand",{cmd:"strikethrough"});this.sendCommand("setFocus")}});es.plugin.FontStyle=a})();es.plugin.SupSubScript=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.SupSubScript";this._description="Editor Toolbar super script, sub script Button Plugin";$super()},initUI:function(){es.Event.observe(this.elements.SuperScript,"click",this.onClickSuperScript.bindAsEventListener(this));es.Event.observe(this.elements.SubScript,"click",this.onClickSubScript.bindAsEventListener(this))},onClickSuperScript:function(a){es.Event.stop(a);this.sendCommand("execCommand",{cmd:"superscript"});this.sendCommand("setFocus")},onClickSubScript:function(a){es.Event.stop(a);this.sendCommand("execCommand",{cmd:"subscript"});this.sendCommand("setFocus")}});(function(){var a=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.AlignmentBtn";this._description="This plugin aligns text which selected in iframe";$super()},initUI:function(){es.Event.observe(this.elements.LeftAlign,"click",this.onClickLeft.bindAsEventListener(this));es.Event.observe(this.elements.CenterAlign,"click",this.onClickCenter.bindAsEventListener(this));es.Event.observe(this.elements.RightAlign,"click",this.onClickRight.bindAsEventListener(this))},onClickLeft:function(b){es.Event.stop(b);this.sendCommand("execCommand",{cmd:"justifyleft"});this.sendCommand("setFocus")},onClickCenter:function(b){es.Event.stop(b);this.sendCommand("execCommand",{cmd:"justifycenter"});this.sendCommand("setFocus")},onClickRight:function(b){es.Event.stop(b);this.sendCommand("execCommand",{cmd:"justifyright"});this.sendCommand("setFocus")}});es.plugin.Alignment=a})();(function(){var a=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.Indent";this._description="Editor Toolbar Indent Button Plugin";$super()},initUI:function(){es.Event.observe(this.elements.Indent,"click",this.onClickIndent.bindAsEventListener(this));es.Event.observe(this.elements.Outdent,"click",this.onClickOutdent.bindAsEventListener(this))},onClickIndent:function(b){es.Event.stop(b);this.sendCommand("setFocus");this.sendCommand("execCommand",{cmd:"indent"})},onClickOutdent:function(b){es.Event.stop(b);this.sendCommand("setFocus");this.sendCommand("execCommand",{cmd:"outdent"})}});es.plugin.Indent=a})();es.plugin.UndoRedoBtn=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.UndoRedoBtn";this._description="Editor Toolbar Undo&Redo Button Plugin";$super()},initUI:function(){es.Event.observe(this.elements.Undo,"click",this.onClickUndo.bindAsEventListener(this));es.Event.observe(this.elements.Redo,"click",this.onClickRedo.bindAsEventListener(this))},onClickUndo:function(a){if(a&&a.preventDefault){es.Event.stop(a)}this.sendCommand("undo")},onClickRedo:function(a){if(a&&a.preventDefault){es.Event.stop(a)}this.sendCommand("redo")}});es.plugin.UndoRedo=es.Class.create(es.editor.PluginBase,{timer:null,initialize:function($super){this._version="1.0";this._name="plugin.UndoRedo";this._description="Editor Toolbar Undo&Redo Process Plugin";this.count=0;$super()},initUI:function(){var a=(this.getParent().getDocument)?this.getParent().getDocument():this.getParent().element;es.Event.observe(a,"keydown",this.onKeyDown.bindAsEventListener(this));a=null},onKeyDown:function(c){if(this.timer){window.clearTimeout(this.timer)}this.timer=null;if(c.keyCode==13){this.count++;if(this.count==2){var b=0}this.sendCommand("push")}else{if(c.keyCode<256&&!c.altKey&&!c.altLeft&&!c.ctrlKey&&!c.ctrlLeft&&!c.shiftKey&&!c.shiftLeft){this.timer=window.setTimeout(this.onTimer.bind(this),500)}}},onTimer:function(){this.sendCommand("push")},onCmdUndo:function(){var c=this.sendCommand("getDocument");var b=this.sendCommand("getSelection");if(this.timer){window.clearTimeout(this.timer);this.timer=null;this.sendCommand("push","fromUndo")}if(!this.editor._undoStack){return}this.editor._undoIndex--;if(this.editor._undoIndex<0){this.editor._undoIndex=0}var a=this.editor._undoStack[this.editor._undoIndex];if(c.body.innerHTML!=a){c.body.innerHTML=a}this.sendCommand("notifyUndo");this.sendCommand("debug")},onCmdRedo:function(){if(this.timer){window.clearTimeout(this.timer);this.timer=null}if(!this.editor._undoStack){return}var c=this.sendCommand("getDocument");var b=this.sendCommand("getSelection");this.editor._undoIndex++;if(this.editor._undoIndex>=this.editor._undoStack.length){this.editor._undoIndex=this.editor._undoStack.length-1}var a=this.editor._undoStack[this.editor._undoIndex];if(c.body.innerHTML!=a){c.body.innerHTML=a}this.sendCommand("notifyRedo");this.sendCommand("debug")}});es.plugin.Shortcut=es.Class.create(es.editor.PluginBase,{tableName:"default",initialize:function($super){this._version="1.0";this._name="plugin.Shortcut";this._description="Editor Shortcut Plugin";$super()},moduleInit:function(a){if(a&&a.length>0){this.tableName=a}},initUI:function(){var a=(this.getParent().getDocument)?this.getParent().getDocument():this.getParent().element;es.Event.observe(a,"keydown",this.onKeyDown.bindAsEventListener(this));a=null},onKeyDown:function(b){if(this.editor&&this.editor.shortcut&&this.editor.shortcut[this.tableName]){var c=0;if(b.ctrlKey||b.ctrlLeft){c|=4096}if(b.altKey||b.altLeft){c|=8192}if(b.shiftKey||b.shiftLeft){c|=16384}if(b.keyCode<4096&&b.keyCode>40){c|=b.keyCode}var a=this.editor.shortcut[this.tableName][c];if(a){if(Object.isFunction(a.cmd)){a.cmd.call(a.target,b,a.cmd)}else{if(Object.isString(a.cmd)&&a.target.execCommand){a.target.execCommand(a.cmd,b)}}es.Event.stop(b)}}}});es.plugin.ColorBtn=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.ColorBtn";this._description="This Plugin support foreground and background color insertion.";$super()},initUI:function(){this.foreColorChoiceElm=this.elements.ForeColorChoice;this.backColorChoiceElm=this.elements.BackColorChoice;es.Event.observe(this.foreColorChoiceElm,"click",this.onForeChoiceClick.bindAsEventListener(this));es.Event.observe(this.backColorChoiceElm,"click",this.onBackChoiceClick.bindAsEventListener(this));this.setCurrForeColor(this.foreColorChoiceElm.getAttribute("defaultColor"));this.setCurrBackColor(this.backColorChoiceElm.getAttribute("defaultColor"));es.Event.observe(this.elements.ForeColor,"click",this.onForeClick.bindAsEventListener(this));es.Event.observe(this.elements.BackColor,"click",this.onBackClick.bindAsEventListener(this))},onForeChoiceClick:function(a){this.selectForeColor(this.currForeColor)},onBackChoiceClick:function(a){this.selectBackColor(this.currBackColor)},onForeClick:function(a){this.handleClick(a,this.currForeColor,this.selectForeColor.bind(this))},onBackClick:function(a){this.handleClick(a,this.currBackColor,this.selectBackColor.bind(this))},selectForeColor:function(a){this.selectColor("forecolor",a);this.setCurrForeColor(a)},_backColorCmd:(es.Browser.IE?"backcolor":"hilitecolor"),selectBackColor:function(a){this.selectColor(this._backColorCmd,a);this.setCurrBackColor(a)},selectColor:function(c,a){var b=this.sendCommand("getSelection");b.restore();this.sendCommand("execCommand",{cmd:c,data:a});this.sendCommand("saveUndo")},setCurrForeColor:function(a){this.foreColorChoiceElm.style.backgroundColor=a;this.currForeColor=a},setCurrBackColor:function(a){this.toggleBackColorClassName(a);this.backColorChoiceElm.style.backgroundColor=a;this.currBackColor=a},isLightColor:function(c){if(c.length==7){c=c.substring(1)}var e=c.substring(0,2);var d=c.substring(2,4);var a=c.substring(4);return(e>"aa"&&d>"aa"&&a>"aa")},WhiteFont_CSS:"toolbar_bgcolor_choice",BlackFont_CSS:"toolbar_bgcolor_choice_black",toggleBackColorClassName:function(a){if(this.isLightColor(a)){if(es.Dom.hasClassName(this.backColorChoiceElm,this.WhiteFont_CSS)){es.Dom.removeClassName(this.backColorChoiceElm,this.WhiteFont_CSS);es.Dom.addClassName(this.backColorChoiceElm,this.BlackFont_CSS)}}else{if(es.Dom.hasClassName(this.backColorChoiceElm,this.BlackFont_CSS)){es.Dom.removeClassName(this.backColorChoiceElm,this.BlackFont_CSS);es.Dom.addClassName(this.backColorChoiceElm,this.WhiteFont_CSS)}}},handleClick:function(b,c,a){this.sendCommand("showHideColorDialog",{selectedColor:c,element:es.Event.element(b),callbackFunc:a});es.Event.stop(b)}});RSC_LINK_DLG_SELECTION_HAS_NOT_LINKABLE_AREA="    .";(function(){var a=es.Class.create(es.editor.PluginBase,{LIMIT_OF_SIZE:705,WIDTH_OF_DIALOG:265,initialize:function($super){this._version="1.0";this._name="plugin.LinkInsertBtn";this._description="Editor Toolbar a tag insert Plugin";$super()},moduleInit:function(b){},initUI:function(){es.Event.observe(this.elements.LinkInsert,"click",this.onCmdClick.bindAsEventListener(this));this.dialog=this.elements.LinkDlg;this.initDialog();this.addrInput=this.elements.link_dialog_address;this.targetCheck=this.elements.link_dialog_target;this.msg=this.elements.link_dialog_msg;es.Event.observe(this.addrInput,"keydown",function(c){if(c.keyCode==es.Event.KEY_RETURN){es.Event.stop(c);this.onOk()}}.bindAsEventListener(this));es.Event.observe(this.elements.link_dialog_ok,"click",this.onOk.bindAsEventListener(this));es.Event.observe(this.elements.link_dialog_cancel,"click",this.onCancel.bindAsEventListener(this));var b=this.sendCommand("getWidthOfEditor");if(b<this.LIMIT_OF_SIZE){this.absLeftPosition=this.sendCommand("getLeftPositionOfEditor")*1+b-this.WIDTH_OF_DIALOG}},onShorcut:function(){this.sendCommand("setBlur");this.onCmdClick()},onCmdClick:function(b){var e=this.sendCommand("getSelection");var f=es.Dom.getPosition(es.Event.element(b));var c=es.Dom.getSize(es.Event.element(b));var d=this.absLeftPosition||f.left;this.toggleDialog(e,d,f.top+c.height);es.Event.stop(b)},beforeShowDialog:function(b){if(b){if(this._hasSelection(b)){this.msg.style.display="none";return true}else{alert(RSC_LINK_DLG_SELECTION_HAS_NOT_LINKABLE_AREA);return false}}},afterShowDialog:function(b){if(b){this.targetNode=this._getLinkedNode(b);if(this.targetNode!=null){this.addrInput.value=this.targetNode.href;if(this.targetNode.target=="_top"){this.targetCheck.checked=false}else{this.targetCheck.checked=true}if(es.Browser.IE){this._moveEnd()}}else{this.addrInput.value="http://";this.targetCheck.checked=true;if(es.Browser.IE){this._moveEnd(false)}}}this.addrInput.focus()},_getLinkedNode:function(c){var d;if(this.isControlRange){var b=c.getRange();d=b.item(0).parentNode}else{d=c.getParent()}do{if(DomUtil.equalsNodeName(d,"body")||DomUtil.equalsNodeName(d,"html")){return null}else{if(DomUtil.equalsNodeName(d,"a")){return d}}d=d.parentNode}while(!this.isControlRange)},onOk:function(){var b=this.addrInput.value;if(!Validator.checkProtocol(b)){b="http://"+b}var c=this.targetCheck.checked?this.targetCheck.value:"_top";if(Validator.checkURL(b)){this.sendCommand("setFocus");if(this.targetNode){this.targetNode.href=b;this.targetNode.target=c;this.sendCommand("saveUndo");this.hideDialog()}else{this._createLink(b,c)}this.msg.style.display="none"}else{this.msg.style.display="block";if(es.Browser.IE){this._moveEnd()}else{this.addrInput.setSelectionRange(0,this.addrInput.selectionEnd)}this.addrInput.focus()}},onCancel:function(){this.hideDialog()},clearInput:function(){this.addrInput.value="";this.targetNode=null}});if(es.Browser.IE){a.prototype._hasSelection=function(c){var b=c.getRange();this.isControlRange=c.getSelection().type=="Control";return(this.isControlRange||(b.text&&b.text.length>0))};a.prototype._createLink=function(n,c){var o=function(q){var i=m.body.createTextRange();i.moveToElementText(q);return g.inRange(i)};var m=this.sendCommand("getDocument");var e=this.sendCommand("getSelection");e.restore();if(this.isControlRange){this.sendCommand("execCommand",{cmd:"createLink",data:n});e.update();var b=e.getRange(),f;for(var j=0;j<b.length;j++){f=b.item(j).parentNode;if(f&&DomUtil.equalsNodeName(f,"a")){f.setAttribute("target",c)}}}else{var h=e.getParent();h=(DomUtil.equalsNodeName(h,"body")?h:h.parentNode);this.sendCommand("execCommand",{cmd:"createLink",data:n});e.update();if(c){var g=e.getRange();var k=g.htmlText;var l=e.getParent();var d=(k.indexOf("<A")==0&&k.lastIndexOf("</A>")==k.length-4);if(d&&l.getAttribute("href")==n){l.setAttribute("target",c)}var p=h.getElementsByTagName("a");for(var j=0;j<p.length;j++){if(o(p[j])){p[j].setAttribute("target",c);e.update();g=e.getRange()}}}}this.sendCommand("saveUndo");this.hideDialog()};a.prototype._moveEnd=function(c){var b=this.addrInput.createTextRange();b.moveEnd("character",this.addrInput.value.length);if(typeof(c)!="undefined"){b.collapse(c)}b.select()}}else{a.prototype._hasSelection=function(e){var c=e.getRange();var b=e.getSelection().isCollapsed;var d=(c.toString().length>0);return(d||!b)};a.prototype._createLink=function(k,c){this.sendCommand("execCommand",{cmd:"unlink"});var g=Util.getRandID();var j=this.sendCommand("getDocument");var d=j.createElement("a");d.setAttribute("href",k);d.setAttribute("target",c);d.setAttribute("id",g);var e=this.sendCommand("getSelection");var h=e.getRange();h.surroundContents(d);var b=this.sendCommand("getDocument");d=b.getElementById(g);var l=d.getElementsByTagName("a");for(var f=0;f<l.length;f++){d.removeChild(l[0])}d.id="";e.setRange(d);this.sendCommand("saveUndo");this.hideDialog()}}Object.extend(a.prototype,DialogUtil.prototype);es.plugin.LinkInsertBtn=a})();(function(){var a=es.Class.create(es.editor.PluginBase,{TAG_NAME:"blockquote",REMOVE_QUOTE:10,LENGTH_OF_STYLES:10,initialize:function($super){this._version="1.0";this._name="plugin.QuoteInsertBtn";this._description="This plugin inserts blockquote tag in editor.";$super()},initUI:function(){this.dialog=this.elements.QuoteInsertsDlg;this.initDialog();es.Event.observe(this.elements.QuoteInsert,"click",this.onToggleDialog.bindAsEventListener(this));this.quoteImgs=this.dialog.getElementsByTagName("a");for(var b=0;b<this.quoteImgs.length;b++){es.Event.observe(this.quoteImgs[b],"mouseover",function(c){es.Event.element(c).focus()});es.Event.observe(this.quoteImgs[b],"click",this.executeQuote.bindAsEventListener(this))}this.doc=this.sendCommand("getDocument")},isQuote:function(b){if(b&&DomUtil.equalsNodeName(b,"blockquote")){return true}else{return false}},findQuote:function(b){if(!this.finder){this.finder=new util.NodeFinder(this.TAG_NAME,this.isQuote)}return this.finder.find(b,this.doc)},findQuoteHasStyle:function(d){var b=this.findQuote(d);if(b&&b.constructor&&b.constructor==Array){var e=b.length;for(var c=e-1;c>=0;c--){if(!/quote0\d/.test(b[c].className)){b.splice(c,1)}}return(b.length==0?null:b)}else{if(b&&b.className&&/quote0\d/.test(b.className)){return b}else{return null}}},onToggleDialog:function(b){var e=this.sendCommand("getSelection");var d=es.Event.element(b);var f=es.Dom.getPosition(d);var c=es.Dom.getSize(d);this.toggleDialog(e,f.left,f.top+c.height);es.Event.stop(b)},beforeShowDialog:function(b){this.finded=this.findQuoteHasStyle(b)},executeQuote:function(f){this.sendCommand("clearContents");var g=function(i){if(i.constructor==Array){return i[0]}return i};var e=es.Event.element(f).parentNode;es.Event.stop(f);this.sendCommand("setFocus");var d=this.sendCommand("getSelection");if(e){var b,c;var h=parseInt(/\d+/.exec(e.className),this.LENGTH_OF_STYLES);if(h==this.REMOVE_QUOTE){if(this.finded){b=g(this.finded);c=b.parentNode;while(b.firstChild){c.insertBefore(b.firstChild,b)}c.removeChild(b)}else{}}else{if(this.finded){b=g(this.finded)}else{this._execCommand(d);b=this.findQuote(d)}this.setStyle(b,h)}this.sendCommand("saveUndo")}this.hideDialog();this.finded=null},onCancel:function(){this.hideDialog()},setStyle:function(c,d){if(c&&c.constructor==Array){for(var b=0;b<c.length;b++){c[b].className="quote0"+d}}else{c.className="quote0"+d}}});Object.extend(a.prototype,es.plugin.executeQuote);Object.extend(a.prototype,DialogUtil.prototype);es.plugin.QuoteInsertBtn=a})();MSG_HAS_NOT_FIND="  .";MSG_COUNT_REPLACE="  .";MSG_FOUND_END="  .";es.plugin.FindReplaceBtn=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.FindReplaceBtn";this._description="Editor Toolbar Find, Replace button Plugin";$super()},initUI:function(){es.Event.observe(this.elements.FindReplaceBtn,"click",this.onCmdClick.bindAsEventListener(this));this._initDialog()},_initDialog:function(){this.dialog=this.elements.findReplaceDlg;this.movingBar=this.elements.movingBar;this.isFloatingDialog=true;this.strInputs=this.dialog.getElementsByTagName("input");this.findText=this.strInputs[0];this.replaceText=this.strInputs[1];this.msgArea=this.elements.msg;this.findBtn=this.elements.find;this.replaceBtn=this.elements.replace;this.replaceAllBtn=this.elements.replaceAll;this.closeBtn=this.elements.close;es.Event.observe(this.findBtn,"click",this.onFindBtnClick.bindAsEventListener(this));es.Event.observe(this.replaceBtn,"click",this.onReplaceBtnClick.bindAsEventListener(this));es.Event.observe(this.replaceAllBtn,"click",this.onReplaceAllBtnClick.bindAsEventListener(this));es.Event.observe(this.closeBtn,"click",this.onCloseBtn.bindAsEventListener(this));this.initDialog(true);this.dialogSize=es.Dom.getSize(this.dialog);this.strInputs=null},onCmdClick:function(e){var d=this.sendCommand("getSelection");var c=es.Event.element(e);var f=es.Dom.getPosition(c);var b=es.Dom.getSize(c);this.toggleDialog(d,f.left,f.top+b.height);if(this.isDialogVisible()){this.findText.focus();var a=this.sendCommand("getFrame");this.minLeft=a.offsetLeft;this.minTop=a.offsetTop;this.maxRight=this.minLeft+a.offsetWidth;this.maxBottom=this.minTop+a.offsetHeight}es.Event.stop(e)},onFindBtnClick:function(a){this.find();es.Event.stop(a)},onReplaceBtnClick:function(a){this.replace();es.Event.stop(a)},onReplaceAllBtnClick:function(a){this.replaceAll();es.Event.stop(a)},find:function(){if(!this.checkFindText()){return}this.sendCommand("find",this.findText.value)},replace:function(){if(!this.checkFindText()){return}this.sendCommand("replace",this.replaceText.value.escapeHTML());this.sendCommand("saveUndo");this.find()},replaceAll:function(){if(!this.checkFindText()){return}var a=this.sendCommand("replaceAll",{findText:this.findText.value,replaceText:this.replaceText.value});this.sendCommand("saveUndo");this.setMsg(a+MSG_COUNT_REPLACE)},checkFindText:function(){if(!this.sendCommand("getContentsInitialized")){this.sendCommand("setFocus")}if(this.findText.value==""){this.setMsg(MSG_HAS_NOT_FIND);return false}return true},onCloseBtn:function(a){this.toggleDialog()},clearInput:function(){this.findText.value="";this.replaceText.value="";this.msgArea.style.display="none";this.msgArea.innerHTML=""},onCmdSetMsg:function(a){this.setMsg(a)},setMsg:function(a){if(a!=""){this.msgArea.style.display="block"}this.msgArea.innerHTML=a}});Object.extend(es.plugin.FindReplaceBtn.prototype,DialogUtil.prototype);es.plugin.FindReplace=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.FindReplace";this._description="Editor Toolbar Find, Replace Plugin";$super()},onCmdFind:function(a){this.findStr=a;return this.find(a)},onCmdReplace:function(a){return this.replace(a)},onCmdReplaceAll:function(a){return this.replaceAll(a)},setCursorBegin:function(b,a){if(es.Browser.IE){this.range=b.body.createTextRange();this.range.collapse(true);this.range.select()}else{a.setRange(b.body.firstChild,a.RANGE_START)}},find:function(e,b){var c=false;var d=this.sendCommand("getDocument");var a=this.sendCommand("getSelection");if(!this.range){a.restore();this.range=a.getRange()}if(es.Browser.IE){this.range.collapse(false);c=this.range.findText(e);if(!c){if(!b){this.sendCommand("setMsg",MSG_FOUND_END);this.setCursorBegin(d);c=this.range.findText(e);if(c){this.range.select()}}}else{this.sendCommand("setMsg","");this.range.select()}}else{if(es.Browser.Gecko){c=this.sendCommand("getWindow").find(e);this.range=a.getRange();if(!c){this.sendCommand("setMsg",MSG_FOUND_END);this.setCursorBegin(d,a)}else{this.sendCommand("setMsg","")}}}return c},replace:function(g,c){var f=this.sendCommand("getDocument");var b=this.sendCommand("getSelection");b.restore();var a=b.getRange();if(c||b.equalsRange(a,this.range)){if(es.Browser.IE){try{if((this.range.text!="")){this.range.select();this.range.pasteHTML(g)}}catch(d){return false}}else{if(es.Browser.Gecko&&!b.isCollapsed()){if(!g||g.length==0){b.deleteContents()}else{b.replaceContents(f.createTextNode(g))}}}return true}else{return false}},replaceAll:function(f){var a=f.findText;var c=f.replaceText;var g=this.sendCommand("getDocument");var d=this.sendCommand("getSelection");this.setCursorBegin(g,d);var b=0;do{var e=this.find(a,true);if(e){if(this.replace(c,true)){++b}}}while(e);return b}});(function(){var a=es.Class.create(es.editor.PluginBase,{styles:["display:block; margin-top:8px; background-color:#fafafa; border-top:1px solid #646464; color:#fafafa; height:1px;","display:block; margin-top:8px; background-color:#fafafa; border-top:2px solid #646464; color:#fafafa; height:2px;","display:block; margin-top:8px; background-color:#fafafa; border-top:1px solid #646464; border-bottom:2px solid #646464; color:#fafafa; height:4px;","display:block; margin-top:8px; background-color:#fafafa; border-top:2px solid #646464; border-bottom:1px dotted #646464; color:#fafafa; height:4px;","display:block; margin-top:8px; background-color:#fafafa; border-top:1px dotted #646464; border-bottom:2px solid #646464; color:#fafafa; height:4px;","display:block; margin-top:8px; background-color:#fafafa; border-top:1px dashed #646464; color:#fafafa; height:1px;"],initialize:function($super){this._version="1.0";this._name="plugin.HrInsertBtn";this._description="Insert Hr tag in Wysiwyg Editor.";$super()},initUI:function(){es.Event.observe(this.elements.HrInsert,"click",this.onCmdClick.bindAsEventListener(this));this.dialog=this.elements.HrInsertDlg;var d=this.dialog.id;for(var b=0;;b++){var c=es.$(d+"_"+b);if(!c){break}es.Event.observe(c,"click",this.onOk.bindAsEventListener(this))}this.initDialog()},onCmdClick:function(b){var d=this.sendCommand("getSelection");var e=es.Dom.getPosition(es.Event.element(b));var c=es.Dom.getSize(es.Event.element(b));this.toggleDialog(d,e.left,e.top+c.height);es.Event.stop(b)},onOk:function(b){var e=es.Event.element(b);es.Event.stop(b);var c=e.id.split("_").last();this.sendCommand("setFocus");if(this.styles[c]){var d='<hr onresizestart="return false" style="cursor:default;'+this.styles[c]+'" unselectable="on;" />';if(!es.Browser.IE){d+="<br />"}this.sendCommand("insertHTML",d);this.sendCommand("saveUndo")}this.hideDialog()}});Object.extend(a.prototype,DialogUtil.prototype);es.plugin.HrInsertBtn=a})();(function(){var b=function(d,c){return d.getElementsByTagName(c)};var a=es.Class.create(es.editor.PluginBase,{LIMIT_OF_SIZE:580,initialize:function($super){this._version="1.0";this._name="plugin.SymbolBtn";this._description="Show SymbolDialog And Insert character which is selected by user.";$super()},initUI:function(){var d=this;var j=function(k,i){es.Event.observe(k,"click",i.bindAsEventListener(d))};this.dialog=this.elements.SymbolLayer;j(this.elements.SymbolBtn,this.onToolbarClick);var c,f;for(var g=1;g<6;g++){c=this.elements["charset_tab"+g];j(c,this.onClickTab);charset=this.elements["charset"+g];f=charset.getElementsByTagName("td");this.addEventToSymbol(f,false)}this.recentSymbols=this.elements.SymbolLayer_recent;f=this.recentSymbols.getElementsByTagName("td");this.addEventToSymbol(f,true);this.selectedSymbols=this.elements.SymbolLayer_selected_text;this.okButton=this.elements.SymbolLayer_ok;j(this.okButton,this.onOk);if(es.Browser.IE){DomUtil.disableSelection(this.dialog)}else{var h=es.Dom.getElementsByClassName("charset_table_wrap")[0];DomUtil.disableSelection(h)}a.pluginObj=this;this.initDialog();var e=this.sendCommand("getWidthOfEditor");if(e<this.LIMIT_OF_SIZE){this.absLeftPosition=this.sendCommand("getLeftPositionOfEditor")*1+5}},addEventToSymbol:function(d,c){var f,g=d.length;for(var e=0;e<g;e++){f=d[e];f.onmouseover=function(h){if(this.innerHTML!=""&&this.innerHTML!="&nbsp;"){this.style.backgroundColor="#316AC5";this.style.cursor="pointer"}};f.onmouseout=function(h){this.style.backgroundColor="";this.style.cursor="default"};f.onclick=function(h){if(this.innerHTML!=""&&this.innerHTML!="&nbsp;"){es.plugin.SymbolBtn.pluginObj.handleClick(this,this.innerHTML,c)}}}},onToolbarClick:function(c){var g=es.Event.element(c);var h=es.Dom.getPosition(g);var d=es.Dom.getSize(g);var f=this.sendCommand("getSelection");var e=this.absLeftPosition||h.left;this.toggleDialog(f,e,h.top+d.height);es.Event.stop(c)},afterShowDialog:function(c){this.okButton.focus();this.okButton.blur()},onClickTab:function(d){var g=es.Event.element(d);var h=g.parentNode;var f=h.getElementsByTagName("p");var j=h.getElementsByTagName("table");for(var e=0,c=f.length;e<c;e++){if(f[e]==g){f[e].className="selected charset_tab"+(e+1);j[e].style.display="block"}else{f[e].className="charset_tab"+(e+1);j[e].style.display="none"}}},handleClick:function(c,m,k){var n=this.selectedSymbols;n.value+=m;var j=parseInt(n.value.length);if(n.setSelectionRange){n.setSelectionRange(j,j)}else{if(n.createTextRange){var h=n.createTextRange();h.moveEnd("character",j);h.collapse(false);h.select()}}if(!k){var g=this.recentSymbols.getElementsByTagName("td");var d,l=g.length,e;for(var f=0;f<l;f++){if(g[f].innerHTML==m){l=f+1}}for(var f=0;f<l;f++){d=g[f].innerHTML;g[f].innerHTML=m;if(d==""||d=="&nbsp;"){break}else{m=d}}}},clearInput:function(){this.selectedSymbols.value=""},onOk:function(d){var c=this.selectedSymbols.value;this.sendCommand("setFocus");if(c){this.sendCommand("insertNode",{node:c,type:2})}this.sendCommand("saveUndo");this.hideDialog()}});Object.extend(a.prototype,DialogUtil.prototype);es.plugin.SymbolBtn=a})();(function(){var a=es.Class.create(es.editor.PluginBase,{LIMIT_OF_SIZE:576,WIDTH_OF_DIALOG:158,initialize:function($super){this._version="1.0";this._name="plugin.HrInsertBtn";this._description="Insert Emoticon image to the Wysiwyg Editor.";$super()},initUI:function(){this.dialog=this.elements.emoticonLayer;for(var c=1;c<4;c++){es.Event.observe(this.elements["emoticon_tab"+c],"click",this.onClickTab.bindAsEventListener(this))}es.Event.observe(this.elements.EmoticonInsert,"click",this.onCmdClick.bindAsEventListener(this));this.initDialog();var b=this.sendCommand("getWidthOfEditor");if(b<this.LIMIT_OF_SIZE){this.absLeftPosition=this.sendCommand("getLeftPositionOfEditor")*1+b-this.WIDTH_OF_DIALOG}},onClickTab:function(c){var f=es.Event.element(c);var g=f.parentNode;var e=g.getElementsByTagName("strong");var h=g.getElementsByTagName("table");for(var d=0,b=e.length;d<b;d++){if(e[d]==f){e[d].className="selected emoticon_tab"+(d+1);h[d].style.display="block"}else{e[d].className="emoticon_tab"+(d+1);h[d].style.display="none"}}},onCmdClick:function(b){a.current=this;var f=es.Event.element(b);var e=this.sendCommand("getSelection");var g=es.Dom.getPosition(f);var c=es.Dom.getSize(f);var d=this.absLeftPosition||g.left;this.toggleDialog(e,d,g.top+c.height);es.Event.stop(b)},selectEmoticon:function(b){b=b.replace("<img",'<img align="absmiddle"').replace("<IMG",'<IMG align="absmiddle"');this.hideDialog();this.sendCommand("insertHTML",b)}});a.select=function(b){es.plugin.EmoticonInsertBtn.current.selectEmoticon(b)};Object.extend(a.prototype,DialogUtil.prototype);es.plugin.EmoticonInsertBtn=a})();(function(){var b=es.Browser.IE;var a=es.Class.create(es.editor.PluginBase,{TAG_NAME:["ol","ul"],STYLE_PREFIX:"espresso_ComplexListBtn_",initialize:function($super){this._version="1.0";this._name="plugin.ComplexListBtn";this._description="Editor Toolbar a list tag insert Plugin";$super()},initUI:function(){var c=this;es.Event.observe(this.elements.ComplexListBtn,"click",function(g){var f=c.sendCommand("getSelection");var h=es.Dom.getPosition(es.Event.element(g));var e=es.Dom.getSize(es.Event.element(g));es.Event.stop(g);c.toggleDialog(f,h.left,h.top+e.height)});this.dialog=this.elements.ComplexListDlg;this.examList=this.dialog.getElementsByTagName("li");for(var d=0;d<this.examList.length;d++){es.Event.observe(this.examList[d],"click",this.executeList.bindAsEventListener(this))}this.initDialog();this.doc=this.sendCommand("getDocument")},isList:function(c){if(c&&(DomUtil.equalsNodeName(c,"ol")||DomUtil.equalsNodeName(c,"ul"))){return true}else{return false}},findList:function(c){if(!this.finder){this.finder=new util.NodeFinder(this.TAG_NAME,this.isList);if(b){this.finder.find=function(g){var f=g.getParent();var e=DomUtil.equalsNodeName(f,"li");if(this.hasTagName(f)||e){return e?f.parentNode:f}else{var h=this.getDirectAncestor(f);var d=this.getOverlapped(g,f);if(h){d.unshift(h)}if(d.length>0){return d}else{return null}}}}}return this.finder.find(c,this.doc)},beforeShowDialog:function(c){this.finded=this.findList(c)},executeList:function(d){this.sendCommand("clearContents");this.hideDialog();var e=es.Event.element(d).parentNode;var j=e.id.substring(this.STYLE_PREFIX.length,this.STYLE_PREFIX.length+1);var h=e.getAttribute("value");es.Event.stop(d);var c=function(i){switch(i){case"o":return"insertorderedlist";case"u":return"insertunorderedlist";default:return null}};var l=c(j);var k=this.sendCommand("getSelection");if(this.isOnlyStyleChange(j)){var g=this.finded}else{this.sendCommand("execCommand",{cmd:l});var g=this.findList(k);if(g==null){this.sendCommand("execCommand",{cmd:l});g=this.findList(k)}}if(g&&g.length){for(var f=0;f<g.length;f++){this.setListStyle(g[f],h)}}else{if(g&&g.nodeType==1){this.setListStyle(g,h)}}this.sendCommand("saveUndo");this.finded=null},isOnlyStyleChange:function(e){if(b){if(!this.finded||(this.finded.length&&this.finded.length!=1)){return false}else{if(this.finded.length){var d=this.finded[0]}else{var d=this.finded}var c=d.nodeName.toLowerCase().charAt(0);return this.isIndentedList(d)&&(e==c)}}return false},isIndentedList:function(d){var c=this.finder.getAncestors(d);if(c.length>=2){return true}else{return false}},setListStyle:function(c,g){es.Dom.setStyle(c,{listStyleType:g});for(var d=0,f=c.childNodes.length;d<f;d++){var e=c.childNodes[d];if(DomUtil.equalsNodeName(e,"li")){es.Dom.setStyle(e,{listStyleType:g})}}}});Object.extend(a.prototype,DialogUtil.prototype);es.plugin.ComplexListBtn=a})();(function(){var a=es.Class.create(es.editor.PluginBase,{layout_htmls:['<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="320" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="320" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout NHN_Layout" cellpadding="0" cellspacing="0" height="320" width="244"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout NHN_Layout" cellpadding="0" cellspacing="0" height="320" width="244"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout NHN_Layout" cellpadding="0" cellspacing="0" height="320" width="244"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="743"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="743"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" valign="top"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="158" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="320" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="320" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="158" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="157" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="319" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" valign="top"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="319" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" valign="top"><table class="NHN_Layout" valign="top" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="5"><br></td><td class="NHN_Layout_Preset" valign="top"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space" height="5"><br></td></tr><tr><td class="NHN_Layout_Preset" valign="top"><table class="Basicborder NHN_Layout" cellpadding="0" cellspacing="0" height="103" width="369"><tbody><tr><td style="padding: 5px; vertical-align: top;" class="NHN_Layout_Preset pcol2"><br></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="742"><tbody><tr><td class="NHN_Layout_Preset"><p style="margin: 0pt; padding: 0pt; color: rgb(0, 0, 0); font-size: 14px; font-family: Tahoma; font-weight: bold; text-align: right;">vol.<span style="color: rgb(255, 54, 54);">6</span></p></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table style="border-top: 3px solid rgb(255, 51, 0);" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><div style="position: relative; width: 100%;"><div style="position: absolute; width: 331px; height: 69px; background-color: rgb(255, 51, 0); top: 0pt; left: 0pt;"><h3 style="margin: 38px 0pt 0pt 18px; padding: 0pt; color: rgb(255, 255, 255); font-size: 16px; font-family: Dotum;">, <span style="color: rgb(255, 255, 0);"></span> </h3></div><div><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template1_1.jpg" alt="" style="display: block;" height="320" width="742"></div><div style="position: absolute; bottom: 0pt; right: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template1_blank.gif" alt="" height="23" width="400"></div></div></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Space" width="20"><br></td><td style="vertical-align: top; font-size: 0pt;" class="NHN_Layout_Preset" width="311"><table cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt; color: rgb(255, 51, 0); font-size: 18px; font-family: Verdana;">Let\'s Surf the Lonely Planet</h3><h4 style="margin: 0pt; padding: 7px 0pt 0pt; color: rgb(255, 51, 0); font-size: 12px; font-family: Dotum;">,   </h4><p class="pcol2" style="margin: 0pt; padding: 12px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.5;">   , <br>      <br>       <br>       . <br>,         <br>    . <br>  ,         . <br>   , </p></td></tr><tr><td style="height: 10px;" class="NHN_Layout_Space"><br></td></tr><tr><td class="NHN_Layout_Preset"><div><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template1_2.gif" alt="" style="display: block;" height="233" width="311"></div><p style="margin: 0pt; padding: 5px 10px 0pt 0pt; height: 17px; color: rgb(255, 255, 255); font-family: Dotum; font-size: 12px; text-align: right; background-color: rgb(255, 51, 0);">,  </p></td></tr><tr><td style="height: 12px;" class="NHN_Layout_Space"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.5;">     . <br>,     . <br>     , <br>  ,         , </p></td></tr><tr><td height="20"><br></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="19"><br></td><td style="height: 100%; vertical-align: top; font-size: 0pt;" class="NHN_Layout_Preset" width="392"><table style="height: 100%; table-layout: fixed;" class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Space" height="10"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="margin: 0pt; padding: 0pt 20px 0pt 0pt; color: rgb(136, 136, 136); font-size: 12px; font-family: Dotum;">,   </h4><p class="pcol2" style="margin: 0pt; padding: 12px 20px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.5;">     . <br>     . <br><span style="background-color: rgb(178, 178, 178); color: rgb(255, 255, 255);">       , <br>        2         .  </span><br>1    ,      .  <br>   ,            . <br>   , <br>      <br>       <br>       . </p></td></tr><tr><td class="NHN_Layout_Space" height="38"><br></td></tr><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt 20px 0pt 0pt; color: rgb(255, 51, 0); font-size: 18px; font-family: Verdana;">Let\'s Surf the Lonely Planet</h3><h4 style="margin: 0pt; padding: 7px 20px 0pt 0pt; color: rgb(255, 51, 0); font-size: 12px; font-family: Dotum;">,   </h4><p class="pcol2" style="margin: 0pt; padding: 9px 20px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.5;">     <br>   . <br>   , <br>     . <br>,     . <br>     ,   ,<br>        ,      . </p></td></tr><tr><td class="NHN_Layout_Space" height="31"><br></td></tr><tr><td style="vertical-align: bottom; font-size: 0pt; background-color: rgb(255, 51, 0);" class="NHN_Layout_Preset"><table style="background: rgb(255, 51, 0) url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template1_3.gif) no-repeat scroll right bottom; table-layout: fixed; width: 392px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="padding: 23px 23px 16px; vertical-align: top;" class="NHN_Layout_Preset"><p style="margin: 0pt; padding: 0pt 0pt 2px; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"><span style="padding-right: 7px; font-weight: bold;"> :</span>2007 1</p><p style="margin: 0pt; padding: 0pt 0pt 2px; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"><span style="padding-right: 7px; font-weight: bold;"> :</span> </p><p style="margin: 0pt; padding: 0pt 0pt 2px; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"><span style="padding-right: 7px; font-weight: bold;"> :</span></p><p style="margin: 0pt; padding: 0pt 0pt 2px; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"><span style="padding-right: 7px; font-weight: bold;"> :</span>Nikon</p><p style="margin: 0pt; padding: 0pt 0pt 2px; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"><span style="padding-right: 7px; font-weight: bold;"> :</span>, </p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="height: 3px; background-color: rgb(255, 51, 0);" class="NHN_Layout_Space"><br></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td class="NHN_Layout_Preset" style="" valign="top" width="231"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><div style="position: relative;"><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template2_1.jpg" alt="" style="display: block;" height="172" width="231"></p><div style="position: absolute; bottom: 0pt; left: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" height="17" width="23"><tbody><tr><td style="background-color: rgb(255, 51, 0); color: rgb(255, 255, 255); font-family: Tahoma; font-size: 10px; font-weight: bold; text-align: center; left: 0pt; bottom: 0pt;" class="NHN_Layout_Preset">01</td></tr></tbody></table></div></div></td></tr><tr><td class="NHN_Layout_Space" style="font-size: 0pt;" height="10"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><div style="position: relative;"><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template2_2.jpg" alt="" style="display: block;" height="308" width="231"></p><div style="position: absolute; bottom: 0pt; left: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" height="17" width="23"><tbody><tr><td style="background-color: rgb(255, 51, 0); color: rgb(255, 255, 255); font-family: Tahoma; font-size: 10px; font-weight: bold; text-align: center; left: 0pt; bottom: 0pt;" class="NHN_Layout_Preset">02</td></tr></tbody></table></div></div></td></tr><tr><td class="NHN_Layout_Space" height="10"><br></td></tr><tr><td class="NHN_Layout_Preset"><ol style="margin: 0pt; padding: 0pt 0pt 0pt 5px;"><li style="margin: 0pt; padding: 0pt; list-style-type: none; height: 18px; color: rgb(51, 51, 51); font-size: 11px; font-family: Dotum;"><strong style="color: rgb(255, 51, 0); font-size: 10px; font-family: Tahoma;">01</strong>  </li><li style="margin: 0pt; padding: 0pt; list-style-type: none; height: 18px; color: rgb(51, 51, 51); font-size: 11px; font-family: Dotum;"><strong style="color: rgb(255, 51, 0); font-size: 10px; font-family: Tahoma;">02</strong>   .</li><li style="margin: 0pt; padding: 0pt; list-style-type: none; height: 18px; color: rgb(51, 51, 51); font-size: 11px; font-family: Dotum;"><strong style="color: rgb(255, 51, 0); font-size: 10px; font-family: Tahoma;">03</strong>    .</li></ol></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="10"><br></td><td class="NHN_Layout_Preset" style="font-size: 0px;" valign="top" width="502"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><div style="position: relative;"><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template2_3.jpg" alt="" style="display: block;" height="376" width="502"></p><div style="position: absolute; bottom: 0pt; left: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" height="17" width="23"><tbody><tr><td style="background-color: rgb(255, 51, 0); color: rgb(255, 255, 255); font-family: Tahoma; font-size: 10px; font-weight: bold; text-align: center; left: 0pt; bottom: 0pt;" class="NHN_Layout_Preset">03</td></tr></tbody></table></div></div></td></tr><tr><td class="NHN_Layout_Space" height="10"><br></td></tr><tr><td class="NHN_Layout_Preset"><div class="pcol2" style="font-size: 12px; font-family: Dotum; line-height: 1.6;"><table style="border: 3px solid rgb(255, 56, 0); margin: 0pt 20px 15px 0pt; float: left;" class="NHN_Layout" cellpadding="0" cellspacing="0" width="165"><tbody><tr><td class="NHN_Layout_Preset" style="padding: 10px; color: rgb(255, 51, 0); font-family: Tahoma; font-weight: bold; font-size: 25px; line-height: 1;">Surf the<br>Lonely <br>Planet</td></tr><tr><td class="NHN_Layout_Preset" style="padding: 15px 0pt 0pt 13px; background-color: rgb(255, 56, 0); color: rgb(255, 255, 255); font-weight: bold; font-size: 17px; font-family: Tahoma;" height="48">2007</td></tr></tbody></table><span style="color: rgb(255, 102, 102);"><span style="line-height: 1.5;"><br></span>    ,                     . </span> ,             .   ,         .    ,      . ,     .     ,   ,         ,      .      .        ,         2  </div></td></tr><tr><td class="NHN_Layout_Space" height="35"><br></td></tr><tr><td class="NHN_Layout_Preset"><h3 style="border: 6px solid rgb(235, 235, 235); margin: 0pt; padding: 7px 10px; color: rgb(255, 56, 0); font-size: 15px; font-family: Dotum;">,   </h3><h4 style="border-left: 2px solid rgb(102, 102, 102); margin: 15px 0pt 10px 2px; padding: 2px 0pt 0pt 10px; color: rgb(102, 102, 102); font-size: 12px; font-family: Dotum; line-height: 1;">   </h4><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">   ,              <span style="color: rgb(255, 102, 102);">        . ,             .</span>   ,         .    ,      . ,     .      ,   ,         ,      .      .        ,        </p></td></tr><tr><td class="NHN_Layout_Space" height="35"><br></td></tr><tr><td class="NHN_Layout_Preset"><h3 style="border: 6px solid rgb(235, 235, 235); margin: 0pt; padding: 7px 10px; color: rgb(255, 56, 0); font-size: 15px; font-family: Dotum;">,   </h3><h4 style="border-left: 2px solid rgb(102, 102, 102); margin: 15px 0pt 10px 2px; padding: 2px 0pt 0pt 10px; color: rgb(102, 102, 102); font-size: 12px; font-family: Dotum; line-height: 1;">   </h4><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">   ,              <span style="color: rgb(255, 102, 102);">        . ,             .</span>   ,         .    ,      . ,     .      ,   ,         ,      .      .        ,        </p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0px;"><table style="background-color: rgb(255, 56, 0);" class="NHN_Layout" cellpadding="0" cellspacing="0" height="17" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="border-right: 2px solid rgb(0, 0, 0); padding: 0pt 7px 0pt 0pt; color: rgb(255, 255, 255); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: right;">2007 Copyright season2.</td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0px;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h1 style="margin: 0pt; padding: 0pt; font-size: 45px; font-family: Verdana;"><span style="color: rgb(0, 0, 0);">Lonely</span> <span style="color: rgb(255, 51, 0);">PLANET</span></h1></td></tr><tr><td class="NHN_Layout_Space" height="7"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0px;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><div style="position: relative;"><div><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template3_1.jpg" alt="" style="display: block;" height="359" width="743"></div><div style="position: absolute; width: 351px; background-color: rgb(114, 182, 66); bottom: 20px; right: 0pt;"><p style="margin: 0pt; padding: 17px 19px 11px; color: rgb(255, 255, 255); font-size: 11px; font-family: Dotum; line-height: 1.5;">      <br>      <br>       .</p></div></div></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="20"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0px;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="15"><br></td><td class="NHN_Layout_Preset" style="color: rgb(255, 51, 0); font-size: 50px; font-family: Gulim;" valign="top"></td><td class="NHN_Layout_Preset"><p style="margin: 0pt; padding: 0pt; color: rgb(255, 51, 0); font-size: 17px; font-weight: bold; font-family: Dotum;">Let\'s Surf the Lonely Planet </p><p style="margin: 0pt; padding: 7px 0pt 0pt; position: relative; color: rgb(62, 166, 192); font-size: 12px; font-family: Dotum; line-height: 1.5;">It\'s a big world. Let\'s Surf the Lonely Planet!<br>I want to be a connector between travellers. Let\'s Surf the Lonely Planet.<span style="position: absolute; color: rgb(255, 51, 0); font-size: 50px; font-family: Gulim; line-height: 1.2;"></span></p></td><td class="NHN_Layout_Space" width="20"><br></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="20"><br></td></tr><tr style="background-color: rgb(0, 0, 0);" height="3"><td class="NHN_Layout_Preset" style="font-size: 0pt;"><br></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0px;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Space" width="20"><br></td><td class="NHN_Layout_Preset" style="font-size: 0px;" valign="top" width="352"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt 0pt 8px; color: rgb(0, 0, 0); font-size: 15px; font-family: Dotum;">,   </h3><p style="margin: 0pt; padding: 0pt; color: rgb(255, 102, 102); font-size: 12px; font-family: Dotum; line-height: 1.5;">   , <br>      <br>       <br>       .</p><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.5;">,         <br>    . <br>  ,     <br>    . <br>   ,    <br> . <br>,     . <br>     , <br>  ,     <br>   ,     <br>. </p></td></tr><tr><td class="NHN_Layout_Space" height="10"><br></td></tr><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template3_2.jpg" alt="" style="display: block;" height="264" width="352"></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="20"><br></td><td class="NHN_Layout_Preset" style="font-size: 0px;" valign="top" width="330"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0px;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template3_3.jpg" alt="" style="display: block;" height="213" width="164"></td><td width="3"><br></td><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template3_4.jpg" alt="" style="display: block;" height="213" width="164"></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="20"><br></td></tr><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt 0pt 8px; color: rgb(0, 0, 0); font-size: 15px; font-family: Dotum;">,   </h3><p style="margin: 0pt; padding: 0pt; color: rgb(62, 166, 192); font-size: 12px; font-family: Dotum; line-height: 1.5;">     . <br>   <br>    , </p><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.5;">       <br>2      <br>   .  <br>1    , <br>     .  <br>   ,   <br>       <br>. </p></td></tr><tr><td class="NHN_Layout_Space" height="32"><br></td></tr><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template3_5.gif" alt="" style="display: block;" height="82" width="92"></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="20"><br></td></tr></tbody></table></td></tr></tbody></table>','<table width="743" cellspacing="0" cellpadding="0"class="NHN_Layout_Main" style="table-layout: fixed;" _moz_dirty=""><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table cellspacing="0" cellpadding="0" class="NHN_Layout"><tbody><tr><td width="247" style="vertical-align: top; font-size: 0pt;"class="NHN_Layout_Preset"><table cellspacing="0" cellpadding="0" class="NHN_Layout"><tbody><tr><td style="padding: 0pt 20px;" class="NHN_Layout_Preset"><h3 style="margin: 0pt 0pt 5px; padding: 0pt; color: rgb(255, 15, 117); font-size: 12px; font-family: Dotum;">01_LovelyRoyee</h3><p style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;"class="pcol2">       .</p></td></tr><tr><td height="25" class="NHN_Layout_Space"><br _moz_dirty=""type="_moz" /></td></tr></tbody></table></td><td width="1" style="background-color: rgb(255, 15, 117);"class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td width="247" style="font-size: 0pt;" class="NHN_Layout_Preset"><div style="position: relative;"><img width="246"height="184" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_1.jpg" /><div style="position: absolute; top: 0pt; left: 0pt;"><table width="23" height="17" cellspacing="0" cellpadding="0"class="NHN_Layout" style="background-color: rgb(255, 15, 117);"><tbody><tr><td class="NHN_Layout_Preset"style="color: rgb(255, 255, 255); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: center;">01</td></tr></tbody></table></div></div></td><td width="1" class="NHN_Layout_Space"><br _moz_dirty=""type="_moz" /></td><td width="247" class="NHN_Layout_Preset"style="vertical-align: bottom; font-size: 0pt;"><table cellspacing="0" cellpadding="0" class="NHN_Layout"style="width: 100%;"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt 20px 5px; padding: 0pt; color: rgb(255, 15, 117); font-size: 12px; font-family: Dotum;">03_LovelyRoyee</h3><p style="margin: 0pt 20px; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;"class="pcol2">       .</p></td></tr><tr><td height="25" class="NHN_Layout_Space"><br _moz_dirty=""type="_moz" /></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="background-color: rgb(255, 15, 117); font-size: 0pt;"class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><div style="position: relative;"><img width="246"height="184" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_2.jpg" /><div style="position: absolute; bottom: 0pt; left: 0pt;"><table width="23" height="17" cellspacing="0" cellpadding="0"class="NHN_Layout" style="background-color: rgb(255, 15, 117);"><tbody><tr><td class="NHN_Layout_Preset"style="color: rgb(255, 255, 255); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: center;">02</td></tr></tbody></table></div></div></td><td class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td class="NHN_Layout_Preset"><div style="position: relative;"><img width="247"height="184" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_7.jpg" /><p style="margin: 0pt; padding: 0pt; position: absolute; color: rgb(255, 255, 255); font-size: 24px; font-weight: bold; font-family: Tahoma; line-height: 1.2; top: 66px; left: 100px;">Lovely<br />Royee</p></div></td><td class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Preset"><div style="position: relative;"><img width="246"height="184" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_3.jpg" /><div style="position: absolute; top: 0pt; left: 0pt;"><table width="23" height="17" cellspacing="0" cellpadding="0"class="NHN_Layout" style="background-color: rgb(255, 15, 117);"><tbody><tr><td class="NHN_Layout_Preset"style="color: rgb(255, 255, 255); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: center;">03</td></tr></tbody></table></div></div></td></tr><tr><td style="font-size: 0pt; background-color: rgb(255, 15, 117);"class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td></tr><tr><td style="vertical-align: top; font-size: 0pt;"class="NHN_Layout_Preset"><table cellspacing="0" cellpadding="0" class="NHN_Layout"><tbody><tr><td height="25" class="NHN_Layout_Space"><br _moz_dirty=""type="_moz" /></td></tr><tr><td style="padding: 0pt 20px;" class="NHN_Layout_Preset"><h3 style="margin: 0pt 0pt 5px; padding: 0pt; color: rgb(255, 15, 117); font-size: 12px; font-family: Dotum;">02_LovelyRoyee</h3><p style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;"class="pcol2">       .</p></td></tr></tbody></table></td><td class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td style="font-size: 0pt; text-align: right;"class="NHN_Layout_Preset"><div style="position: relative;"><img width="246"height="184" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_4.jpg" /><div style="position: absolute; top: 0pt; right: 0pt;"><table width="23" height="17" cellspacing="0" cellpadding="0"class="NHN_Layout" style="background-color: rgb(255, 15, 117);"><tbody><tr><td class="NHN_Layout_Preset"style="color: rgb(255, 255, 255); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: center;">04</td></tr></tbody></table></div></div></td><td style="background-color: rgb(255, 15, 117);"class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td class="NHN_Layout_Preset"style="vertical-align: bottom; font-size: 0pt;"><table cellspacing="0" cellpadding="0" class="NHN_Layout"style="width: 100%;"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt 20px 5px; padding: 0pt; color: rgb(255, 15, 117); font-size: 12px; font-family: Dotum;">04_LovelyRoyee</h3><p style="margin: 0pt 20px; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;"class="pcol2">       .</p></td></tr><tr><td height="25" class="NHN_Layout_Space"><br _moz_dirty=""type="_moz" /></td></tr></tbody></table></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><div style="position: relative;"><img width="246"height="184" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_5.jpg" /><div style="position: absolute; top: 0pt; right: 0pt;"><table width="23" height="17" cellspacing="0" cellpadding="0"class="NHN_Layout" style="background-color: rgb(255, 15, 117);"><tbody><tr><td class="NHN_Layout_Preset"style="color: rgb(255, 255, 255); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: center;">05</td></tr></tbody></table></div></div></td><td class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td class="NHN_Layout_Preset"style="vertical-align: bottom; font-size: 0pt;"><table cellspacing="0" cellpadding="0" class="NHN_Layout"style="width: 100%;"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt 20px 5px; padding: 0pt; color: rgb(255, 15, 117); font-size: 12px; font-family: Dotum;">04_LovelyRoyee</h3><p style="margin: 0pt 20px; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;"class="pcol2">       .</p></td></tr><tr><td height="25" class="NHN_Layout_Space"><br _moz_dirty=""type="_moz" /></td></tr></tbody></table></td><td class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Preset"><div style="position: relative;"><img width="246"height="184" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_6.jpg" /><div style="position: absolute; top: 0pt; right: 0pt;"><table width="23" height="17" cellspacing="0" cellpadding="0"class="NHN_Layout" style="background-color: rgb(255, 15, 117);"><tbody><tr><td class="NHN_Layout_Preset"style="color: rgb(255, 255, 255); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: center;">06</td></tr></tbody></table></div></div></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="background-color: rgb(255, 15, 117); font-size: 0pt;"class="NHN_Layout_Space"><br _moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td><td style="font-size: 0pt;" class="NHN_Layout_Space"><br_moz_dirty="" type="_moz" /></td></tr></tbody></table></td></tr><tr><td height="40" class="NHN_Layout_Space"><br _moz_dirty=""type="_moz" /></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table cellspacing="0" cellpadding="0" class="NHN_Layout"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><img width="743" height="20" style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_box_t.gif" /></td></tr><tr><td style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_box_bg.gif) repeat-y scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; font-size: 0pt;"class="NHN_Layout_Preset"><table cellspacing="0" cellpadding="0" class="NHN_Layout"><tbody><tr><td width="190"style="font-family: Verdana; color: rgb(255, 255, 255); font-size: 37px; text-align: center; line-height: 0.9; font-weight: bold; letter-spacing: -1px;"class="NHN_Layout_Preset">Lovely<br />Royee</td><td class="NHN_Layout_Preset"><p style="margin: 0pt; padding: 0pt 35px; color: rgb(255, 219, 234); font-size: 12px; font-family: Dotum; line-height: 1.6; letter-spacing: -1px;">  ,         ,<br />     .     <br />.        ,   <br />     2         .</p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Preset"><img width="743" height="20"style="display: block;" alt=""src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template4_box_b.gif" /></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="492"><tbody><tr><td class="NHN_Layout_Preset"><div style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_bg_s.gif) repeat-x scroll 0pt 40px; text-align: right; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><h3 style="margin: 0pt; padding: 0pt; color: rgb(36, 184, 193); font-family: Verdana; font-size: 40px;">L<span style="color: rgb(255, 102, 102);">o</span>n<span style="color: rgb(102, 204, 153);">e</span>l<span style="color: rgb(102, 204, 153);">y</span> P<span style="color: rgb(255, 102, 102);">l</span>a<span style="color: rgb(102, 204, 153);">n</span>e<span style="color: rgb(204, 153, 102);">t.</span></h3><p style="margin: 0pt; padding: 0pt; color: rgb(36, 184, 193); font-size: 12px; font-family: Dotum; font-weight: bold;">,  .</p></div></td></tr><tr><td class="NHN_Layout_Space" height="40"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">     .      ,   ,         ,      . </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="20"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" width="492"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_1.jpg" alt="" style="display: block;" height="289" width="492"></td><td class="NHN_Layout_Space" width="19"><br></td><td class="NHN_Layout_Preset" valign="top" width="232"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h4 style="border-bottom: 1px solid rgb(36, 184, 193); margin: 5px 0pt 0pt; padding: 0pt 0pt 6px; color: rgb(36, 184, 193); font-size: 12px; font-family: Dotum;">   , </h4></td></tr><tr><td class="NHN_Layout_Space" height="6"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">     <br>    <br>  . </p></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" style="font-size: 0pt;" height="7"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" width="492"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_2.jpg" alt="" style="display: block;" height="289" width="492"></td><td class="NHN_Layout_Space" width="19"><br></td><td class="NHN_Layout_Preset" valign="top" width="232"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h4 style="border-bottom: 1px solid rgb(36, 184, 193); margin: 5px 0pt 0pt; padding: 0pt 0pt 6px; color: rgb(36, 184, 193); font-size: 12px; font-family: Dotum;">   , </h4></td></tr><tr><td class="NHN_Layout_Space" height="6"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">     <br>    <br>  . </p></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" style="font-size: 0pt;" height="7"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" width="492"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_3.jpg" alt="" style="display: block;" height="289" width="492"></td><td class="NHN_Layout_Space" width="19"><br></td><td class="NHN_Layout_Preset" valign="top" width="232"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h4 style="border-bottom: 1px solid rgb(36, 184, 193); margin: 5px 0pt 0pt; padding: 0pt 0pt 6px; color: rgb(36, 184, 193); font-size: 12px; font-family: Dotum;">   , </h4></td></tr><tr><td class="NHN_Layout_Space" height="6"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">     <br>    <br>  . </p></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="7"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="492"><tbody><tr><td class="NHN_Layout_Preset"><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_4.jpg" alt="" style="display: block;" height="181" width="241"></p><p style="margin: 0pt; padding: 6px 0pt 0pt; color: rgb(36, 184, 193); font-size: 11px; font-family: Dotum; text-align: right;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_dot_s.gif" alt="" style="margin: -2px 0pt 0pt; vertical-align: middle;" height="5" width="5">, </p></td><td class="NHN_Layout_Space" width="10"><br></td><td class="NHN_Layout_Preset"><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_5.jpg" alt="" style="display: block;" height="181" width="241"></p><p style="margin: 0pt; padding: 6px 0pt 0pt; color: rgb(36, 184, 193); font-size: 11px; font-family: Dotum; text-align: right;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_dot_s.gif" alt="" style="margin: -2px 0pt 0pt; vertical-align: middle;" height="5" width="5"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_dot_s.gif" alt="" style="margin: -2px 0pt 0pt; vertical-align: middle;" height="5" width="5">  </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Preset"><p style="margin: 0pt; padding: 0pt; text-align: right;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template5_6.gif" alt="" style="display: block;" height="150" width="150"></p></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 12px 0pt 0pt 15px; background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template6_bar.gif) no-repeat scroll 0%; color: rgb(0, 0, 0); font-size: 16px; font-family: Dotum; letter-spacing: -1px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">, <span style="color: rgb(254, 7, 15);"></span> .</h3></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="16"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset" valign="top" width="247"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template6_1.jpg" alt="" height="329" width="247"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="border-left: 1px solid rgb(102, 102, 102); padding-left: 10px;"><h4 style="margin: 0pt; padding: 0pt; color: rgb(102, 102, 102); font-size: 11px; font-family: Dotum;"> </h4></td></tr><tr><td style="border-left: 1px solid rgb(233, 233, 233); padding-left: 10px;"><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">   <br>   <br> .</p></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="1"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" valign="top" width="247"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template6_2.jpg" alt="" height="329" width="247"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="border-left: 1px solid rgb(102, 102, 102); padding-left: 10px;"><h4 style="margin: 0pt; padding: 0pt; color: rgb(102, 102, 102); font-size: 11px; font-family: Dotum;"> </h4></td></tr><tr><td style="border-left: 1px solid rgb(233, 233, 233); padding-left: 10px;"><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">   <br>   <br> .</p></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="1"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" valign="top" width="247"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template6_3.jpg" alt="" height="329" width="247"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="border-left: 1px solid rgb(102, 102, 102); padding-left: 10px;"><h4 style="margin: 0pt; padding: 0pt; color: rgb(102, 102, 102); font-size: 11px; font-family: Dotum;"> </h4></td></tr><tr><td style="border-left: 1px solid rgb(233, 233, 233); padding-left: 10px;"><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">   <br>   <br> .</p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset" valign="top" width="247"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template6_4.jpg" alt="" height="329" width="247"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="border-left: 1px solid rgb(102, 102, 102); padding-left: 10px;"><h4 style="margin: 0pt; padding: 0pt; color: rgb(102, 102, 102); font-size: 11px; font-family: Dotum;"> </h4></td></tr><tr><td style="border-left: 1px solid rgb(233, 233, 233); padding-left: 10px;"><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">   <br>   <br> .</p></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="1"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" valign="top" width="247"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template6_5.jpg" alt="" height="329" width="247"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="border-left: 1px solid rgb(102, 102, 102); padding-left: 10px;"><h4 style="margin: 0pt; padding: 0pt; color: rgb(102, 102, 102); font-size: 11px; font-family: Dotum;"> </h4></td></tr><tr><td style="border-left: 1px solid rgb(233, 233, 233); padding-left: 10px;"><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">   <br>   <br> .</p></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="1"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" valign="top" width="247"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template6_6.jpg" alt="" height="329" width="247"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="border-left: 1px solid rgb(102, 102, 102); padding-left: 10px;"><h4 style="margin: 0pt; padding: 0pt; color: rgb(102, 102, 102); font-size: 11px; font-family: Dotum;"> </h4></td></tr><tr><td style="border-left: 1px solid rgb(233, 233, 233); padding-left: 10px;"><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">   <br>   <br> .</p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table style="background-color: rgb(239, 239, 239);" class="NHN_Layout" cellpadding="0" cellspacing="0" height="17" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="498"><br></td><td class="NHN_Layout_Preset" style="border-right: 2px solid rgb(0, 0, 0); padding-right: 10px; background-color: rgb(255, 56, 0); color: rgb(255, 255, 255); font-size: 9px; font-family: Tahoma; font-weight: bold; text-align: right;" width="235">2007 Copyright season2.</td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" style="border-left: 3px solid rgb(243, 56, 122); background-color: rgb(0, 0, 0);" cellpadding="0" cellspacing="0" height="31" width="190"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 9px 19px 0pt 0pt; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum; text-align: right; letter-spacing: -1px;">,   </h3></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="30"><br></td><td class="NHN_Layout_Preset" style="vertical-align: top;" width="335"><p style="border: 4px solid rgb(0, 151, 178); margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template7_1.jpg" alt="" height="243" width="327"></p><p class="pcol2" style="border-bottom: 1px solid rgb(0, 151, 178); margin: 0pt; padding: 5px 0pt 4px 6px; font-size: 9px; font-family: Verdana;">Let\'s Surf the Lonely Planet </p></td><td class="NHN_Layout_Space" width="13"><br></td><td class="NHN_Layout_Preset" style="vertical-align: top;" width="335"><p style="border: 4px solid rgb(78, 160, 0); margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template7_2.jpg" alt="" height="243" width="327"></p><p class="pcol2" style="border-bottom: 1px solid rgb(78, 160, 0); margin: 0pt; padding: 5px 0pt 4px 6px; font-size: 9px; font-family: Verdana;">Let\'s Surf the Lonely Planet </p></td><td class="NHN_Layout_Space" width="30"><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="50"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" style="border-left: 3px solid rgb(243, 56, 122); background-color: rgb(0, 0, 0);" cellpadding="0" cellspacing="0" height="31" width="190"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 9px 19px 0pt 0pt; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum; text-align: right; letter-spacing: -1px;">,   </h3></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="30"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt; color: rgb(51, 51, 51); font-size: 14px; font-family: Dotum; text-decoration: underline;">,  .</h3></td></tr><tr><td class="NHN_Layout_Space" height="10"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;"><span style="color: rgb(0, 151, 178);">   ,                     .</span> ,             .   ,         . </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="vertical-align: top;" width="335"><p style="border: 4px solid rgb(0, 0, 0); margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template7_3.jpg" alt="" height="439" width="327"></p></td><td class="NHN_Layout_Space" width="16"><br></td><td class="NHN_Layout_Preset" style="vertical-align: top;" width="332"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Space" height="11"><br></td></tr><tr><td class="NHN_Layout_Preset"><div style="width: 121px; height: 17px; background-color: rgb(242, 242, 242);"><h4 style="border-right: 1px solid rgb(255, 255, 255); margin: 0pt; padding: 3px 7px 0pt; float: left; height: 17px; background-color: rgb(0, 151, 178); color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"></h4></div><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt 7px; font-size: 12px; font-family: Dotum; line-height: 1.4; letter-spacing: -1px;">   ,     <br>        <br>      .</p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><div style="width: 121px; height: 17px; background-color: rgb(242, 242, 242);"><h4 style="border-right: 1px solid rgb(255, 255, 255); margin: 0pt; padding: 3px 7px 0pt; float: left; height: 17px; background-color: rgb(78, 160, 0); color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"></h4></div><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt 7px; font-size: 12px; font-family: Dotum; line-height: 1.4; letter-spacing: -1px;"><span style="color: rgb(78, 160, 0);">,        </span>  <br>  .   ,   <br>     . <br>  ,      </p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><div style="width: 121px; height: 17px; background-color: rgb(242, 242, 242);"><h4 style="border-right: 1px solid rgb(255, 255, 255); margin: 0pt; padding: 3px 7px 0pt; float: left; height: 17px; background-color: rgb(0, 151, 178); color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"></h4></div><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt 7px; font-size: 12px; font-family: Dotum; line-height: 1.4; letter-spacing: -1px;">. ,     . <br>    ,   , </p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><div style="width: 121px; height: 17px; background-color: rgb(242, 242, 242);"><h4 style="border-right: 1px solid rgb(255, 255, 255); margin: 0pt; padding: 3px 7px 0pt; float: left; height: 17px; background-color: rgb(78, 160, 0); color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"></h4></div><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt 7px; font-size: 12px; font-family: Dotum; line-height: 1.4; letter-spacing: -1px;">      </p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><div style="width: 121px; height: 17px; background-color: rgb(242, 242, 242);"><h4 style="border-right: 1px solid rgb(255, 255, 255); margin: 0pt; padding: 3px 7px 0pt; float: left; height: 17px; background-color: rgb(243, 56, 122); color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;"></h4></div><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt 7px; font-size: 12px; font-family: Dotum; line-height: 1.4; letter-spacing: -1px;"><span style="color: rgb(243, 56, 122);"> ,    </span>  . </p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="30"><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="35"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="text-align: right;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template7_fin.gif" alt="" height="89" width="99"></td><td class="NHN_Layout_Space" width="30"><br></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><div style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_color_bg.gif) repeat-x scroll center bottom; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="padding-right: 1px;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_color1.gif" alt="" height="4" width="18"></td><td class="NHN_Layout_Preset" style="padding-right: 1px;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_color2.gif" alt="" height="4" width="18"></td><td class="NHN_Layout_Preset" style="padding-right: 1px;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_color3.gif" alt="" height="4" width="17"></td><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_color4.gif" alt="" height="4" width="17"></td></tr></tbody></table></div></td></tr><tr><td class="NHN_Layout_Space" height="10"><br></td></tr><tr><td style="font-size: 0pt; vertical-align: top;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="vertical-align: top; font-size: 0pt;" width="400"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><div style="position: relative;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_1.jpg" alt="" style="display: block;" height="400" width="400"><p style="margin: 0pt; padding: 0pt; position: absolute; top: 5px; left: 6px; color: rgb(0, 0, 0); font-size: 11px; font-family: Verdana; font-weight: bold;">01</p></div></td></tr><tr><td class="NHN_Layout_Preset"><div style="position: relative;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_2.jpg" alt="" style="display: block;" height="300" width="400"><p style="margin: 0pt; padding: 0pt; position: absolute; top: 5px; left: 6px; color: rgb(255, 255, 255); font-size: 11px; font-family: Verdana; font-weight: bold;">02</p></div></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" width="200"><div style="position: relative;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_3.jpg" alt="" style="display: block;" height="267" width="200"><p style="margin: 0pt; padding: 0pt; position: absolute; top: 5px; left: 6px; color: rgb(255, 255, 255); font-size: 11px; font-family: Verdana; font-weight: bold;">03</p></div></td><td class="NHN_Layout_Preset" width="200"><div style="position: relative;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_4.jpg" alt="" style="display: block;" height="267" width="200"><p style="margin: 0pt; padding: 0pt; position: absolute; top: 5px; left: 6px; color: rgb(255, 255, 255); font-size: 11px; font-family: Verdana; font-weight: bold;">04</p></div></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Preset" style="vertical-align: top;" width="343"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" style="background-color: rgb(204, 204, 204);" cellpadding="0" cellspacing="0" height="239" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="padding: 45px 0pt 0pt 28px; vertical-align: top;"><h3 style="margin: 0pt; padding: 0pt; color: rgb(255, 255, 0); font-size: 24px; font-family: Dotum;">,  .</h3><p style="margin: 0pt; padding: 8px 0pt 0pt; color: rgb(255, 255, 0); font-size: 12px; font-family: Dotum; font-weight: bold;">,   </p><p style="margin: 0pt; padding: 0pt; color: rgb(0, 153, 255); font-size: 10px; font-family: Tahoma; font-weight: bold;">2007.07</p><p style="margin: 0pt; padding: 5px 0pt 0pt; color: rgb(102, 102, 102); font-size: 9px; font-family: Tahoma; font-weight: bold;">http://blog.naver.com/season2episode2</p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="55"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_bar.gif) no-repeat scroll left 17px; padding-left: 30px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><strong style="color: rgb(0, 0, 0); font-size: 17px; font-family: Verdana;">01</strong><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;">   , <br>      <br>       <br>       . </p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_bar.gif) no-repeat scroll left 17px; padding-left: 30px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><strong style="color: rgb(0, 0, 0); font-size: 17px; font-family: Verdana;">02</strong><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;">,        <br>    . <br>  , <br>     <br>  . <br>   , <br>     . <br>,     . <br>     , <br>  ,    <br>    ,    <br> . </p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_bar.gif) no-repeat scroll left 17px; padding-left: 30px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><strong style="color: rgb(0, 0, 0); font-size: 17px; font-family: Verdana;">03</strong><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;">     . <br>      <br>,</p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_bar.gif) no-repeat scroll left 17px; padding-left: 30px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><strong style="color: rgb(0, 0, 0); font-size: 17px; font-family: Verdana;">04</strong><p class="pcol2" style="margin: 0pt; padding: 5px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;">       <br>2      <br>  . </p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="10"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><div style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_color_bg.gif) repeat-x scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="text-align: right; font-size: 0pt;"><table class="NHN_Layout" align="right" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="padding-right: 1px;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_down_color1.gif" alt="" height="3" width="17"></td><td class="NHN_Layout_Preset" style="padding-right: 1px;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_down_color2.gif" alt="" height="3" width="17"></td><td class="NHN_Layout_Preset" style="padding-right: 1px;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_down_color3.gif" alt="" height="3" width="18"></td><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_down_color4.gif" alt="" height="3" width="18"></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Preset" style="padding-top: 2px; font-size: 10px; font-weight: bold;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template8_bu.gif" alt="" align="absmiddle" height="14" width="15"> <span style="color: rgb(0, 180, 255); font-family: Verdana;">Written</span> <span style="color: rgb(0, 0, 0); font-family: Verdana;">by.</span> <span style="color: rgb(255, 0, 176); font-family: Verdana;">episode2.</span></td></tr></tbody></table></div></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template9_box_t.gif) no-repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; vertical-align: top;" height="37"><p style="margin: 0pt; padding: 22px 0pt 0pt 51px; color: rgb(33, 185, 204); font-size: 10px; font-family: Verdana; font-weight: bold;">01</p></td></tr><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template9_box_bg.gif) repeat-y scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: center; font-size: 0pt;"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><table style="border-bottom: 1px dashed rgb(204, 204, 204);" class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template9_1.jpg" alt="" height="335" width="500"></td></tr><tr><td class="NHN_Layout_Preset" style="padding: 4px 5px 4px 0pt; text-align: right; color: rgb(153, 153, 153); font-size: 9px; font-family: Tahoma; font-weight: bold;"><span style="padding-right: 9px; color: rgb(33, 185, 204);">episode2</span> 2007.07.07</td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="35"><br></td></tr><tr><td class="NHN_Layout_Preset" style="text-align: center;"><h3 style="margin: 0pt; padding: 0pt; color: rgb(33, 185, 204); font-size: 12px; font-family: Dotum;">,   </h3><p style="margin: 0pt; padding: 0pt; color: rgb(153, 153, 153); font-size: 12px; font-family: Dotum; line-height: 1.6;">   , <br>      <br>       <br>       . <br>,         <br>    . <br>  ,   <br>      . </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template9_box_b.gif) no-repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" height="37"><br></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_box_t.gif) no-repeat scroll 0%; font-size: 0pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" height="18"><br></td></tr><tr><td class="NHN_Layout_Preset" style="padding: 16px 0pt 8px; background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_box_bg.gif) repeat-y scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; text-align: center;"><h3 style="margin: 0pt; padding: 0pt; background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_line.gif) repeat-x scroll 0pt 22px; display: inline; color: rgb(0, 0, 0); font-size: 24px; font-family: Dotum; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">,  </h3><h4 style="margin: 0pt; padding: 4px 0pt 0pt; color: rgb(255, 0, 0); font-size: 12px; font-family: Dotum;">,   </h4></td></tr><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_box_b.gif) no-repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" height="18"><br></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="40"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="10"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="723"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="vertical-align: top;" width="354"><h4 style="margin: 0pt; padding: 0pt; color: rgb(255, 0, 0); font-size: 14px; font-family: Dotum;">   </h4><p style="margin: 0pt; padding: 8px 0pt 0pt; color: rgb(0, 0, 0); font-size: 12px; font-family: Dotum; font-weight: bold;"> </p><p class="pcol2" style="margin: 0pt; padding: 14px 0pt 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;">   ,      <br>        <br>      . , <br>          <br>.   , <span style="color: rgb(124, 125, 130); background-color: rgb(236, 236, 236);">   <br>    .  <br> ,      .<br>,     . </span></p><p style="border: 5px solid rgb(240, 240, 240); margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_1.jpg" alt="" height="256" width="344"></p></td><td class="NHN_Layout_Space" width="15"><br></td><td class="NHN_Layout_Preset" style="vertical-align: top;" width="354"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;">     ,   ,<br>       <br>,      . <br>    .  <br>     ,  <br>      2  <br>      . 1 <br>  ,     <br>.    ,   <br>       <br>. </p><p style="border: 5px solid rgb(240, 240, 240); margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_2.jpg" alt="" height="256" width="344"></p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="margin: 0pt; padding: 0pt; color: rgb(255, 0, 0); font-size: 12px; font-family: Dotum;">    <span style="color: rgb(0, 0, 0);"> </span></h4><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.4;">   ,       <span style="color: rgb(124, 125, 130); background-color: rgb(236, 236, 236);">        <br>     .</span> ,             . <br> ,         .    ,<br>     . ,     .      ,<br>  ,         ,     <br>.      .        ,<br>        2         . 1 <br>  ,      .    ,    <br>       . </p></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="10"><br></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="45"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_line2.gif) repeat-x scroll 0pt 24px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_line3.gif) no-repeat scroll 74px 24px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><h3 style="margin: 0pt; padding: 0pt; color: rgb(0, 0, 0); font-size: 24px; font-family: Verdana;">Must <span style="color: rgb(255, 0, 0);">See!</span></h3></td><td class="NHN_Layout_Preset" style="padding-right: 5px; text-align: right; font-size: 10px; font-family: Tahoma; font-weight: bold;">2007.5</td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="10"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="354"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" width="140"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_3.jpg" alt="" style="border: 5px solid rgb(240, 240, 240);" height="95" width="130"></td><td class="NHN_Layout_Space" width="10"><br></td><td class="NHN_Layout_Preset" style="padding-top: 9px; vertical-align: top;" width="204"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 11px; font-family: Dotum; font-weight: bold;">  </p><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">    <br>    ,  <br>    . </p></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="15"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="354"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" width="140"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_4.jpg" alt="" style="border: 5px solid rgb(240, 240, 240);" height="95" width="130"></td><td class="NHN_Layout_Space" width="10"><br></td><td class="NHN_Layout_Preset" style="padding-top: 9px; vertical-align: top;" width="204"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 11px; font-family: Dotum; font-weight: bold;">  </p><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">    <br>    ,  <br>    . </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="11"><br></td><td class="NHN_Layout_Space" height="11"><br></td><td class="NHN_Layout_Space" height="11"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="354"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" width="140"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_3.jpg" alt="" style="border: 5px solid rgb(240, 240, 240);" height="95" width="130"></td><td class="NHN_Layout_Space" style="font-size: 0pt;" width="10"><br></td><td class="NHN_Layout_Preset" style="padding-top: 9px; vertical-align: top;" width="204"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 11px; font-family: Dotum; font-weight: bold;">  </p><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">    <br>    ,  <br>    . </p></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="15"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="354"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" width="140"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template10_4.jpg" alt="" style="border: 5px solid rgb(240, 240, 240);" height="95" width="130"></td><td class="NHN_Layout_Space" style="font-size: 0pt;" width="10"><br></td><td class="NHN_Layout_Preset" style="padding-top: 9px; vertical-align: top;" width="204"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 11px; font-family: Dotum; font-weight: bold;">  </p><p class="pcol2" style="margin: 0pt; padding: 8px 0pt 0pt; font-size: 11px; font-family: Dotum; line-height: 1.4;">    <br>    ,  <br>    . </p></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="10"><br></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td class="NHN_Layout_Preset" style="vertical-align: top;" width="112"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template11_1.jpg" alt="" height="84" width="112"></td><td class="NHN_Layout_Space" width="20"><br></td><td class="NHN_Layout_Preset" style="vertical-align: top;" width="611"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt; color: rgb(51, 51, 51); font-size: 35px; font-family: Verdana; letter-spacing: -2px;">Let\'s Surf the Lonely Planet </h3><h4 style="margin: 0pt; padding: 10px 0pt 16px; color: rgb(221, 37, 18); font-size: 14px; font-family: Dotum;">,   </h4></td></tr><tr><td class="NHN_Layout_Space" height="20"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">   ,                     . ,             .   ,         .    ,      . ,     .      ,   ,         ,      .      . </p></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><h5 style="margin: 0pt; padding: 0pt; color: rgb(51, 51, 51); font-size: 12px; font-family: Dotum;"> ,    <span style="color: rgb(221, 37, 18);"> (2007.7)</span></h5><p style="margin: 0pt; padding: 9px 0pt 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template11_2.jpg" alt="" height="275" width="611"></p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="40"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h4 style="margin: 0pt; padding: 28px 0pt 0pt 26px; background: rgb(0, 0, 0) url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template11_bar.gif) no-repeat scroll left top; height: 26px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;">   . </h4></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset"><p class="pcol2" style="margin: 0pt; padding: 0pt; font-size: 12px; font-family: Dotum; line-height: 1.6;">       ,         2         . 1    ,      .    ,            . </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template11_line.gif) repeat-x scroll 0pt 7px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="color: rgb(102, 102, 102); font-size: 10px; font-family: Tahoma; font-weight: bold; text-align: right;"><span style="padding-left: 8px; background-color: rgb(255, 255, 255);">Fin.</span></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td class="NHN_Layout_Preset" style="vertical-align: top; font-size: 0pt;" width="360"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><div style="position: relative; width: 310px;"><p style="margin: 0pt; padding: 2px 3px; position: absolute; top: 0pt; left: 0pt; background-color: rgb(255, 51, 0); color: rgb(255, 255, 255); font-size: 9px; font-weight: bold; font-family: Tahoma;">01</p><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template12_1.jpg" alt="" style="display: block;" height="395" width="310"></p></div></td></tr><tr><td class="NHN_Layout_Space" style="font-size: 0pt;" height="1"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;" align="right"><div style="position: relative; width: 310px;"><p style="border: 1px solid red; margin: 0pt; padding: 2px 3px; position: absolute; top: 0pt; left: 0pt; background-color: rgb(255, 51, 0); color: rgb(255, 255, 255); font-size: 9px; font-weight: bold; font-family: Tahoma;">02</p><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template12_2.jpg" alt="" style="display: block;" height="395" width="310"></p></div></td></tr><tr><td class="NHN_Layout_Space" style="font-size: 0pt;" height="1"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><div style="position: relative; width: 310px;"><p style="margin: 0pt; padding: 2px 3px; position: absolute; top: 0pt; left: 0pt; background-color: rgb(255, 51, 0); color: rgb(255, 255, 255); font-size: 9px; font-weight: bold; font-family: Tahoma;">03</p><p style="margin: 0pt; padding: 0pt;"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template12_3.jpg" alt="" style="display: block;" height="395" width="310"></p></div></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="52"><br></td><td class="NHN_Layout_Preset" style="vertical-align: top;" width="331"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt; color: rgb(51, 153, 255); font-size: 35px; font-family: Verdana; letter-spacing: -1px;">Lonely Planet. </h3><p style="margin: 0pt; padding: 2px 9px; background-color: rgb(255, 51, 0); color: rgb(255, 255, 255); font-size: 9px; font-family: Tahoma; font-weight: bold;">Let\'s Surf the Lonely Planet.</p></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><h4 style="margin: 0pt; padding: 0pt; color: rgb(51, 153, 255); font-size: 12px; font-family: Dotum;"><span class="pcol2" style="font-size: 9px; font-family: Tahoma; vertical-align: top;">01</span> ,   </h4><p class="pcol2" style="margin: 0pt; padding: 6px 0pt 0pt 20px; font-size: 12px; font-family: Dotum; line-height: 1.4;">   , <br>      <br>       <br>       . </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="18"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" style="border-top: 1px dashed rgb(102, 102, 102);" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="margin: 0pt; padding: 0pt; color: rgb(51, 153, 255); font-size: 12px; font-family: Dotum;"><span class="pcol2" style="font-size: 9px; font-family: Tahoma; vertical-align: top;">02</span> ,   </h4><p class="pcol2" style="margin: 0pt; padding: 6px 0pt 0pt 20px; font-size: 12px; font-family: Dotum; line-height: 1.4;">,         <br>    . <br>  ,     <br>    . <br>   ,    <br>  . <br>,     . <br>     , <br>  ,    <br>    ,     <br> . <br>     . <br>       <br>,       <br> 2      <br>   .  </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="18"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" style="border-top: 1px dashed rgb(102, 102, 102);" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="margin: 0pt; padding: 0pt; color: rgb(51, 153, 255); font-size: 12px; font-family: Dotum;"><span class="pcol2" style="font-size: 9px; font-family: Tahoma; vertical-align: top;">03</span> ,   </h4><p class="pcol2" style="margin: 0pt; padding: 6px 0pt 0pt 20px; font-size: 12px; font-family: Dotum; line-height: 1.4;">1    ,      .     ,            . </p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="25"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template12_line.gif) repeat-x scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" style="background-color: rgb(255, 255, 255);" align="right" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="padding: 0pt 10px; color: rgb(51, 51, 51); font-size: 9px; font-family: Tahoma; font-weight: bold; vertical-align: top;">Photo By <span style="color: rgb(255, 51, 0);">episode2</span></td><td class="NHN_Layout_Space" style="width: 16px; height: 25px; background-color: rgb(255, 51, 0);"><br></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td class="NHN_Layout_Preset" style="vertical-align: top; font-size: 0pt;"><table class="NHN_Layout" style="background-color: rgb(0, 0, 0);" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset" style="padding: 48px 0pt 22px 32px;"><h3 style="margin: 0pt; padding: 0pt; color: rgb(255, 0, 153); font-size: 24px; font-family: Dotum;">, <span style="color: rgb(255, 179, 105);"></span> .</h3><h4 style="margin: 0pt; padding: 3px 0pt 0pt; color: rgb(255, 255, 255); font-size: 12px; font-family: Dotum;">,   </h4><p style="margin: 0pt; padding: 2px 0pt 0pt; color: rgb(102, 102, 102); font-size: 10px; font-family: Tahoma;">http://blog.naver.com/season2episode2/2007</p></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="370"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template13_1.jpg" alt="" height="281" width="370"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="border-left: 2px solid rgb(255, 0, 5); margin: 0pt; padding: 5px 0pt 0pt 9px; color: rgb(255, 0, 5); font-size: 12px; font-family: Dotum;">,   </h4><p class="pcol2" style="border-left: 2px solid rgb(60, 60, 60); margin: 0pt; padding: 8px 9px 0pt; font-size: 11px; font-family: Dotum;">   , <br>      <br>       <br>       . </p></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="3"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="370"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template13_2.jpg" alt="" height="281" width="370"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="border-left: 2px solid rgb(255, 0, 5); margin: 0pt; padding: 5px 0pt 0pt 9px; color: rgb(255, 0, 5); font-size: 12px; font-family: Dotum;">,   </h4><p class="pcol2" style="border-left: 2px solid rgb(60, 60, 60); margin: 0pt; padding: 8px 9px 0pt; font-size: 11px; font-family: Dotum;">   , <br>      <br>       <br>       . </p></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="35"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="370"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template13_3.jpg" alt="" height="281" width="370"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="border-left: 2px solid rgb(255, 0, 5); margin: 0pt; padding: 5px 0pt 0pt 9px; color: rgb(255, 0, 5); font-size: 12px; font-family: Dotum;">,   </h4><p class="pcol2" style="border-left: 2px solid rgb(60, 60, 60); margin: 0pt; padding: 8px 9px 0pt; font-size: 11px; font-family: Dotum;">   , <br>      <br>       <br>       . </p></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="3"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="370"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template13_4.jpg" alt="" height="281" width="370"></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset"><h4 style="border-left: 2px solid rgb(255, 0, 5); margin: 0pt; padding: 5px 0pt 0pt 9px; color: rgb(255, 0, 5); font-size: 12px; font-family: Dotum;">,   </h4><p class="pcol2" style="border-left: 2px solid rgb(60, 60, 60); margin: 0pt; padding: 8px 9px 0pt; font-size: 11px; font-family: Dotum;">   , <br>      <br>       <br>       . </p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="30"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" style="border-right: 2px solid rgb(255, 0, 5); width: 50px; height: 24px; background-color: rgb(0, 0, 0);" align="right" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="padding-left: 9px; color: rgb(255, 255, 255); font-size: 10px; font-weight: bold; font-family: Tahoma;">Fin.</td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="550"><tbody><tr><td class="NHN_Layout_Space" width="233"><br></td><td class="NHN_Layout_Preset" width="510"><table class="NHN_Layout" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template14_line.gif) repeat-x scroll 0pt top; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" height="20"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="10"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt; color: rgb(84, 83, 127); font-size: 12px; font-family: Dotum;"><span style="color: rgb(176, 144, 96); font-size: 20px; font-family: Tahoma;">Focus.</span> <span style="color: rgb(196, 68, 43);">,</span>  .</h3></td></tr><tr><td class="NHN_Layout_Space" height="13"><br></td></tr><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template14_1.jpg" alt="" height="325" width="500"></td></tr><tr><td class="NHN_Layout_Space" height="23"><br></td></tr><tr><td class="NHN_Layout_Preset pcol2" style="font-size: 11px; font-family: Dotum; line-height: 1.8;"><span style="color: rgb(255, 0, 5);">   , <br>      <br></span>       <br>       . </td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="8"><br></td></tr><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template14_bar.gif" alt="" height="1" width="34"></td></tr><tr><td class="NHN_Layout_Space" height="12"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="10"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset pcol2" style="font-size: 11px; font-family: Dotum; line-height: 1.8;">,             . <br>  ,         . <br>   ,      . <br>,     . <br>     , <br>  ,       <br>  ,      . </td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="8"><br></td></tr><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template14_bar.gif" alt="" height="1" width="34"></td></tr><tr><td class="NHN_Layout_Space" height="12"><br></td></tr><tr><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Space" width="10"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset pcol2" style="font-size: 11px; font-family: Dotum; line-height: 1.8;">     . <br>       , <br>        2         .  <br>1    ,      . <br>   ,            .  </td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td class="NHN_Layout_Space" height="40"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template14_signbox.gif) no-repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" align="right" cellpadding="0" cellspacing="0" height="61" width="141"><tbody><tr><td class="NHN_Layout_Preset" style="padding: 15px 13px 0pt 0pt; color: rgb(255, 51, 0); font-size: 9px; font-family: Tahoma; text-align: right; font-weight: bold;">episode2<br>20070707</td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>','<table style="table-layout: fixed;" class="NHN_Layout_Main" cellpadding="0" cellspacing="0" width="743"><tbody><tr><td class="NHN_Layout_Space" width="152"><br></td><td style="font-size: 0pt;" class="NHN_Layout_Preset" width="440"><table class="NHN_Layout" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset"><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template15_line.gif" alt="" height="24" width="440"></td></tr><tr><td class="NHN_Layout_Space" height="9"><br></td></tr><tr><td class="NHN_Layout_Preset" style="font-size: 0pt;"><div style="position: relative;"><p style="margin: 0pt; padding: 0pt; position: absolute; color: rgb(255, 255, 255); font-family: Tahoma; font-size: 9px; font-weight: bold; top: 6px; left: 10px;">01</p><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template15_1.jpg" alt="" style="display: block;" height="265" width="440"></div></td></tr><tr><td class="NHN_Layout_Space" style="font-size: 0pt;" height="1"><br></td></tr><tr><td class="NHN_Layout_Preset"><div style="position: relative;"><p style="margin: 0pt; padding: 0pt; position: absolute; color: rgb(255, 255, 255); font-family: Tahoma; font-size: 9px; font-weight: bold; top: 6px; left: 10px;">02</p><img src="http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template15_2.jpg" alt="" style="display: block;" height="265" width="440"></div></td></tr><tr><td class="NHN_Layout_Preset"><ol style="margin: 0pt; padding: 7px 0pt 0pt 4px;"><li style="margin: 0pt; padding: 0pt; list-style-type: none; color: rgb(255, 51, 0); font-size: 11px; font-family: Dotum;"><span style="padding-right: 11px; color: rgb(51, 102, 153); font-size: 9px; font-family: Tahoma; font-weight: bold;">01</span> </li><li style="margin: 0pt; padding: 0pt; list-style-type: none; color: rgb(255, 51, 0); font-size: 11px; font-family: Dotum;"><span style="padding-right: 11px; color: rgb(51, 102, 153); font-size: 9px; font-family: Tahoma; font-weight: bold;">02</span>  </li></ol></td></tr><tr><td class="NHN_Layout_Space" height="8"><br></td></tr><tr><td class="NHN_Layout_Preset" style="overflow: hidden; font-size: 0pt; height: 1px; background-color: rgb(234, 234, 234);"><br></td></tr><tr><td class="NHN_Layout_Space" height="15"><br></td></tr><tr><td class="NHN_Layout_Preset"><h3 style="margin: 0pt; padding: 0pt; color: rgb(51, 102, 153); font-size: 11px; font-family: Dotum;">   , </h3><p style="margin: 0pt; padding: 2px 0pt 0pt; color: rgb(161, 178, 201); font-size: 11px; font-family: Dotum; line-height: 1.6;">      <br>       <br>       . <br>,             . </p></td></tr><tr><td class="NHN_Layout_Space" height="7"><br></td></tr><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" style="background: transparent url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template15_line2.gif) repeat-x scroll 0pt 6px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td class="NHN_Layout_Preset"><table class="NHN_Layout" style="background: rgb(255, 255, 255) url(http://blogimgs.naver.com/nblog/mylog/post/layout/tmp/img_template15_parenthesis.gif) no-repeat scroll 0pt 2px; height: 13px; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" align="right" cellpadding="0" cellspacing="0"><tbody><tr><td class="NHN_Layout_Preset" style="padding-left: 14px; color: rgb(255, 0, 0); font-size: 9px; font-family: Tahoma; font-weight: bold;">episode2</td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td><td class="NHN_Layout_Space" width="151"><br></td></tr></tbody></table>'],initialize:function($super){this._version="1.0";this._name="plugin.LayoutInsertBtn";this._description="Insert Layout which consisted by table tag  in Editor.";$super()},initUI:function(){es.Event.observe(this.elements.LayoutInsert,"click",this.onCmdClick.bindAsEventListener(this));this.okButton=this.elements.layout_insert_dialog_ok;this.cancelButton=this.elements.layout_insert_dialog_cancel;es.Event.observe(this.okButton,"click",this.onOk.bindAsEventListener(this));es.Event.observe(this.cancelButton,"click",this.onCancel.bindAsEventListener(this));this.dialog=this.elements.LayoutInsertDlg;this.select=this.elements.layout_select_list;this.initDialog()},onCmdClick:function(b){es.Event.stop(b);var c=this.sendCommand("getSelection");this.toggleDialog(c)},clearInput:function(){this.select.selectedIndex=0},onOk:function(){var b=this.select.selectedIndex;this.sendCommand("setFocus");if(b!=0){var c=this.layout_htmls[b-1];this.sendCommand("insertHTML",c);this.sendCommand("saveUndo")}this.hideDialog()},onCancel:function(){this.hideDialog()}});Object.extend(a.prototype,DialogUtil.prototype);es.plugin.LayoutInsertBtn=a})();es.plugin.CSSUnderlineBtn=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.CSSUnderlineBtn";this._description="Editor Toolbar CSS Underline Button Plugin";$super()},initUI:function(){this.dialog=this.elements.CSSUnderlineDlg;es.Event.observe(this.elements.CSSUnderline,"click",this.onCmdClick.bindAsEventListener(this));this.initDialog();for(var a=1;a<=7;a++){es.Event.observe(this.elements["underline_"+a],"click",this.onUnderlineClick.bindAsEventListener(this))}for(var a=1;a<=6;a++){es.Event.observe(this.elements["color_"+a],"click",this.onColorClick.bindAsEventListener(this))}this.setBorderStyle(this.getHrElement(this.elements.underline_1));this.setBorderColor(this.elements.color_1);es.Event.observe(this.elements.CSSUnderline_Ok,"click",this.onOk.bindAsEventListener(this));es.Event.observe(this.elements.CSSUnderline_Cancel,"click",this.onCancel.bindAsEventListener(this))},getHrElement:function(a){if(!DomUtil.equalsNodeName(a,"hr")){a=a.getElementsByTagName("hr")[0]}return a},onUnderlineClick:function(b){es.Event.stop(b);var a=this.getHrElement(es.Event.element(b));this.setBorderStyle(a)},setBorderStyle:function(a){if(this.selectedUnderlineElement){this.selectedUnderlineElement.className=""}a.parentNode.className="select";this.selectedUnderlineElement=a.parentNode;this.borderWidth=a.getAttribute("borderWidth");this.borderStyle=a.getAttribute("borderStyle")},onColorClick:function(b){es.Event.stop(b);var a=es.Event.element(b);this.setBorderColor(a)},setBorderColor:function(b){if(this.selectedColorElement){this.selectedColorElement.className=""}b.className="select";this.selectedColorElement=b;this.borderColor=b.firstChild.nodeValue;for(var a=1;a<=6;a++){this.elements["underline_hr_"+a].style.borderColor=this.borderColor}},onCmdClick:function(d){es.Event.stop(d);var c=this.sendCommand("getSelection");var b=es.Event.element(d);var e=es.Dom.getPosition(b);var a=es.Dom.getSize(b);this.toggleDialog(null,e.left,e.top+a.height)},onOk:function(){this.sendCommand("setRangeStyles",{"border-bottom-style":this.borderStyle,"border-bottom-width":this.borderWidth,"border-bottom-color":(this.borderStyle!="")?this.borderColor:""});this.sendCommand("saveUndo");this.hideDialog()},onCancel:function(){this.hideDialog()}});Object.extend(es.plugin.CSSUnderlineBtn.prototype,DialogUtil.prototype);es.plugin.LineHeightBtn=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.LineHeightBtn";this._description="Editor Toolbar Line Height Button Plugin";$super()},initUI:function(){this.dialog=this.elements.LineHeight_layer;this.initDialog();var c=this.dialog.id;for(var a=0;;a++){var b=es.$(c+"_"+a);if(!b){break}es.Event.observe(b,"click",this.onChangeLineHeight.bindAsEventListener(this))}es.Event.observe(this.elements.LineHeight,"click",this.onClickBtn.bindAsEventListener(this))},onClickBtn:function(a){var d=this.sendCommand("getSelection");var c=es.Event.element(a);var e=es.Dom.getPosition(c);var b=es.Dom.getSize(c);this.toggleDialog(d,e.left,e.top+b.height);es.Event.stop(a)},onChangeLineHeight:function(a){var b=es.Event.element(a).getAttribute("value");es.Event.stop(a);this.sendCommand("setRangeLineStyles",{"line-height":b});this.sendCommand("saveUndo");this.hideDialog()}});Object.extend(es.plugin.LineHeightBtn.prototype,DialogUtil.prototype);es.plugin.MoreLessBtn=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.MoreLessBtn";this._description="Editor Toolbar more and less Button Plugin";$super()},initUI:function(){this.listener=this.onClickMoreLess.bindAsEventListener(this);es.Event.observe(this.elements.MoreLess,"click",this.onClickMoreLess.bindAsEventListener(this));if(es.Browser.Gecko){this.sendCommand("getDocument").execCommand("enableInlineTableEditing",false,"false")}},onClickMoreLess:function(a){es.Event.stop(a);var c=Util.getRandID();var b=this.getEditorHtml(c);this.sendCommand("setFocus");this.sendCommand("insertHTML",b);this.sendCommand("saveUndo")},DEFAULT_MSG_TEXT:"",DEFAULT_CONTENTS_TEXT:"  ",MORE_LESS_DIV_NAME:"espresso_moreLessDiv",PRIFIX_MORE_LESS_OUTER:"espresso_moreLessOuter_",PRIFIX_MORE_LESS_TABLE:"espresso_moreLessTable_",PRIFIX_MORE_LESS_MSG_:"espresso_moreLessMsg_",PRIFIX_MORE_LESS_CONTENTS_:"espresso_moreLessContents_",TABLE_CLASSNAME:"espresso_more_less_table",OUTER_CLASSNAME:"espresso_more_less_outer",MSG_CLASSNAME:"espresso_moreLess_msg",CONTENTS_CLASSNAME:"espresso_moreLess_contents",ARROW_UP:"",ARROW_DOWN:"",onCmdConvertMoreLessViewToEditor:function(){var h=this.sendCommand("getDocument");var g=DomUtil.getElementsByName(h,this.MORE_LESS_DIV_NAME,"div");var c,f;var d,e,b,a;for(c=0;c<g.length;c++){d=g[c];f=d.getAttribute("id").substring(this.PRIFIX_MORE_LESS_OUTER.length);e=h.getElementById(this.PRIFIX_MORE_LESS_TABLE+f);d.parentNode.insertBefore(e,d);d.parentNode.removeChild(d);b=h.getElementById(this.PRIFIX_MORE_LESS_MSG_+f);a=h.getElementById(this.PRIFIX_MORE_LESS_CONTENTS_+f);b.className=this.MSG_CLASSNAME;a.className=this.CONTENTS_CLASSNAME}},getEditorHtml:function(c,b,a){if(!b){b=this.DEFAULT_MSG_TEXT}if(!a){a=this.DEFAULT_CONTENTS_TEXT}var d=this.sendCommand("getDocument");return'<br/><table width="98%" class="'+this.TABLE_CLASSNAME+'"><tr><td unSelectable="on" class="fold_title" style="width:122px;-moz-user-select: none;font-family:,Arial;font-size:9pt;">/   :</td><td class="'+this.MSG_CLASSNAME+'" style="font-size:9pt;font-family:,Arial;color:#ff7100;">'+((es.Browser.IE)?'<span style="font-size:9pt;font-family:,Arial;color:#ff7100;"><u>'+b+"</u></span></td>":'<span style="font-size:9pt;font-family:,Arial;color:#ff7100;text-decoration:underline;">'+b+"</span></td>")+'</tr><tr><td colspan="2" class="'+this.CONTENTS_CLASSNAME+'" style="font-size:9pt;font-family:,Arial;color:#646464;"><span style="font-size:9pt;font-family:,Arial;color:#646464;">'+a+"</span></td></tr></table><br/>"},onCmdCheckMoreLessControl:function(b){var a=es.Dom.getElementsByClassName(this.TABLE_CLASSNAME,b);this.checkMoreLessControls(b,a);a.each(function(c){c.removeAttribute("checked")})},checkMoreLessControls:function(e,d){var a,c,b;for(a=0;a<d.length;a++){c=d[a];b=es.Dom.getElementsByClassName(this.TABLE_CLASSNAME,c);if(b.length>0){this.checkMoreLessControls(e,b)}this.checkMoreLessControl(e,c)}},checkMoreLessControl:function(f,e){if(e.getAttribute("checked")){return}var b=es.Dom.getElementsByClassName(this.MSG_CLASSNAME,e);var a=es.Dom.getElementsByClassName(this.CONTENTS_CLASSNAME,e);var d,c;if(b.length==1&&a.length==1){d=Util.getRandID();c=f.createElement("div");c.setAttribute("name",this.MORE_LESS_DIV_NAME);c.id=this.PRIFIX_MORE_LESS_OUTER+d;e.id=this.PRIFIX_MORE_LESS_TABLE+d;b[0].id=this.PRIFIX_MORE_LESS_MSG_+d;a[0].id=this.PRIFIX_MORE_LESS_CONTENTS_+d;b[0].className="";a[0].className="";e.parentNode.insertBefore(c,e);c.appendChild(e)}e.setAttribute("checked","true")},removeControlInfo:function(b,a,d){if(b){this.removeControlAttribute(b)}if(a){this.removeControlAttribute(a);var c=a.parentNode;if(c&&c.className=="fold_title"){c.className=""}}if(d){this.removeControlAttribute(d)}},removeControlAttribute:function(a){a.removeAttribute("id");a.removeAttribute("name");a.className=""},onCmdConvertEditorToView:function(){var e=this.sendCommand("getDocument");var d=DomUtil.getElementsByName(e,this.MORE_LESS_DIV_NAME,"div");var a;var b;var c;for(a=0;a<d.length;a++){b=d[a];c=b.getAttribute("id").substring(this.PRIFIX_MORE_LESS_OUTER.length);es.Dom.addClassName(b,this.OUTER_CLASSNAME);b.innerHTML=this.getViewHtml(c,e.getElementById(this.PRIFIX_MORE_LESS_MSG_+c).innerHTML,this.getMoreLessContents(b,c))}},getViewHtml:function(c,b,a){return'<span id="'+this.PRIFIX_MORE_LESS_MSG_+c+'" style="cursor:pointer;text-decoration:underline;" onClick="toggleMoreLess(this.id);">'+b+ARROW_DOWN+'</span><div id="'+this.PRIFIX_MORE_LESS_CONTENTS_+c+'">'+a+"</div>"},getMoreLessContents:function(e,c){var d="";var b=e.getElementsByTagName("div");for(var a=0;a<b.length;a++){if(b[a].className=="fold_cont"){d+=b[a].innerHTML}}return d}});es.filter.UndoStack=es.Class.create(es.editor.FilterBase,{_stackLimit:50,_baseContent:"",_baseObject:null,initialize:function($super){this._version="1.0";this._name="filter.undoStack";this._description="push data on undo stack";this._baseContent=(es.Browser.IE)?"<P></P>":"<br />";$super()},moduleInit:function(a){if(Object.isNumber(a)){this._stackLimit=a}},onCmdSetBaseContent:function(a){this._baseContent=a},onCmdSetBaseObject:function(a){this._baseObject=a},onCmdGetUndoStackCount:function(){return this.editor._undoIndex},onCmdPush:function(d){if(!this.sendCommand("getContentsInitialized")){return d}if(!this.editor._undoStack){this.editor._undoStack=[this._baseContent];this.editor._undoIndex=0}var e=this.sendCommand("getDocument");var b=e.body.innerHTML;this.sendCommand("syncAttach");if(d=="fromUndo"){var c=this.editor._undoStack[this.editor._undoIndex];if(b!=c){this.editor._undoStack.length=this.editor._undoIndex+1;this.push(true)}}else{var a=this.editor._undoStack.last();if(this.editor._undoIndex<this.editor._undoStack.length-1){this.editor._undoStack.length=this.editor._undoIndex+1}if(d=="force"||b!=a){this.push()}}if(this.editor._undoStack.length>this._stackLimit){this.editor._undoStack.shift();this.editor._undoIndex--}this.debug();return d},onCmdPushObject:function(b,a){if(!this.editor._undoObjectStack){this.editor._undoObjectStack=[this._baseObject];this.editor._undoObjectIndex=0}if(this.editor._undoObjectIndex<this.editor._undoObjectStack.length-1){this.editor._undoObjectStack.length=this.editor._undoObjectIndex+1}if(a!=true){if(this.editor._undoObjectIndex<this.editor._undoObjectStack.length-1){this.editor._undoObjectStack.length=this.editor._undoObjectIndex+1}}else{this.editor._undoObjectStack.length=this.editor._undoObjectIndex+1;this.editor._undoObjectIndex--}this.editor._undoObjectStack.push(b);this.editor._undoObjectIndex++;if(this.editor._undoObjectStack.length>this._stackLimit){this.editor._undoObjectStack.shift();this.editor._undoObjectIndex--}return b},onCmdUndoObject:function(a){if(!this.editor._undoObjectStack){return null}if(AttachUtil){AttachUtil.undoList()}if(this.editor._undoObjectIndex==this.editor._undoObjectStack.length-1){this.onCmdPushObject(a,true)}this.editor._undoObjectIndex--;if(this.editor._undoObjectIndex<0){this.editor._undoObjectIndex=0}a=this.editor._undoObjectStack[this.editor._undoObjectIndex];return a},onCmdRedoObject:function(a){if(!this.editor._undoObjectStack){return null}if(AttachUtil){AttachUtil.redoList()}this.editor._undoObjectIndex++;if(this.editor._undoObjectIndex>=this.editor._undoObjectStack.length){this.editor._undoObjectIndex=this.editor._undoObjectStack.length-1}a=this.editor._undoObjectStack[this.editor._undoObjectIndex];return a},onCmdDebug:function(){this.debug()},push:function(a){try{this.editor._undoStack.push(this.sendCommand("getDocument").body.innerHTML);this.editor._undoIndex++;if(a!=true){if(AttachUtil){AttachUtil.pushList(this._stackLimit)}this.sendCommand("notifyUndoStackPush",this._stackLimit)}}catch(b){var c=es.$("dbg");if(c){es.$("dbg").innerHTML=b}}},release:function(){if(this.editor._undoStack){this.editor._undoStack=null}},debug:function(){var c=es.$("dbg");if(c){var b=this.editor._undoIndex+" / "+this.editor._undoStack.length+"<br/>";for(var a=this.editor._undoStack.length-1;a>=0;a--){if(a==this.editor._undoIndex){b+='<span style="width:50px;">O</span>'}else{b+='<span style="width:50px;">&nbsp;</span>'}if(this.editor._undoStack[a]){b+=a+" <span>"+this.editor._undoStack[a].escapeHTML()+"</span><br/>"}}c.innerHTML=b}}});es.component.AttachToolbar=es.Class.create(es.editor.ComponentBase,{initialize:function($super){this._version="1.0";this._name="component.AttachToolbar";this._description="Editor Attach Toolbar component";$super()},initUI:function(){}});es.component.AttachList=es.Class.create(es.editor.ComponentBase,{ImageLICnt:0,FileLICnt:0,ImageAttachCnt:0,FileAttachCnt:0,MinImgCnt:0,CurImgCnt:0,setting:null,initialize:function($super){this._version="1.0";this._name="component.AttachList";this._description="Editor Attach List view component";$super()},initUI:function(){this.setting=this.getParameter("attach_list_setting");var c=es.Dom.getWidth(this.elements.attach_list_wrap);var b=Math.floor((c-35)/60);for(var a=0;a<b;a++){this.addImageLI("",a)}this.CurImgCnt=this.MinImgCnt=b},getTotalAttachSize:function(){return AttachUtil.popupCommonStorage.totalAttachSize},addImageLI:function(i,c){var f=es.$("espresso_attach_image_li"+c);if(f){f.innerHTML=i}else{var d=es.Dom.getHeight(this.elements.image_list);var a=document.createElement("li");a.id="espresso_attach_image_li"+this.ImageLICnt;a.innerHTML=i?i:"";this.elements.image_list.appendChild(a);this.ImageLICnt++;this.CurImgCnt++;var b=es.Dom.getHeight(this.elements.image_list);if(d!=b){var g=parent.document.getElementById("mainFrame");if(g){var e=es.Dom.getHeight(g);e+=(d==0?50:60);es.Dom.setHeight(g,e)}}}},addFileLI:function(g,c){var a=document.createElement("li");a.id="espresso_attach_file_li"+this.FileLICnt;a.innerHTML=g?g:"";var d=es.Dom.getHeight(this.elements.file_list);this.elements.file_list.appendChild(a);this.FileLICnt++;var b=es.Dom.getHeight(this.elements.file_list);if(d!=b){var f=parent.document.getElementById("mainFrame");if(f){var e=es.Dom.getHeight(f);e+=(b-d);es.Dom.setHeight(f,e)}}},deleteImageLI:function(a){this.elements.image_list.removeChild(a);this.CurImgCnt--;if(this.CurImgCnt<this.MinImgCnt){this.addImageLI("",this.ImageLICnt)}},deleteFileLI:function(a){this.elements.file_list.removeChild(a)},getListData:function(){var a={image_list:this.elements.image_list.innerHTML,file_list:this.elements.file_list.innerHTML,ImageLICnt:this.ImageLICnt,FileLICnt:this.FileLICnt,ImageAttachCnt:this.ImageAttachCnt,FileAttachCnt:this.FileAttachCnt,MinImgCnt:this.MinImgCnt,CurImgCnt:this.CurImgCnt};return a},setListData:function(g){if(g){this.elements.image_list.innerHTML=g.image_list;this.elements.file_list.innerHTML=g.file_list;this.ImageLICnt=g.ImageLICnt;this.FileLICnt=g.FileLICnt;this.ImageAttachCnt=g.ImageAttachCnt;this.FileAttachCnt=g.FileAttachCnt;this.MinImgCnt=g.MinImgCnt;this.CurImgCnt=g.CurImgCnt;var h,b,f;var c=this.elements.image_list.getElementsByTagName("li");for(var e=0;e<c.length;e++){h=c[e].firstChild;if(h){b=h.firstChild;es.Event.observe(h,"click",this.onClickInsertAttach.bindAsEventListener(this));es.Event.observe(b,"click",this.onClickDeleteAttach.bindAsEventListener(this))}}var c=this.elements.file_list.getElementsByTagName("a");for(var e=0;e<c.length;e++){var d=c[e].id.split("_");if(d[0]=="delete"){es.Event.observe(c[e],"click",this.onClickDeleteAttach.bindAsEventListener(this))}else{es.Event.observe(c[e],"click",this.onClickInsertAttach.bindAsEventListener(this))}}}},onCmdLoadComplete:function(){this.sendCommand("setBaseObject",this.getListData())},onCmdAddImageAttach:function(e){var f="delete_img_"+e.type+"_"+e.id;var b="insert_img_"+e.type+"_"+e.id;var c='<div id="'+b+'" class="delete_img" style="cursor:pointer;display:none;" onmouseout="this.style.display=\'none\';"><a href="javascript:;" id="'+f+'"><img src="'+this.setting.resource_url+'/ico_del_thumb.gif" title="" alt="" /></a></div>';var d=(e.size>0)?(e.filename+"("+Math.ceil(e.size/1024)+"KB)"):e.filename;c+='<img src="'+e.thumbnail+'" alt="'+d+'" style="width:48px;height:48px;" onmouseover="document.getElementById(\''+b+"').style.display='block';\"/>";var a=this.addImageLI(c,this.ImageAttachCnt);es.Event.observe(es.$(f),"click",this.onClickDeleteAttach.bindAsEventListener(this));es.Event.observe(es.$(b),"click",this.onClickInsertAttach.bindAsEventListener(this));this.sendCommand("setSize",{cur:this.getTotalAttachSize(),max:AttachUtil.maxAttachSize});this.ImageAttachCnt++},onCmdAddFileAttach:function(f){var e="";var b="delete_file_"+f.type+"_"+f.id;var h="insert_img_"+f.type+"_"+f.id;var i="insert_btnimg_"+f.type+"_"+f.id;if(f.insertFromList==true&&f.view_html){e=' <a href="javascript:;" id="'+h+'"><img id="'+i+'" src="'+this.setting.resource_url+'/ico_insert.gif" title=" " alt=" " /></a>'}var c=16;if(f.postfix&&f.postfix.length>0){c-=f.postfix.length}var a=unescape(f.filename).stripTags().truncateByByte(c,"euc-kr","...");if(f.postfix&&f.postfix.length>0){a+=f.postfix}var j=(f.size>0)?(' <span class="fileSize">'+Math.ceil(f.size/1024)+"KB</span>"):"";var g=f.prefix+a+j+e+' <a href="javascript:;" id="'+b+'"><img src="'+this.setting.resource_url+'/btn_del.gif" title="" alt="" /></a>';this.addFileLI(g,this.FileAttachCnt);es.Event.observe(es.$(b),"click",this.onClickDeleteAttach.bindAsEventListener(this));var d=es.$(h);if(d){es.Event.observe(d,"click",this.onClickInsertAttach.bindAsEventListener(this))}this.sendCommand("setSize",{cur:this.getTotalAttachSize(),max:AttachUtil.maxAttachSize});this.FileAttachCnt++},onCmdSyncAttach:function(){var h=this.sendCommand("getDocument");var d=AttachUtil.syncAttach(h);var b=d.deleted;var f=d.added;for(var e=0;e<b.length;e++){var c=b[e];var g=(c.type=="image"||c.type=="flash"||c.type=="video")?"img":"file";var a=document.getElementById("delete_"+g+"_"+c.type+"_"+c.id);var j=null;if(a){for(j=a.parentNode;j;j=j.parentNode){if(j.tagName&&j.tagName.toUpperCase()=="LI"){if(g=="file"){this.deleteFileLI(j)}else{this.deleteImageLI(j)}this.sendCommand("deleteAttach",{type:c.type,id:c.id,sync:true});break}}}}for(var e=0;e<f.length;e++){var c=AttachUtil.getAttachedInfo(f[e].type,f[e].id);var g=(f[e].type=="image"||f[e].type=="flash"||f[e].type=="video")?"img":"file";if(c){if(g=="img"){this.onCmdAddImageAttach(c)}else{if(g=="file"){this.onCmdAddFileAttach(c)}}this.sendCommand("increaseAttachCnt",{type:c.type,id:c.id})}}this.sendCommand("setSize",{cur:this.getTotalAttachSize(),max:AttachUtil.maxAttachSize})},onCmdNotifyUndo:function(){var a=this.sendCommand("undoObject",this.getListData());this.setListData(a);this.sendCommand("setSize",{cur:this.getTotalAttachSize(),max:AttachUtil.maxAttachSize})},onCmdNotifyRedo:function(){var a=this.sendCommand("redoObject",this.getListData());this.setListData(a);this.sendCommand("setSize",{cur:this.getTotalAttachSize(),max:AttachUtil.maxAttachSize})},onCmdNotifyUndoStackPush:function(a){this.sendCommand("pushObject",this.getListData())},onClickDeleteAttach:function(h,a){var c=es.Event.findElement(h,"a");var i=es.Event.findElement(h,"li");var e=c.id.split("_");var g=e[1];var f=e[2];var b=e[3];var d=AttachUtil.removeAttach(f,b);this.sendCommand("setSize",{cur:this.getTotalAttachSize(),max:AttachUtil.maxAttachSize});if(g=="file"){this.deleteFileLI(i)}else{this.deleteImageLI(i)}this.sendCommand("deleteAttach",{type:f,id:b});this.sendCommand("saveUndo");this.sendCommand("setModified")},onClickInsertAttach:function(l,a){var c=es.Event.element(l);var g=c.id.split("_");var h=g[2];var b=g[3];if(h&&b){var e=AttachUtil.getAttachedInfo(h,b);if(e&&e.view_html){this.sendCommand("setFocus");var k=e.view_html.replace(/<iframe/i,'<iframe espresso:new_frame="1"');this.sendCommand("insertHTML",k);var j=this.sendCommand("getDocument");var d=j.getElementsByTagName("iframe");for(var f=0;f<d.length;f++){if(d[f].id==b||d[f].id=="proxy_"+b){var c=d[f];if(c.getAttribute("espresso:new_frame")=="1"){c.src=c.src}c.removeAttribute("espresso:new_frame")}}this.sendCommand("saveUndo")}}}});es.component.AttachSize=es.Class.create(es.editor.ComponentBase,{initialize:function($super){this._version="1.0";this._name="component.AttachSize";this._description="Editor Attach Size view component";$super()},initUI:function(){},onCmdSetSize:function(b){var a=es.Dom.getWidth(this.elements.container);var c=(b.cur/b.max)*a;es.Dom.setWidth(this.elements.bar,c);this.elements.cur.innerHTML=Math.ceil(b.cur/1024)+"KB";this.elements.max.innerHTML=Math.ceil(b.max/1024)+"KB"}});(function(){var a=es.Class.create(es.plugin.AttachPopupBase,{setting:null,_original_url:null,initialize:function($super){this._version="1.0";this._name="plugin.AttachFile";this._description="This plugin attach file";this._attachType="file";$super()},initUI:function($super){$super();this.initParameter("attach_file_setting");this.setting=this.getParameter("attach_file_setting");this._original_url=this._url},beforePopupOpen:function(){this._url=this._original_url.replace("{$curcnt}",this._curCount);this._url=this._url.replace("{$cursize}",this.getTotalAttachSize())},insertAttach:function(e){AttachUtil.closePopup();var f=e.split("|");var i=f[0];var h=f[1];var k=parseInt(f[2]);var g=f[3];var c=parseInt(k);if(c+this.getTotalAttachSize()>AttachUtil.maxAttachSize){alert("   "+Math.ceil(AttachUtil.maxAttachSize/1024)+"KB ."," ");return false}var j={fid:g};var b=i;if(b.length>16){b=b.substring(0,16);b+="..."}var d="espressoattachfile"+g.substring(g.lastIndexOf("_")<0?0:g.lastIndexOf("_")+1);var l='<a id="'+d+'" href="'+h+'" target="_blank">'+i+"</a>";var f={prefix:"[]",id:d,filename:b,size:parseInt(k),view_html:l,type:this._attachType,url:h,data:j,insertFromList:true};this.addAttach(d,f);this.sendCommand("setFocus");this.sendCommand("addFileAttach",f);this.sendCommand("saveUndo","force")},deleteAttachDelegate:function(d,f){var e=this.sendCommand("getDocument");while(true){var c=e.getElementById(f);if(!c){break}var b=c;b.parentNode.removeChild(b)}},onCmdAddAttach:function(c){var b={prefix:"[]",id:c.id,filename:c.filename,size:c.file_size,view_html:c.view_html,type:this._attachType,url:c.file_link,data:c.data,insertFromList:true};if(this.addAttach(c.id,b)){this.sendCommand("addFileAttach",b)}}});es.plugin.AttachFile=a})();(function(){var a=es.Class.create(es.plugin.AttachPopupBase,{setting:null,initialize:function($super){this._version="1.0";this._name="plugin.AttachImage";this._description="This plugin attach image";this._attachType="image";$super()},initUI:function($super){$super();this.setting=this.getParameter("attach_image_setting");if(this.setting.allowed_image_extension){AttachUtil.popupCommonStorage.allowed_image_extension=this.setting.allowed_image_extension}else{AttachUtil.popupCommonStorage.allowed_image_extension="jpg,gif,png"}this._original_url=this._url},beforePopupOpen:function(){this._url=this._original_url.replace("{$curcnt}",this._curCount);this._url=this._url.replace("{$cursize}",this.getTotalAttachSize())},insertImage:function(d){AttachUtil.closePopup();var k="";var e=d.split("|");var j=e[0];var h=e[1];var l=e[2];var g=e[3];var b=parseInt(l);if(b+this.getTotalAttachSize()>AttachUtil.maxAttachSize){alert("   "+Math.ceil(AttachUtil.maxAttachSize/1024)+"KB ."," ");return false}var c=null;var o=this.sendCommand("getDocument");if(es.Browser.IE){c=o.createElement('<img name="image">')}else{c=o.createElement("img");c.setAttribute("name","image")}c.setAttribute("id","proxy_"+AttachUtil.randomNumber);c.setAttribute("swaf:cywrite:info",d);c.setAttribute("swaf:cywrite:object_id",AttachUtil.randomNumber);c.style.border="none";c.src=h;if(es.Browser.IE){k+=c.outerHTML}else{var f=document.getElementById("espresso_img_attach_html_container");if(!f){f=document.createElement("div");f.id="espresso_img_attach_html_container";document.body.appendChild(f)}f.appendChild(c);k+=f.innerHTML;f.innerHTML=""}var n="<p>"+k+"</p>";n+="<p>&nbsp;</p>";k=k.replace("proxy_"+AttachUtil.randomNumber,AttachUtil.randomNumber);var m='<a href="'+h+'" target="_blank">'+k+"</a>";var i={fid:g};var e={id:AttachUtil.randomNumber,filename:j,size:parseInt(l),html:m,view_html:n,type:this._attachType,url:h,thumbnail:h,data:i,insertFromList:true,syncDoc:true,proxy:true};this.addAttach(AttachUtil.randomNumber,e);this.sendCommand("setFocus");this.sendCommand("insertHTML",e.view_html);this.sendCommand("addImageAttach",e);this.sendCommand("saveUndo")},deleteAttachDelegate:function(d,f){var e=this.sendCommand("getDocument");while(true){var c=e.getElementById(f);if(!c){break}var b=c.parentNode;if(b.tagName.toLowerCase()=="p"&&b.childNodes.length==1){b.parentNode.removeChild(b)}else{b.removeChild(c)}}f="proxy_"+f;while(true){var c=e.getElementById(f);if(!c){break}var b=c.parentNode;if(b.tagName.toLowerCase()=="p"&&b.childNodes.length==1){b.parentNode.removeChild(b)}else{b.removeChild(c)}}},onCmdAddImage:function(b){if(this.addAttach(b.id,b)){this.sendCommand("addImageAttach",b)}}});es.plugin.AttachImage=a})();(function(){var a=es.Class.create(es.editor.PluginBase,{initialize:function($super){this._version="1.0";this._name="plugin.ColorPicker";this._description="This Plugin support color insertion dialog";$super()},initUI:function(){this.dialog=es.$(this.elements.ColorDialog);this.spectrum=new es.plugin.ColorSpectrum({id:[this.elements.ColorSpectrum,this.elements.SVPalette,this.elements.SVPointer,this.elements.HuePalette,this.elements.HuePointer,this.elements.SelectedColor,this.elements.RGBInput,this.elements.SelectColorInSpectrum,this.elements.CloseSpectrumBtn],notifyChangingColor:function(b){this.selectedColor=b}.bind(this),notifySelectingColor:this.selectColor.bind(this)});this.paletteElm=es.$(this.elements.ColorPalette);this.firstColor=this.paletteElm.getElementsByTagName("a")[0];es.Event.observe(this.paletteElm,"click",this.handleClickInPalette.bindAsEventListener(this));this.initDialog()},selectColor:function(b){if(b.length!=7){b="#"+ColorConverter.fixHex(b.substring(1))}this.callbackFunc(b);this.hideDialog()},handleClickInPalette:function(b){var c=es.Event.element(b);if(c.nodeType==1&&c.nodeName&&c.nodeName.toLowerCase()=="a"){if(c.title==" "){if(this.spectrum.isVisible()){this.spectrum.hide()}else{this.spectrum.show(this.selectedColor)}}else{this.selectColor(c.title)}es.Event.stop(b)}},_showDialog:function(c,d){if(!d){var b=es.Dom.getSize(c);d=es.Dom.getPosition(c);d.top=d.top+b.height}this.showDialog(null,d.left,d.top);this.spectrum.update(this.selectedColor)},showHideDialog:function(c,d){var b=this.isDialogVisible();if(b){if(this.currElement!=c){this.currElement=c;this._showDialog(c,d)}else{this.hideDialog()}}else{this._showDialog(c,d)}},onCmdShowHideColorDialog:function(b){this.callbackFunc=b.callbackFunc;if(!this.currElement){this.currElement=b.element}this.selectedColor=b.selectedColor;this.parentDlg=b.parentDlg;this.showHideDialog(b.element,b.pos)}});Object.extend(a.prototype,DialogUtil.prototype);es.plugin.ColorPicker=a})();